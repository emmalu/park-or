import{e as a,l as Ke,n as b,m as V,y as c,u as id,s as be,t as at,a as sd,b as nd,x as pr,A as Bi,v as od,o as rd,c as tl,d as Pn,f as mr,g as gr}from"./cast-6d78d3c7.js";import{s as fr,x as no}from"./Basemap-fd6389f3.js";import{_ as I}from"./preload-helper-101896b7.js";import{l as Jt}from"./Color-b7b9e6bb.js";import{j as ee}from"./Collection-42fe629f.js";import{n as ad}from"./collectionUtils-3d8a9611.js";import{o as ld}from"./compilerUtils-eefea0ec.js";import{s as N,a as k,b as tn}from"./Error-4ed679d7.js";import{y as oo,n as Ui,h as Se}from"./string-9c5e03f7.js";import{m as ro}from"./Loadable-b0d5bb7e.js";import{n as cd}from"./loadAll-1ae88564.js";import{f as Kt,E as Xt,i as pi,g as ps,U as Vo,j as il,b as dd,L as ud,A as sl,a as hd,v as _r,p as pd,C as md,t as gn}from"./promiseUtils-930cba29.js";import{T as yr,b as ti,a as Wt,t as As,r as gd,n as fn}from"./ensureType-d98e08e1.js";import{r as nl,w as X,o as fd,R as No,E as _n,a as Gi,k as Is,I as ol,p as _d,b as rl,c as al,d as yd,M as vd,e as wd,f as Ns,j as bd}from"./Extent-d5fff12d.js";import{t as F,r as M,s as Ee,u as Md,o as ss,e as Ve,f as Id,h as ei,p as ao,q as Cd}from"./typedArrayUtil-d02f10a8.js";import{r as Td}from"./enumeration-497ef064.js";import{r as Ed,n as xd}from"./opacityUtils-8b7acc4e.js";import{l as sn}from"./CollectionFlattener-b89887c0.js";import{n as qi}from"./Evented-b378ccab.js";import{U as ll}from"./request-e4299080.js";import{l as kd,d as Ad,t as Pd}from"./TablesMixin-019c9675.js";import{g as lt}from"./Graphic-34c50417.js";import{i as cl}from"./Clonable-58355d3c.js";import{s as $d}from"./Cyclical-1a93cb12.js";import{a as Hi,b as Sd,g as Rd}from"./mathUtils-daf59e84.js";import{i as Ld}from"./geometry-70b2a4a5.js";import{v as kt,c as dl}from"./jsonUtils-5115c7e5.js";import{l as v,h as U,a as Ze,f as At,U as ys,j as zo,w as oi}from"./reactiveUtils-b0e56010.js";import{c as fe}from"./screenUtils-7afeb41c.js";import{l as Fd}from"./workers-e5f6a313.js";import{e as vs,A as yn,r as Cs,t as vn,i as ii,d as Od,a as Dd}from"./projection-6146477c.js";import{p as Vd,j as Nd}from"./TileInfo-92f7dc61.js";import{i as lo,e as re,M as pe,n as m,v as nn,h as vr,f as rt,p as zd,k as Bd,a as ul,t as Ud,w as Hd,b as hl,r as wr,c as pl,o as br}from"./widget-4becb80f.js";import{c as ml,a as wn,d as gl}from"./HandleOwner-6ac6f00a.js";import{s as ot}from"./intl-a5c99ea3.js";import{s as Mr}from"./byteSizeEstimations-90c5a50d.js";import{$ as Gd,E as qd}from"./unitUtils-b69647a1.js";import{m as Bo,L as on,u as jd,S as fl}from"./number-c7f1bfee.js";import{a as Wd,s as $n}from"./executeQueryJSON-710cf21c.js";import{c as Ir,d as co}from"./RelationshipQuery-b5b427dc.js";import{x as Zd,h as Kd,i as Yd}from"./fieldUtils-2efa8993.js";import{u as Qd,i as Jd,c as _l,a as Xd,I as eu,b as yl,d as tu,e as iu,f as Ts,g as su,h as nu,k as vl,j as ou}from"./PopupTemplate-29fe62b5.js";import{i as wl}from"./arcadeOnDemand-72a1843c.js";import{a as bl}from"./assets-6ba3cd63.js";import"./LegendOptions-e31ff575.js";import{j as bi,x as Sn,M as ru,N as au}from"./utils-cb77f8a5.js";import{S as lu,n as cu,y as du}from"./symbols-12804594.js";import{a as uu}from"./jsonUtils-7ad404a7.js";import{m as hu,x as Rn}from"./Query-066f2ccf.js";import"./featureConversionUtils-d9ec654e.js";import{i as pu,v as mu,m as Uo}from"./Polyline-42dcc920.js";import{M as gu,f as fu,i as _u,o as yu}from"./normalizeUtils-91a64c2b.js";import"./pbf-e4fd0249.js";import"./FeatureSet-622e3076.js";import"./TopFeaturesQuery-7da1d7c1.js";import{l as vu,s as wu}from"./locale-30120714.js";import Ml from"./FeatureLayer-95c99e68.js";import{s as Il,i as Ho}from"./Identifiable-57df9761.js";import{b as Cr}from"./Layer-f9f81f65.js";import{h as bu,c as Cl,f as Tl,e as Go,i as rn,M as Mu,r as El,n as Iu}from"./mat2d-80bd93af.js";import{e as Tr}from"./Queue-8aae62d3.js";import{t as Cu,I as Tu,y as Eu}from"./Scheduler-343fdba6.js";import{T as xu}from"./TimeExtent-0fd238ea.js";import{j as xl,b as ku}from"./asyncUtils-18831bb1.js";import{m as Au,_ as Pu}from"./Promise-6bd0b483.js";import{l as $u,i as kl,a as Er,h as Su}from"./GraphicsLayer-18770580.js";import{v as qo}from"./HeightModelInfo-645087b5.js";import{m as Ru}from"./arcgisLayerUrl-02fe1a62.js";import{l as xr}from"./ViewingMode-fb6259a5.js";import{t as uo,r as Lu}from"./unitBezier-881ac1eb.js";import{r as Al}from"./common-701a4199.js";import{o as ho,v as kr,y as Fu,j as Ou,q as Ar,C as Pl,l as bn,r as ye,z as Ct,g as Du,a as an,s as Vu,m as Nu}from"./vec2-f978aef8.js";import{r as zu,n as he}from"./vec2f64-e0301652.js";import{s as Bu,r as Uu,M as Pr,h as Hu,i as Gu}from"./mat3-45e3f2eb.js";import{e as Ln}from"./mat3f32-d3d088e8.js";import{t as $r}from"./vec2f32-461e65a9.js";import"./TileStrategy-40f1ecb0.js";import{d as qu,h as ju}from"./TileStore-a368d16c.js";import"./TileKey-ed432ae5.js";import{l as Wu}from"./capabilities-5736b16f.js";import{r as Zu}from"./context-util-abf86a85.js";import{j as Ku}from"./Portal-95b0f852.js";import{s as wi}from"./jsonMap-5afaf2ff.js";import{u as Yu}from"./messages-634811b5.js";import{D as Qu}from"./datetime-7cb5ae9e.js";import"./nextTick-3ee5a785.js";import"./deprecate-46fadabd.js";import"./PortalItem-bbd2de41.js";import"./writeUtils-44b0e78b.js";import"./layerUtils-6996b9ea.js";import"./colorUtils-639f4d25.js";import"./SimpleObservable-e0897cc6.js";import"./typeUtils-b6c52390.js";import"./Connection-f53be4bf.js";import"./mat4-62d5e6a4.js";import"./zscale-72b4355d.js";import"./aaBoundingRect-ca34962d.js";import"./uuid-73213768.js";import"./query-4348ce6f.js";import"./pbfQueryUtils-91f50fb5.js";import"./OptimizedFeature-1bba65b5.js";import"./OptimizedFeatureSet-1d1ac4b9.js";import"./queryZScale-1674984c.js";import"./parser-f68dd732.js";import"./ItemCache-b4db8f82.js";import"./MemCache-1e028041.js";import"./CIMSymbol-33ea3902.js";import"./Symbol-1bb07043.js";import"./aaBoundingBox-33fc923c.js";import"./persistableUrlUtils-d18becd9.js";import"./UniqueValueRenderer-8e382829.js";import"./diffUtils-713e5c9b.js";import"./colorRamps-c00f504b.js";import"./sizeVariableUtils-d4870b0d.js";import"./lengthUtils-0dde2114.js";import"./jsonUtils-c8fbfbd0.js";import"./styleUtils-cde65ff5.js";import"./PortalGroup-813428fa.js";import"./DictionaryLoader-46cd8e54.js";import"./LRUCache-4d56ba4d.js";import"./heatmapUtils-90a13d85.js";import"./vec4f64-018b3fa6.js";import"./Field-bb784640.js";import"./fieldType-9bddd3d4.js";import"./MultiOriginJSONSupport-1970ed0f.js";import"./LayerFloorInfo-0d02c503.js";import"./FeatureLayerBase-6192846c.js";import"./OperationalLayer-007b4c8b.js";import"./ElevationInfo-618e96ba.js";import"./editsZScale-e318eb4a.js";import"./APIKeyMixin-f90cfebd.js";import"./ArcGISService-f6f32fbc.js";import"./BlendLayer-7a735871.js";import"./CustomParametersMixin-5e3018da.js";import"./EditBusLayer-1372e92b.js";import"./FeatureReductionLayer-d24025a2.js";import"./labelingInfo-69496ac8.js";import"./labelUtils-87bb22ff.js";import"./defaultsJSON-b087dd4d.js";import"./OrderedLayer-7b3473c8.js";import"./PortalLayer-5c12bdba.js";import"./PortalUser-4126c27a.js";import"./RefreshableLayer-84ec1468.js";import"./ScaleRangeLayer-c6a35aba.js";import"./TemporalLayer-ac8e2c3d.js";import"./TimeInfo-a1791ae0.js";import"./FeatureTemplate-773a8865.js";import"./FeatureType-6c50f4e3.js";import"./fieldProperties-9268e64b.js";import"./FieldsIndex-0e507864.js";import"./versionUtils-5ccafbea.js";import"./styleUtils-45e2d86c.js";import"./popupUtils-40f744cb.js";import"./rbush-8e36784a.js";import"./quickselect-322ec8e1.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();function ce(){}function $l(i){return i()}function Sr(){return Object.create(null)}function Mn(i){i.forEach($l)}function jo(i){return typeof i=="function"}function ji(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}let Ps;function Rr(i,e){return Ps||(Ps=document.createElement("a")),Ps.href=e,i===Ps.href}function Ju(i){return Object.keys(i).length===0}function Xu(i,...e){if(i==null)return ce;const t=i.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Lr(i,e,t){i.$$.on_destroy.push(Xu(e,t))}function Fr(i,e,t){return i.set(t),e}function eh(i){return i&&jo(i.destroy)?i.destroy:ce}function B(i,e){i.appendChild(e)}function ue(i,e,t){i.insertBefore(e,t||null)}function le(i){i.parentNode&&i.parentNode.removeChild(i)}function Sl(i,e){for(let t=0;t<i.length;t+=1)i[t]&&i[t].d(e)}function j(i){return document.createElement(i)}function xt(i){return document.createTextNode(i)}function xe(){return xt(" ")}function Rl(){return xt("")}function Q(i,e,t){t==null?i.removeAttribute(e):i.getAttribute(e)!==t&&i.setAttribute(e,t)}function th(i){return Array.from(i.childNodes)}function ln(i,e){e=""+e,i.wholeText!==e&&(i.data=e)}function ms(i,e,t,s){t===null?i.style.removeProperty(e):i.style.setProperty(e,t,s?"important":"")}let ws;function gs(i){ws=i}function ih(){if(!ws)throw new Error("Function called outside component initialization");return ws}function Ll(i){ih().$$.on_destroy.push(i)}const xi=[],Or=[],zs=[],Dr=[],sh=Promise.resolve();let po=!1;function nh(){po||(po=!0,sh.then(Fl))}function mo(i){zs.push(i)}const Fn=new Set;let Mi=0;function Fl(){if(Mi!==0)return;const i=ws;do{try{for(;Mi<xi.length;){const e=xi[Mi];Mi++,gs(e),oh(e.$$)}}catch(e){throw xi.length=0,Mi=0,e}for(gs(null),xi.length=0,Mi=0;Or.length;)Or.pop()();for(let e=0;e<zs.length;e+=1){const t=zs[e];Fn.has(t)||(Fn.add(t),t())}zs.length=0}while(xi.length);for(;Dr.length;)Dr.pop()();po=!1,Fn.clear(),gs(i)}function oh(i){if(i.fragment!==null){i.update(),Mn(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(mo)}}const Bs=new Set;let rh;function ns(i,e){i&&i.i&&(Bs.delete(i),i.i(e))}function $s(i,e,t,s){if(i&&i.o){if(Bs.has(i))return;Bs.add(i),rh.c.push(()=>{Bs.delete(i),s&&(t&&i.d(1),s())}),i.o(e)}else s&&s()}function Ss(i){i&&i.c()}function os(i,e,t,s){const{fragment:n,after_update:o}=i.$$;n&&n.m(e,t),s||mo(()=>{const r=i.$$.on_mount.map($l).filter(jo);i.$$.on_destroy?i.$$.on_destroy.push(...r):Mn(r),i.$$.on_mount=[]}),o.forEach(mo)}function rs(i,e){const t=i.$$;t.fragment!==null&&(Mn(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function ah(i,e){i.$$.dirty[0]===-1&&(xi.push(i),nh(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function Es(i,e,t,s,n,o,r,l=[-1]){const d=ws;gs(i);const u=i.$$={fragment:null,ctx:[],props:o,update:ce,not_equal:n,bound:Sr(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:Sr(),dirty:l,skip_bound:!1,root:e.target||d.$$.root};r&&r(u.root);let h=!1;if(u.ctx=t?t(i,e.props||{},(p,g,...f)=>{const _=f.length?f[0]:g;return u.ctx&&n(u.ctx[p],u.ctx[p]=_)&&(!u.skip_bound&&u.bound[p]&&u.bound[p](_),h&&ah(i,p)),g}):[],u.update(),h=!0,Mn(u.before_update),u.fragment=s?s(u.ctx):!1,e.target){if(e.hydrate){const p=th(e.target);u.fragment&&u.fragment.l(p),p.forEach(le)}else u.fragment&&u.fragment.c();e.intro&&ns(i.$$.fragment),os(i,e.target,e.anchor,e.customElement),Fl()}gs(d)}class xs{$destroy(){rs(this,1),this.$destroy=ce}$on(e,t){if(!jo(t))return ce;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(t),()=>{const n=s.indexOf(t);n!==-1&&s.splice(n,1)}}$set(e){this.$$set&&!Ju(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const lh="/assets/play-f2b05e5c.svg",ch="/assets/filter-243292c5.svg",Ii=[];function Ol(i,e=ce){let t;const s=new Set;function n(l){if(ji(i,l)&&(i=l,t)){const d=!Ii.length;for(const u of s)u[1](),Ii.push(u,i);if(d){for(let u=0;u<Ii.length;u+=2)Ii[u][0](Ii[u+1]);Ii.length=0}}}function o(l){n(l(i))}function r(l,d=ce){const u=[l,d];return s.add(u),s.size===1&&(t=e(n)||ce),l(i),()=>{s.delete(u),s.size===0&&(t(),t=null)}}return{set:n,update:o,subscribe:r}}const go=Ol([]),fo=Ol([]);var _o;let Us=_o=class extends Ke{constructor(i){super(i),this.type="none"}clone(){return new _o({type:this.type})}};a([Td({none:"none",stayAbove:"stay-above"})],Us.prototype,"type",void 0),Us=_o=a([b("esri.ground.NavigationConstraint")],Us);let K=class extends V{constructor(){super(...arguments),this.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1,this.DECONFLICTOR_SHOW_VISIBLE=!1,this.DECONFLICTOR_SHOW_INVISIBLE=!1,this.DECONFLICTOR_SHOW_GRID=!1,this.LABELS_SHOW_BORDER=!1,this.TEXT_SHOW_BASELINE=!1,this.TEXT_SHOW_BORDER=!1,this.OVERLAY_DRAW_DEBUG_TEXTURE=!1,this.OVERLAY_SHOW_CENTER=!1,this.SHOW_POI=!1,this.TESTS_DISABLE_OPTIMIZATIONS=!1,this.TESTS_DISABLE_FAST_UPDATES=!1,this.DRAW_MESH_GEOMETRY_NORMALS=!1,this.FEATURE_TILE_FETCH_SHOW_TILES=!1,this.FEATURE_TILE_TREE_SHOW_TILES=!1,this.TERRAIN_TILE_TREE_SHOW_TILES=!1,this.I3S_TREE_SHOW_TILES=!1,this.I3S_SHOW_MODIFICATIONS=!1,this.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1,this.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1,this.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1,this.LINE_WIREFRAMES=!1,this.TERRAIN_USE_LEGACY_SHADING=!1}};a([c()],K.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0),a([c()],K.prototype,"DECONFLICTOR_SHOW_VISIBLE",void 0),a([c()],K.prototype,"DECONFLICTOR_SHOW_INVISIBLE",void 0),a([c()],K.prototype,"DECONFLICTOR_SHOW_GRID",void 0),a([c()],K.prototype,"LABELS_SHOW_BORDER",void 0),a([c()],K.prototype,"TEXT_SHOW_BASELINE",void 0),a([c()],K.prototype,"TEXT_SHOW_BORDER",void 0),a([c()],K.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0),a([c()],K.prototype,"OVERLAY_SHOW_CENTER",void 0),a([c()],K.prototype,"SHOW_POI",void 0),a([c()],K.prototype,"TESTS_DISABLE_OPTIMIZATIONS",void 0),a([c()],K.prototype,"TESTS_DISABLE_FAST_UPDATES",void 0),a([c()],K.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0),a([c()],K.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0),a([c()],K.prototype,"FEATURE_TILE_TREE_SHOW_TILES",void 0),a([c()],K.prototype,"TERRAIN_TILE_TREE_SHOW_TILES",void 0),a([c()],K.prototype,"I3S_TREE_SHOW_TILES",void 0),a([c()],K.prototype,"I3S_SHOW_MODIFICATIONS",void 0),a([c()],K.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0),a([c()],K.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0),a([c()],K.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0),a([c()],K.prototype,"LINE_WIREFRAMES",void 0),a([c()],K.prototype,"TERRAIN_USE_LEGACY_SHADING",void 0),K=a([b("esri.views.3d.support.DebugFlags")],K);const dh=new K;var yo;let Qe=yo=class extends id(ro){constructor(i){super(i),this.opacity=1,this.shading=!dh.TERRAIN_USE_LEGACY_SHADING,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new ee;const e=s=>{s.parent&&s.parent!==this&&"remove"in s.parent&&s.parent.remove(s),s.parent=this,s.type!=="elevation"&&s.type!=="base-elevation"&&N.getLogger(this.declaredClass).error(`Layer '${s.title}, id:${s.id}' of type '${s.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},t=s=>{s.parent=null};this.layers.on("after-add",s=>e(s.item)),this.layers.on("after-remove",s=>t(s.item))}initialize(){this.when().catch(i=>{N.getLogger(this.declaredClass).error("#load()","Failed to load ground",i)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const i=this.layers.removeAll();for(const e of i)e.destroy();this.layers.destroy()}normalizeCtorArgs(i){return i&&"resourceInfo"in i&&(this._set("resourceInfo",i.resourceInfo),delete(i={...i}).resourceInfo),i}set layers(i){this._set("layers",ad(i,this._get("layers")))}writeLayers(i,e,t,s){const n=[];i&&(s={...s,layerContainerType:"ground"},i.forEach(o=>{if("write"in o){const r={};ld(o)().write(r,s)&&n.push(r)}else s&&s.messages&&s.messages.push(new k("layer:unsupported",`Layers (${o.title}, ${o.id}) of type '${o.declaredClass}' cannot be persisted in the ground`,{layer:o}))})),e.layers=n}load(i){return this.addResolvingPromise(this._loadFromSource(i)),Promise.resolve(this)}loadAll(){return cd(this,i=>{i(this.layers)})}async queryElevation(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await I(()=>import("./ElevationQuery-048df8cb.js"),["assets/ElevationQuery-048df8cb.js","assets/asyncUtils-18831bb1.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/unitUtils-b69647a1.js","assets/jsonMap-5afaf2ff.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/projection-6146477c.js","assets/preload-helper-101896b7.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/SimpleObservable-e0897cc6.js","assets/mat4-62d5e6a4.js","assets/assets-6ba3cd63.js","assets/request-e4299080.js","assets/zscale-72b4355d.js","assets/aaBoundingRect-ca34962d.js","assets/geometry-70b2a4a5.js","assets/typeUtils-b6c52390.js","assets/TileInfo-92f7dc61.js"]);Kt(e);const s=new t,n=this.layers.filter(Vr).toArray();return s.queryAll(n,i,e)}async createElevationSampler(i,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:t}=await I(()=>import("./ElevationQuery-048df8cb.js"),["assets/ElevationQuery-048df8cb.js","assets/asyncUtils-18831bb1.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/unitUtils-b69647a1.js","assets/jsonMap-5afaf2ff.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/projection-6146477c.js","assets/preload-helper-101896b7.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/SimpleObservable-e0897cc6.js","assets/mat4-62d5e6a4.js","assets/assets-6ba3cd63.js","assets/request-e4299080.js","assets/zscale-72b4355d.js","assets/aaBoundingRect-ca34962d.js","assets/geometry-70b2a4a5.js","assets/typeUtils-b6c52390.js","assets/TileInfo-92f7dc61.js"]);Kt(e);const s=new t,n=this.layers.filter(Vr).toArray();return s.createSamplerAll(n,i,e)}clone(){const i={opacity:this.opacity,surfaceColor:oo(this.surfaceColor),navigationConstraint:oo(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(i.loadStatus="loaded"),new yo({resourceInfo:this.resourceInfo}).set(i)}read(i,e){this.resourceInfo||this._set("resourceInfo",{data:i,context:e}),super.read(i,e)}_loadFromSource(i){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,i):Promise.resolve()}_loadLayersFromJSON(i,e,t){const s=e&&e.origin||"web-scene",n=e&&e.portal||null,o=e&&e.url||null;return I(()=>import("./layersCreator-5625f2d5.js"),["assets/layersCreator-5625f2d5.js","assets/Collection-42fe629f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/lazyLayerLoader-2288f664.js","assets/preload-helper-101896b7.js","assets/PortalItem-bbd2de41.js","assets/assets-6ba3cd63.js","assets/request-e4299080.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/Extent-d5fff12d.js","assets/Portal-95b0f852.js","assets/locale-30120714.js","assets/PortalGroup-813428fa.js","assets/jsonMap-5afaf2ff.js","assets/PortalUser-4126c27a.js","assets/portalLayers-645eb7cc.js","assets/layersLoader-f177f715.js","assets/Layer-f9f81f65.js","assets/geometry-70b2a4a5.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/Identifiable-57df9761.js","assets/arcgisLayerUrl-02fe1a62.js","assets/persistableUrlUtils-d18becd9.js","assets/jsonContext-13d2310d.js","assets/portalItemUtils-ff52c3bb.js","assets/projection-6146477c.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/unitUtils-b69647a1.js","assets/mat4-62d5e6a4.js","assets/zscale-72b4355d.js","assets/styleUtils-45e2d86c.js","assets/asyncUtils-18831bb1.js"]).then(({populateOperationalLayers:r})=>{Kt(t);const l=[];if(i.layers&&Array.isArray(i.layers)){const d={context:{origin:s,url:o,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};l.push(r(this.layers,i.layers,d))}return Xt(l)}).then(()=>{})}};function uh(i){return i&&"createElevationSampler"in i}function Vr(i){return i.type==="elevation"||uh(i)}a([c({json:{read:!1}})],Qe.prototype,"layers",null),a([nl("layers")],Qe.prototype,"writeLayers",null),a([c({readOnly:!0})],Qe.prototype,"resourceInfo",void 0),a([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:yr,read:{reader:Ed,source:"transparency"},write:{writer:(i,e)=>{e.transparency=xd(i)},target:"transparency"}}})],Qe.prototype,"opacity",void 0),a([c({type:Boolean,nonNullable:!0,json:{read:!1}})],Qe.prototype,"shading",void 0),a([c({type:Jt,json:{type:[yr],write:(i,e)=>{e.surfaceColor=i.toJSON().slice(0,3)}}})],Qe.prototype,"surfaceColor",void 0),a([c({type:Us,json:{write:!0}})],Qe.prototype,"navigationConstraint",void 0),Qe=yo=a([b("esri.Ground")],Qe);const cn=Qe;function hh(i){var e;return!!(i&&i.loaded&&"capabilities"in i&&((e=i==null?void 0:i.capabilities)!=null&&e.operations)&&"supportsEditing"in i.capabilities.operations&&i.capabilities.operations.supportsEditing===!0)&&!("editingEnabled"in i&&!i.editingEnabled)}const Nr=N.getLogger("esri.support.basemapUtils");function ph(){return{}}function mh(i){for(const e in i){const t=i[e];(t==null?void 0:t.destroyed)===!1&&t.destroy(),delete i[e]}}function gh(i,e){let t;if(typeof i=="string"){if(!(i in fr)){const s=Object.entries(fr).filter(([n,o])=>tn.apiKey&&!o.classic||!tn.apiKey&&o.classic&&!o.deprecated).map(([n])=>`"${n}"`).join(", ");return Nr.warn(`Unable to find basemap definition for: ${i}. Try one of these: ${s}`),null}e&&(t=e[i]),t||(t=no.fromId(i),e&&(e[i]=t))}else t=ti(no,i);return t!=null&&t.destroyed&&(Nr.warn("The provided basemap is already destroyed",{basemap:t}),t=null),t}const zr={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function fh(i){let e=null;if(typeof i=="string")if(i in zr){const t=zr[i];e=new cn({resourceInfo:{data:{layers:[t]}}})}else N.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${i}. Try "world-elevation"`);else e=ti(cn,i);return e}let Je=class extends kd(Ad(qi.EventedMixin(V))){constructor(e){super(e),this.allLayers=new sn({getCollections:()=>{var t,s,n;return[(t=this.basemap)==null?void 0:t.baseLayers,(s=this.ground)==null?void 0:s.layers,this.layers,(n=this.basemap)==null?void 0:n.referenceLayers]},getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=Pd(this),this.basemap=null,this.editableLayers=new sn({getCollections:()=>[this.allLayers],itemFilterFunction:hh}),this.ground=new cn,this._basemapCache=ph()}destroy(){var e,t;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),(e=this.ground)==null||e.destroy(),(t=this.basemap)==null||t.destroy(),mh(this._basemapCache),this._basemapCache=null}castBasemap(e){return gh(e,this._basemapCache)}castGround(e){const t=fh(e);return F(t)?this._get("ground"):t}findLayerById(e){return this.allLayers.find(t=>t.id===e)}findTableById(e){return this.allTables.find(t=>t.id===e)}};a([c({readOnly:!0,dependsOn:[]})],Je.prototype,"allLayers",void 0),a([c({readOnly:!0})],Je.prototype,"allTables",void 0),a([c({type:no})],Je.prototype,"basemap",void 0),a([be("basemap")],Je.prototype,"castBasemap",null),a([c({readOnly:!0})],Je.prototype,"editableLayers",void 0),a([c({type:cn,nonNullable:!0})],Je.prototype,"ground",void 0),a([be("ground")],Je.prototype,"castGround",null),Je=a([b("esri.Map")],Je);const Dl=Je;let _t=class extends cl(Ke){constructor(...e){super(...e),this.position=new X([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(e,t,s,n){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const o={position:e};return t!=null&&(o.heading=t),s!=null&&(o.tilt=s),n!=null&&(o.fov=n),o}return e}writePosition(e,t,s,n){const o=e.clone();o.x=Wt(e.x||0),o.y=Wt(e.y||0),o.z=e.hasZ?Wt(e.z||0):e.z,t[s]=o.write({},n)}readPosition(e,t){const s=new X;return s.read(e,t),s.x=Wt(s.x||0),s.y=Wt(s.y||0),s.z=s.hasZ?Wt(s.z||0):s.z,s}equals(e){return!F(e)&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)}};a([c({type:X,json:{write:{isRequired:!0}}})],_t.prototype,"position",void 0),a([nl("position")],_t.prototype,"writePosition",null),a([fd("position")],_t.prototype,"readPosition",null),a([c({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),be(i=>$d.normalize(Wt(i)))],_t.prototype,"heading",void 0),a([c({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),be(i=>Hi(Wt(i),-180,180))],_t.prototype,"tilt",void 0),a([c({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],_t.prototype,"fov",void 0),_t=a([b("esri.Camera")],_t);const _h=_t;var vo;let Ot=vo=class extends Ke{constructor(i){super(i),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(i){return(i%=360)<0&&(i+=360),i}clone(){return new vo({rotation:this.rotation,scale:this.scale,targetGeometry:M(this.targetGeometry)?this.targetGeometry.clone():null,camera:M(this.camera)?this.camera.clone():null})}};function On(){return{enabled:!this.camera}}a([c({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:On}}}}})],Ot.prototype,"rotation",void 0),a([be("rotation")],Ot.prototype,"castRotation",null),a([c({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:On}}}}})],Ot.prototype,"scale",void 0),a([c({types:Ld,json:{read:kt,write:!0,origins:{"web-scene":{read:kt,write:{overridePolicy:On}}}}})],Ot.prototype,"targetGeometry",void 0),a([c({type:_h,json:{write:!0}})],Ot.prototype,"camera",void 0),Ot=vo=a([b("esri.Viewpoint")],Ot);const We=Ot,Hs={widthBreakpoint:{getValue(i){const e=i.viewSize[0],t=i.breakpoints,s=this.values;return e<=t.xsmall?s.xsmall:e<=t.small?s.small:e<=t.medium?s.medium:e<=t.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(i){const e=i.viewSize[1],t=i.breakpoints,s=this.values;return e<=t.xsmall?s.xsmall:e<=t.small?s.small:e<=t.medium?s.medium:e<=t.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(i){const e=i.viewSize,t=e[0],s=e[1],n=this.values;return s>=t?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},Dn={xsmall:544,small:768,medium:992,large:1200};function yh(i){const e=i;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function Vn(i,e){return e?Hs[i].valueToClassName[e].split(" "):[]}const vh=i=>{let e=class extends i{constructor(...t){super(...t),this._breakpointsHandles=new at,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=Dn}initialize(){this._breakpointsHandles.add(v(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),U))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles=Ee(this._breakpointsHandles))}set breakpoints(t){if(t===this._get("breakpoints"))return;const s=yh(t);if(!s){const n=JSON.stringify(Dn,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n)}t=s?t:Dn,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=As.acquire(),s=As.acquire();let n,o=!1;for(n in Hs){const r=this[n],l=Hs[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});r!==l&&(o=!0,this[n]=l,Vn(n,r).forEach(d=>s.push(d)),Vn(n,l).forEach(d=>t.push(d)))}o&&(this._applyClassNameChanges(t,s),As.release(t),As.release(s))}_applyClassNameChanges(t,s){const n=this.container;n&&(s.forEach(o=>n.classList.remove(o)),t.forEach(o=>n.classList.add(o)))}_removeActiveClassNames(){const t=this.container;if(!t)return;let s;for(s in Hs)Vn(s,this[s]).forEach(n=>t.classList.remove(n))}};return a([c()],e.prototype,"breakpoints",null),a([c()],e.prototype,"orientation",void 0),a([c()],e.prototype,"widthBreakpoint",void 0),a([c()],e.prototype,"heightBreakpoint",void 0),e=a([b("esri.views.BreakpointsOwner")],e),e};let Dt=class extends V{constructor(){super(...arguments),this.items=new ee,this._watchUpdatingTracking=new ml,this._callbacks=new Map,this._projector=lo(),this._hiddenProjector=lo()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,t=>{for(const s of t.added){const n=()=>s.render();this._callbacks.set(s,n),this._projector.append(this.surface,n)}for(const s of t.removed){const n=this._projector.detach(this._callbacks.get(s));this.surface.removeChild(n.domNode),this._callbacks.delete(s)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const t=this._hiddenSurface,s=this._hiddenProjector;let n=null;const o=()=>(n=e.render(),n);s.append(t,o),s.renderNow();const r={left:0,top:0,right:0,bottom:0};if(n&&n.domNode){const l=n.domNode.getBoundingClientRect();r.left=l.left,r.top=l.top,r.right=l.right,r.bottom=l.bottom}for(s.detach(o);t.firstChild;)t.removeChild(t.firstChild);return r}overlaps(e,t){const s=this.computeBoundingRect(e),n=this.computeBoundingRect(t);return Math.max(s.left,n.left)<=Math.min(s.right,n.right)&&Math.max(s.top,n.top)<=Math.min(s.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e){if(!this.items.some(s=>s.visible))return;const t=e.getContext("2d");t.save(),t.font=this._fontString(),this.items.forEach(s=>{t.save(),s.renderCanvas(t),t.restore()}),t.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};a([c({readOnly:!0})],Dt.prototype,"surface",void 0),a([c({readOnly:!0})],Dt.prototype,"items",void 0),a([c({readOnly:!0})],Dt.prototype,"needsRender",null),a([c({readOnly:!0})],Dt.prototype,"_watchUpdatingTracking",void 0),a([c({readOnly:!0})],Dt.prototype,"updating",null),Dt=a([b("esri.views.overlay.ViewOverlay")],Dt);const Br=Dt;function zi(i,e,t,s){let n=null,o=1e3;typeof e=="number"?(o=e,s=t):(n=e??null,o=t);let r,l=0;const d=()=>{l=0,i.apply(s,r)},u=(...h)=>{n&&n.apply(s,h),r=h,o?l||(l=setTimeout(d,o)):d()};return u.remove=()=>{l&&(clearTimeout(l),l=0)},u.forceUpdate=()=>{l&&(clearTimeout(l),d())},u.hasPendingUpdates=()=>!!l,u}const Ur=["B","kB","MB","GB","TB"];function wh(i,e){let t=e===0?0:Math.floor(Math.log(e)/Math.log(Mr.KILOBYTES));t=Hi(t,0,Ur.length-1);const s=Bo(e/Mr.KILOBYTES**t,{maximumFractionDigits:2});return Ui(i.units.bytes[Ur[t]],{fileSize:s})}const bh="esri.widgets.Feature.support.featureUtils",Hr=N.getLogger(bh),Mh=/href=(""|'')/gi,Ih=/(\{([^\{\r\n]+)\})/g,Ch=/\'/g,Vl=/^\s*expression\//i,Th=/(\n)/gi,Eh=/[\u00A0-\u9999<>\&]/gim,xh=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,kh=/^(?:mailto:|tel:)/,Nl="relationships/",wo=fl("short-date-short-time");function zl(i){if(!F(i))return i.get("sourceLayer")||i.get("layer")}async function dn(i,e){return typeof i=="function"?i.call(null,e):i}function Bl(i=""){if(i)return!kh.test(i.trim().toLowerCase())}function Wo(i){return!!i&&Vl.test(i)}function Ah(i,e){if(!Wo(e)||!i)return null;const t=e.replace(Vl,"").toLowerCase();let s;return i.some(n=>n.name.toLowerCase()===t&&(s=n,!0)),s}function Ul(i,e){const t=Ah(e,i==null?void 0:i.fieldName);return t?t.title||null:i?i.label||i.fieldName:null}function Ph(i,e){const t=e.get(i.toLowerCase());return`{${t&&t.fieldName||i}}`}function $h(i){return i.replace(Mh,"")}function bs(i,e){const t=Zo(e,i);return t?t.name:i}function Sh(i,e){return i&&i.map(t=>bs(t,e))}function Zo(i,e){return i&&typeof i.getField=="function"?i.getField(e):null}function Hl(i){return`${i}`.trim()}function fi({attributes:i,globalAttributes:e,layer:t,text:s,expressionAttributes:n,fieldInfoMap:o}){return s?bo({formattedAttributes:e,template:Oh(s,{...e,...n,...i},t),fieldInfoMap:o}):""}function bo({formattedAttributes:i,template:e,fieldInfoMap:t}){return Hl($h(Ui(Ui(e,s=>Ph(s,t)),i)))}function Rh(i,e,t=!1){const s=e[i];if(typeof s=="string"){const n="%27",o=(t?encodeURIComponent(s):s).replace(Ch,n);e[i]=o}}function Lh(i,e=!1){const t={...i};return Object.keys(t).forEach(s=>Rh(s,t,e)),t}function Fh(i,e,t){const s=(e=Hl(e))&&e[0]!=="{";return Ui(i,Lh(t,s))}function Mo(i,e){return i.replace(Ih,(t,s,n)=>{const o=Zo(e,n);return o?`{${o.name}}`:s})}function Oh(i,e,t){const s=Mo(i,t);return s&&s.replace(xh,(n,o,r)=>Fh(n,o||r,e))}function Dh(i,e){if(typeof i=="string"&&e&&e.dateFormat==null&&(e.places!=null||e.digitSeparator!=null)){const t=Number(i);if(!isNaN(t))return t}return i}function Vh(i){return(i==null?void 0:i.type)==="feature"}function Gr(i){return!!(i!=null&&i.layer)}function Nh(i){return(i==null?void 0:i.type)==="map-image"}function zh(i,e){var u;const t=e.fieldInfos,s=e.fieldName,n=(u=Gl(t,s))==null?void 0:u.clone(),o=e.preventPlacesFormatting,r=e.layer,l=Zo(r,s);if(n&&(l==null?void 0:l.type)==="date"){const h=n.format||new Qd;h.dateFormat=h.dateFormat||"short-date-short-time",h.dateTimeFormatOptions=!Gr(r)&&Vh(r)&&r.datesInUnknownTimezone||Gr(r)&&Nh(r.layer)&&r.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,n.format=h}const d=n&&n.format;return typeof i=="string"&&Kd(s)&&d?d.formatRasterPixelValue(i):typeof(i=Dh(i,d))=="string"||i==null||d==null?ks(i):o?Bo(i,{...jd(d),minimumFractionDigits:0,maximumFractionDigits:20}):d.format(i)}function Gl(i,e){if(!i||!i.length||!e)return;const t=e.toLowerCase();let s;return i.some(n=>!(!n.fieldName||n.fieldName.toLowerCase()!==t)&&(s=n,!0)),s}function Bh({fieldName:i,graphic:e,layer:t}){if(Et(i)||!t||typeof t.getFeatureType!="function")return null;const{typeIdField:s}=t;if(!s||i!==s)return null;const n=t.getFeatureType(e);return n?n.name:null}function Uh({fieldName:i,value:e,graphic:t,layer:s}){if(Et(i)||!s||typeof s.getFieldDomain!="function")return null;const n=s.getFieldDomain(i,{feature:t});return n&&n.type==="coded-value"?n.getName(e):null}function Hh(i,e){const{creatorField:t,creationDateField:s,editorField:n,editDateField:o}=i;if(!e)return;const r=e[o];if(typeof r=="number"){const d=e[n];return{type:"edit",date:on(r,wo),user:d}}const l=e[s];if(typeof l=="number"){const d=e[t];return{type:"create",date:on(l,wo),user:d}}return null}function Gh(i,e){const t=new Map;return i&&i.forEach(s=>{const n=bs(s.fieldName,e);s.fieldName=n,t.set(n.toLowerCase(),s)}),t}function qr(i){const e=[];if(!i)return e;const{fieldInfos:t,content:s}=i;return t&&e.push(...t),s&&Array.isArray(s)&&s.forEach(n=>{if(n.type==="fields"){const o=n&&n.fieldInfos;o&&e.push(...o)}}),e}function Ko(i){return i.replace(Eh,e=>`&#${e.charCodeAt(0)};`)}function ks(i){return typeof i=="string"?i.replace(Th,'<br class="esri-text-new-line" />'):i}function ql(i){const{value:e,fieldName:t,fieldInfos:s,fieldInfoMap:n,layer:o,graphic:r}=i;if(e==null)return"";const l=Uh({fieldName:t,value:e,graphic:r,layer:o});if(l)return l;const d=Bh({fieldName:t,graphic:r,layer:o});if(d)return d;if(n.get(t.toLowerCase()))return zh(e,{fieldInfos:s||Array.from(n.values()),fieldName:t,layer:o});const u=o&&o.fieldsIndex;return u&&u.isDateField(t)?on(e,wo):ks(e)}function Nn({fieldInfos:i,attributes:e,layer:t,graphic:s,fieldInfoMap:n,relatedInfos:o}){const r={};return o==null||o.forEach(l=>Kh({attributes:r,relatedInfo:l,fieldInfoMap:n,fieldInfos:i,layer:t})),Object.keys(e).forEach(l=>{const d=e[l];r[l]=ql({fieldName:l,fieldInfos:i,fieldInfoMap:n,layer:t,value:d,graphic:s})}),r}async function qh(i,e){var h,p;const{layer:t,graphic:s,outFields:n,objectIds:o,returnGeometry:r,spatialReference:l}=i,d=o[0];if(typeof d!="number"&&typeof d!="string"){const g="Could not query required fields for the specified feature. The feature's ID is invalid.",f={layer:t,graphic:s,objectId:d,requiredFields:n};return Hr.warn(g,f),null}if(!((p=(h=t.capabilities)==null?void 0:h.operations)!=null&&p.supportsQuery)){const g="The specified layer cannot be queried. The following fields will not be available.",f={layer:t,graphic:s,requiredFields:n,returnGeometry:r};return Hr.warn(g,f),null}const u=t.createQuery();return u.objectIds=o,u.outFields=n!=null&&n.length?n:[t.objectIdField],u.returnGeometry=!!r,u.returnZ=!!r,u.returnM=!!r,u.outSpatialReference=l,(await t.queryFeatures(u,e)).features[0]}async function jh(i){var s;if(!((s=i.expressionInfos)!=null&&s.length))return!1;const e=await wl(),{arcadeUtils:{hasGeometryFunctions:t}}=e;return t(i)}async function Wh({graphic:i,popupTemplate:e,layer:t,spatialReference:s},n){if(!t||!e||(typeof t.load=="function"&&await t.load(n),!i.attributes))return;const o=i.attributes[t.objectIdField];if(o==null)return;const r=[o],l=await e.getRequiredFields(t.fieldsIndex),d=Zd(l,i),u=d?[]:l,h=e.returnGeometry||await jh(e);if(d&&!h)return;const p=await qh({layer:t,graphic:i,outFields:u,objectIds:r,returnGeometry:h,spatialReference:s},n);p&&(p.geometry&&(i.geometry=p.geometry),p.attributes&&(i.attributes={...i.attributes,...p.attributes}))}function Et(i=""){return!!i&&i.includes(Nl)}function Zh(i){return i?`${Nl}${i.layerId}/${i.fieldName}`:""}function jr({attributes:i,graphic:e,relatedInfo:t,fieldInfos:s,fieldInfoMap:n,layer:o}){i&&e&&t&&Object.keys(e.attributes).forEach(r=>{const l=Zh({layerId:t.relation.id.toString(),fieldName:r}),d=e.attributes[r];i[l]=ql({fieldName:l,fieldInfos:s,fieldInfoMap:n,layer:o,value:d,graphic:e})})}function Kh({attributes:i,relatedInfo:e,fieldInfoMap:t,fieldInfos:s,layer:n}){i&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach(o=>jr({attributes:i,graphic:o,relatedInfo:e,fieldInfoMap:t,fieldInfos:s,layer:n})),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach(o=>jr({attributes:i,graphic:o,relatedInfo:e,fieldInfoMap:t,fieldInfos:s,layer:n})))}const Wr=i=>{if(!i)return!1;const e=i.toUpperCase();return e.includes("CURRENT_TIMESTAMP")||e.includes("CURRENT_DATE")||e.includes("CURRENT_TIME")},jl=({layer:i,method:e,query:t,definitionExpression:s})=>{var r,l;if(!((l=(r=i.capabilities)==null?void 0:r.query)!=null&&l.supportsCacheHint)||e==="attachments")return;const n=M(t.where)&&t.where,o=M(t.geometry)&&t.geometry;Wr(s)||Wr(n)||(o==null?void 0:o.type)==="extent"||t.resultType==="tile"||(t.cacheHint=!0)},Yh=({query:i,layer:e,method:t})=>{jl({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})},Qh=({queryPayload:i,layer:e,method:t})=>{jl({layer:e,method:t,query:i,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})};function Jh(i,e,t){return i&&e&&t?Zr(i.allLayers,e,t)||Zr(i.allTables,e,t):null}function Zr(i,e,t){return i.find(s=>s!==e&&s.type==="feature"&&s.url===e.url&&s.layerId===t.relatedTableId)}const Kr={editing:!1,operations:{add:!0,update:!0,delete:!0}},Wl=ee.ofType(Wd);let ke=class extends V{constructor(e){super(e),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...Kr},this.activeAttachmentInfo=null,this.activeFileInfo=null,this.attachmentInfos=new Wl,this.fileInfos=new ee,this.graphic=null,this.mode="view",this.filesEnabled=!1,this.addHandles(v(()=>this.graphic,()=>this._graphicChanged(),U))}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(e){return{...Kr,...e}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){const{graphic:e}=this;if(!e)return!1;const t=e.layer||e.sourceLayer;return(t==null?void 0:t.loaded)&&"capabilities"in t&&"operations"in t.capabilities&&"supportsResizeAttachments"in t.capabilities.operations&&t.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const{_attachmentLayer:e,attachmentInfos:t}=this;if(!e||typeof e.queryAttachments!="function")throw new k("invalid-layer","getAttachments(): A valid layer is required.");const s=this._getObjectId(),n=new Ir({objectIds:[s],returnMetadata:!0}),o=[],r=e.queryAttachments(n).then(d=>d[s]||o).catch(()=>o);this._getAttachmentsPromise=r,this.notifyChange("state");const l=await r;return t.removeAll(),l.length&&t.addMany(l),this._getAttachmentsPromise=null,this.notifyChange("state"),l}async addAttachment(e,t=this.graphic){const{_attachmentLayer:s,attachmentInfos:n,abilities:o}=this;if(!t)throw new k("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:t});if(!e)throw new k("invalid-attachment","addAttachment(): An attachment is required.",{attachment:e});if(!o.operations.add)throw new k("invalid-abilities","addAttachment(): add abilities are required.");if(!s||typeof s.addAttachment!="function")throw new k("invalid-layer","addAttachment(): A valid layer is required.");const r=s.addAttachment(t,e).then(d=>this._queryAttachment(d.objectId,t)),l=await r;return n.add(l),l}async deleteAttachment(e){const{_attachmentLayer:t,attachmentInfos:s,graphic:n,abilities:o}=this;if(!e)throw new k("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!o.operations.delete)throw new k("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!t||typeof t.deleteAttachments!="function")throw new k("invalid-layer","deleteAttachment(): A valid layer is required.");const r=t.deleteAttachments(n,[e.id]).then(()=>e),l=await r;return s.remove(l),l}async updateAttachment(e,t=this.activeAttachmentInfo){const{_attachmentLayer:s,attachmentInfos:n,graphic:o,abilities:r}=this;if(!e)throw new k("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:e});if(!t)throw new k("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!r.operations.update)throw new k("invalid-abilities","updateAttachment(): Update abilities are required.");const l=n.findIndex(h=>h===t);if(!s||typeof s.updateAttachment!="function")throw new k("invalid-layer","updateAttachment(): A valid layer is required.");const d=s.updateAttachment(o,t.id,e).then(h=>this._queryAttachment(h.objectId)),u=await d;return n.splice(l,1,u),u}async commitFiles(){return await Promise.all(this.fileInfos.items.map(e=>this.addAttachment(e.form))),this.fileInfos.removeAll(),this.getAttachments()}addFile(e,t){if(!e||!t)return null;const s={file:e,form:t};return this.fileInfos.add(s),s}updateFile(e,t,s=this.activeFileInfo){if(!e||!t||!s)return null;const n=this.fileInfos.findIndex(o=>s===o);return n>-1&&this.fileInfos.splice(n,1,{file:e,form:t}),this.fileInfos.items[n]}deleteFile(e){const t=this.fileInfos.find(s=>s.file===e);return this.fileInfos.remove(t)??null}async _queryAttachment(e,t){if(!e)throw new k("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:s}=this,n=this._getObjectId(t),o=new Ir({objectIds:[n],attachmentsWhere:`AttachmentId=${e}`,returnMetadata:!0});return s.queryAttachments(o).then(r=>r[n][0])}_getObjectId(e=this.graphic){return(e==null?void 0:e.getObjectId())??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){const{graphic:e}=this,t=zl(e);this._attachmentLayer=t?t.type==="scene"&&M(t.associatedLayer)?t.associatedLayer:t:null}};a([c()],ke.prototype,"abilities",void 0),a([be("abilities")],ke.prototype,"castAbilities",null),a([c()],ke.prototype,"activeAttachmentInfo",void 0),a([c()],ke.prototype,"activeFileInfo",void 0),a([c({readOnly:!0,type:Wl})],ke.prototype,"attachmentInfos",void 0),a([c()],ke.prototype,"fileInfos",void 0),a([c({type:lt})],ke.prototype,"graphic",void 0),a([c()],ke.prototype,"mode",void 0),a([c({readOnly:!0})],ke.prototype,"state",null),a([c()],ke.prototype,"filesEnabled",void 0),a([c({readOnly:!0})],ke.prototype,"supportsResizeAttachments",null),ke=a([b("esri.widgets.Attachments.AttachmentsViewModel")],ke);const Yo=ke;function Yr(i){const e=i.toLowerCase();return e==="image/bmp"||e==="image/emf"||e==="image/exif"||e==="image/gif"||e==="image/x-icon"||e==="image/jpeg"||e==="image/png"||e==="image/tiff"||e==="image/x-wmf"}function Xh(i){const e=bl("esri/themes/base/images/files/");return i?i==="text/plain"?`${e}text-32.svg`:i==="application/pdf"?`${e}pdf-32.svg`:i==="text/csv"?`${e}csv-32.svg`:i==="application/gpx+xml"?`${e}gpx-32.svg`:i==="application/x-dwf"?`${e}cad-32.svg`:i==="application/postscript"||i==="application/json"||i==="text/xml"||i==="model/vrml"?`${e}code-32.svg`:i==="application/x-zip-compressed"||i==="application/x-7z-compressed"||i==="application/x-gzip"||i==="application/x-tar"||i==="application/x-gtar"||i==="application/x-bzip2"||i==="application/gzip"||i==="application/x-compress"||i==="application/x-apple-diskimage"||i==="application/x-rar-compressed"||i==="application/zip"?`${e}zip-32.svg`:i.includes("image/")?`${e}image-32.svg`:i.includes("audio/")?`${e}sound-32.svg`:i.includes("video/")?`${e}video-32.svg`:i.includes("msexcel")||i.includes("ms-excel")||i.includes("spreadsheetml")?`${e}excel-32.svg`:i.includes("msword")||i.includes("ms-word")||i.includes("wordprocessingml")?`${e}word-32.svg`:i.includes("powerpoint")||i.includes("presentationml")?`${e}report-32.svg`:`${e}generic-32.svg`:`${e}generic-32.svg`}const Qr={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},C={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},zn=window.CSS;let we=class extends pe{constructor(e,t){super(e,t),this.displayType="auto",this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new Yo,this.visibleElements={...Qr},this._supportsImageOrientation=zn&&zn.supports&&zn.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.addHandles([Ze(()=>{var e;return(e=this.viewModel)==null?void 0:e.attachmentInfos},"change",()=>this.scheduleRender()),Ze(()=>{var e;return(e=this.viewModel)==null?void 0:e.fileInfos},"change",()=>this.scheduleRender()),v(()=>{var e;return(e=this.viewModel)==null?void 0:e.mode},()=>this._modeChanged(),U)])}loadDependencies(){return Promise.all([I(()=>import("./calcite-icon-901434b0.js"),["assets/calcite-icon-901434b0.js","assets/icon-ba19bc6b.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/observers-32bcc375.js"])])}get abilities(){return this.viewModel.abilities}set abilities(e){this.viewModel.abilities=e}get effectiveDisplayType(){const{displayType:e}=this;return e&&e!=="auto"?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...Qr,...e}}addAttachment(){const{_addAttachmentForm:e,viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.addAttachment(e).then(s=>(this._set("submitting",!1),this._set("error",null),t.mode="view",s)).catch(s=>{throw this._set("submitting",!1),this._set("error",new k("attachments:add-attachment",this.messages.addErrorMessage,s)),s})}deleteAttachment(e){const{viewModel:t}=this;return this._set("submitting",!0),this._set("error",null),t.deleteAttachment(e).then(s=>(this._set("submitting",!1),this._set("error",null),t.mode="view",s)).catch(s=>{throw this._set("submitting",!1),this._set("error",new k("attachments:delete-attachment",this.messages.deleteErrorMessage,s)),s})}updateAttachment(){const{viewModel:e}=this,{_updateAttachmentForm:t}=this;return this._set("submitting",!0),this._set("error",null),e.updateAttachment(t).then(s=>(this._set("submitting",!1),this._set("error",null),e.mode="view",s)).catch(s=>{throw this._set("submitting",!1),this._set("error",new k("attachments:update-attachment",this.messages.updateErrorMessage,s)),s})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);return this.viewModel.mode="view",e}updateFile(){const{viewModel:e}=this,t=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);return e.mode="view",t}deleteFile(e){const t=this.viewModel.deleteFile(e||this.viewModel.activeFileInfo.file);return this.viewModel.mode="view",t}render(){const{submitting:e,viewModel:t}=this,{state:s}=t;return m("div",{class:this.classes(C.base,C.esriWidget)},e?this.renderProgressBar():null,s==="loading"?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:e,visibleElements:t}=this;return e&&t.errorMessage?m("div",{key:"error-message",class:C.errorMessage},e.message):null}renderAttachments(){const{activeFileInfo:e,mode:t,activeAttachmentInfo:s}=this.viewModel;return t==="add"?this.renderAddForm():t==="edit"?this.renderDetailsForm(s||e):this.renderAttachmentContainer()}renderLoading(){return m("div",{class:C.loaderContainer,key:"loader"},m("div",{class:C.loader}))}renderProgressBar(){return this.visibleElements.progressBar?m("div",{class:C.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:e,selectedFile:t}=this,s=e||!t,n=this.visibleElements.cancelAddButton?m("button",{type:"button",bind:this,disabled:e,onclick:this._cancelForm,class:this.classes(C.esriButton,C.esriButtonTertiary,C.esriButtonSmall,C.esriButtonHalf,e&&C.buttonDisabled)},this.messages.cancel):null,o=this.visibleElements.addSubmitButton?m("button",{type:"submit",disabled:s,class:this.classes(C.esriButton,C.esriButtonSecondary,C.esriButtonSmall,C.esriButtonHalf,{[C.buttonDisabled]:s})},this.messages.add):null,r=t?m("span",{key:"file-name",class:C.fileName},t.name):null,l=m("form",{bind:this,afterCreate:nn,afterRemoved:vr,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},m("fieldset",{class:C.fileFieldset},r,m("label",{class:this.classes(C.fileLabel,C.esriButton,C.esriButtonSecondary)},t?this.messages.changeFile:this.messages.selectFile,m("input",{class:C.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),o,n);return m("div",{key:"add-form-container",class:C.formNode},l)}renderDetailsForm(e){const{visibleElements:t,viewModel:s,selectedFile:n,submitting:o}=this,{abilities:r}=s,l=o||!n;let d,u,h,p;n?(d=n.type,u=n.name,h=n.size):"file"in e?(d=e.file.type,u=e.file.name,h=e.file.size):(d=e.contentType,u=e.name,h=e.size,p=e.url);const g=r.editing&&r.operations.delete&&t.deleteButton?m("button",{key:"delete-button",type:"button",disabled:o,bind:this,onclick:O=>this._submitDeleteAttachment(O,e),class:this.classes(C.esriButton,C.esriButtonSmall,C.esriButtonTertiary,C.deleteButton,{[C.buttonDisabled]:o})},this.messages.delete):void 0,f=r.editing&&r.operations.update&&t.updateButton?m("button",{disabled:l,key:"update-button",type:"submit",class:this.classes(C.esriButton,C.esriButtonSmall,C.esriButtonThird,{[C.buttonDisabled]:l})},this.messages.update):void 0,_=this.visibleElements.cancelUpdateButton?m("button",{disabled:o,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(C.esriButton,C.esriButtonSmall,C.esriButtonTertiary,C.esriButtonThird,{[C.buttonDisabled]:o})},this.messages.cancel):void 0,T=r.editing&&r.operations.update?m("fieldset",{key:"file",class:C.fileFieldset},m("span",{key:"file-name",class:C.fileName},u),m("label",{class:this.classes(C.fileLabel,C.esriButton,C.esriButtonSecondary)},this.messages.changeFile,m("input",{class:C.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):void 0,w=m("fieldset",{key:"size",class:C.metadataFieldset},m("label",null,wh(this.messagesUnits,h))),E=m("fieldset",{key:"content-type",class:C.metadataFieldset},m("label",null,d)),P=M(p)?m("a",{class:C.itemLink,href:p,rel:"noreferrer",target:"_blank"},this.renderImageMask(e,400),m("div",{class:C.itemLinkOverlay},m("span",{class:C.itemLinkOverlayIcon},m("calcite-icon",{icon:"launch"})))):this.renderImageMask(e,400),$=m("form",{bind:this,afterCreate:nn,afterRemoved:vr,"data-node-ref":"_updateAttachmentForm",onsubmit:O=>this._submitUpdateAttachment(O,e)},m("div",{class:C.metadata},w,E),T,m("div",{class:C.actions},g,_,f));return m("div",{key:"edit-form-container",class:C.formNode},P,$)}renderImageMask(e,t){return"file"in e?this.renderGenericImageMask(e.file.name,e.file.type):this.renderImageMaskForAttachment(e,t)}renderGenericImageMask(e,t){const{supportsResizeAttachments:s}=this.viewModel,n=Xh(t),o={[C.itemImageResizable]:s};return m("div",{class:this.classes(C.itemMaskIcon,C.itemMask)},m("img",{title:e,alt:e,src:n,class:this.classes(o,C.itemImage)}))}renderImageMaskForAttachment(e,t){const{supportsResizeAttachments:s}=this.viewModel,{contentType:n,name:o,url:r}=e;if(!s||!Yr(n))return this.renderGenericImageMask(o,n);const l=this._getCSSTransform(e),d=l?{transform:l,"image-orientation":"none"}:{},u=`${r}${r.includes("?")?"&":"?"}w=${t}`,h={[C.itemImageResizable]:s};return m("div",{class:this.classes(C.itemMask)},m("img",{styles:d,alt:o,title:o,src:u,class:this.classes(h,C.itemImage)}))}renderFile(e){const{file:t}=e;return m("li",{class:C.item,key:t},m("button",{key:"details-button",bind:this,class:C.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,onclick:()=>this._startEditFile(e),type:"button"},this.renderImageMask(e),m("label",{class:C.itemLabel},m("span",{class:C.itemFilename},t.name||this.messages.noTitle),m("span",{"aria-hidden":"true",class:this.classes(C.itemChevronIcon,rt(this.container)?C.iconLeft:C.iconRight)}))))}renderAttachmentInfo({attachmentInfo:e,displayType:t}){const{viewModel:s,effectiveDisplayType:n}=this,{abilities:o,supportsResizeAttachments:r}=s,{contentType:l,name:d,url:u}=e,h=this.renderImageMask(e,t==="list"?48:400),p=o.editing?m("span",{"aria-hidden":"true",class:this.classes(C.itemChevronIcon,rt(this.container)?C.iconLeft:C.iconRight)}):null,g=[h,n==="preview"&&r&&Yr(l)?null:m("label",{class:C.itemLabel},m("span",{class:C.itemFilename},d||this.messages.noTitle),p)],f=o.editing?m("button",{key:"details-button",bind:this,class:C.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":e.id,onclick:()=>this._startEditAttachment(e),type:"button"},g):m("a",{key:"details-link",class:C.itemButton,href:u,target:"_blank"},g);return m("li",{class:C.item,key:e},f)}renderAttachmentContainer(){const{effectiveDisplayType:e,viewModel:t,visibleElements:s}=this,{attachmentInfos:n,abilities:o,fileInfos:r}=t,l=!!(n!=null&&n.length),d=!!(r!=null&&r.length),u={[C.containerList]:e!=="preview",[C.containerPreview]:e==="preview"},h=o.editing&&o.operations.add&&s.addButton?m("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(C.esriButton,C.esriButtonTertiary,C.addAttachmentButton),type:"button"},m("span",{"aria-hidden":"true",class:this.classes(C.itemAddIcon,C.iconPlus)}),this.messages.add):void 0,p=l?m("ul",{key:"attachments-list",class:C.items},n.toArray().map(_=>this.renderAttachmentInfo({attachmentInfo:_,displayType:e}))):void 0,g=d?m("ul",{key:"file-list",class:C.items},r.toArray().map(_=>this.renderFile(_))):void 0,f=d||l?void 0:m("div",{class:C.empty},this.messages.noAttachments);return m("div",{key:"attachments-container",class:this.classes(C.container,u)},p,g,f,h)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(e){const t=e.target,s=t&&t.files&&t.files.item(0);this._set("selectedFile",s)}_submitDeleteAttachment(e,t){e.preventDefault(),"file"in t?this.deleteFile(t.file):this.deleteAttachment(t)}_submitAddAttachment(e){e.preventDefault(),this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,t){e.preventDefault(),"file"in t?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const{viewModel:t}=this;t.activeFileInfo=null,t.activeAttachmentInfo=e,t.mode="edit"}_startEditFile(e){const{viewModel:t}=this;t.activeAttachmentInfo=null,t.activeFileInfo=e,t.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(e){const{orientationInfo:t}=e;return!this._supportsImageOrientation&&t?[t.rotation?`rotate(${t.rotation}deg)`:"",t.mirrored?"scaleX(-1)":""].join(" "):""}};a([c()],we.prototype,"abilities",null),a([c()],we.prototype,"displayType",void 0),a([c({readOnly:!0})],we.prototype,"effectiveDisplayType",null),a([c()],we.prototype,"graphic",null),a([c()],we.prototype,"label",null),a([c(),re("esri/widgets/Attachments/t9n/Attachments")],we.prototype,"messages",void 0),a([c(),re("esri/core/t9n/Units")],we.prototype,"messagesUnits",void 0),a([c({readOnly:!0})],we.prototype,"selectedFile",void 0),a([c({readOnly:!0})],we.prototype,"submitting",void 0),a([c({readOnly:!0})],we.prototype,"error",void 0),a([c({type:Yo})],we.prototype,"viewModel",void 0),a([c()],we.prototype,"visibleElements",void 0),a([be("visibleElements")],we.prototype,"castVisibleElements",null),we=a([b("esri.widgets.Attachments")],we);const ep=we;let as=class extends Yo{constructor(e){super(e),this.description=null,this.title=null}};a([c()],as.prototype,"description",void 0),a([c()],as.prototype,"title",void 0),as=a([b("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],as);const Qo=as,tp={heading:"esri-widget__heading"};function Jo(i,e){const t=ip(i.level),s=`h${t}`;return delete i.level,m(s,{...i,class:zd(tp.heading,i.class),role:"heading","aria-level":String(t)},e)}function ip(i){return Hi(Math.ceil(i),1,6)}const Bn={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let ki=class extends pe{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null}render(){return m("div",{class:Bn.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?m(Jo,{level:this.headingLevel,class:Bn.title},e):null}renderDescription(){const{description:e}=this;return e?m("div",{key:"description",class:Bn.description},e):null}};a([c()],ki.prototype,"description",void 0),a([c()],ki.prototype,"headingLevel",void 0),a([c()],ki.prototype,"title",void 0),ki=a([b("esri.widgets.Feature.support.FeatureElementInfo")],ki);const In=ki,sp={base:"esri-feature-attachments"};let Xe=class extends pe{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new ep,this.headingLevel=2,this.viewModel=new Qo}initialize(){this._featureElementInfo=new In,this.addHandles([v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title,this.headingLevel]},()=>this._setupFeatureElementInfo(),U),v(()=>{var e;return(e=this.viewModel)==null?void 0:e.graphic},e=>this.attachmentsWidget.graphic=e,U)])}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var t;const{attachmentsWidget:e}=this;return m("div",{class:sp.base},(t=this._featureElementInfo)==null?void 0:t.render(),e==null?void 0:e.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:s}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:s})}};a([c({readOnly:!0})],Xe.prototype,"attachmentsWidget",void 0),a([c()],Xe.prototype,"description",null),a([c()],Xe.prototype,"displayType",null),a([c()],Xe.prototype,"graphic",null),a([c()],Xe.prototype,"headingLevel",void 0),a([c()],Xe.prototype,"title",null),a([c({type:Qo})],Xe.prototype,"viewModel",void 0),Xe=a([b("esri.widgets.Feature.FeatureAttachments")],Xe);const np=Xe;let Vt=class extends wn(V){constructor(e){super(e),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(v(()=>this.creator,t=>{this._destroyContent(),this._createContent(t)},U))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:e,graphic:t,destroyer:s}=this;e&&(dn(s,{graphic:t}).catch(()=>null),this._set("created",null))}async _createContent(e){const{graphic:t}=this,s=dn(e,{graphic:t}).catch(()=>null);this._loadingPromise=s,this.notifyChange("state");const n=await s;s===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",n))}};a([c({readOnly:!0})],Vt.prototype,"created",void 0),a([c()],Vt.prototype,"creator",void 0),a([c()],Vt.prototype,"destroyer",void 0),a([c({type:lt})],Vt.prototype,"graphic",void 0),a([c({readOnly:!0})],Vt.prototype,"state",null),Vt=a([b("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],Vt);const un=Vt;function $e(){return function(i,e){if(!i[e])throw new TypeError(`Cannot auto bind undefined function '${e}'`);return{value:rp(i[e])}}}function op(i){const{type:e}=i;return i instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function rp(i){return function(e,...t){op(e)?Bd(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):i.call(this,e,...t)}}function Xo(i){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const t=e._delegatedEventNames,s=Array.isArray(i)?i:ap(i);t.push(...s)}}function ap(i){return i.split(",").map(e=>e.trim())}const Zl="calcite-theme-";function lp(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")}function hn(){return lp().startsWith("dark")}function cp(){return`${Zl}${hn()?"dark":"light"}`}function dp(i){up(i),i.classList.add(cp())}function up(i){Array.from(i.classList).forEach(e=>{e.startsWith(Zl)&&i.classList.remove(e)})}const Un={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let Ai=class extends pe{constructor(e,t){super(e,t),this.viewModel=null,this._addTargetToAnchors=s=>{Array.from(s.querySelectorAll("a")).forEach(n=>{Bl(n.href)&&!n.hasAttribute("target")&&n.setAttribute("target","_blank")})}}get creator(){return this.viewModel.creator}set creator(e){this.viewModel.creator=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}renderLoading(){return m("div",{class:Un.loaderContainer,key:"loader"},m("div",{class:Un.loader}))}renderCreated(){var t;const e=(t=this.viewModel)==null?void 0:t.created;return e?e instanceof HTMLElement?m("div",{key:e,bind:e,afterCreate:this._attachToNode}):ul(e)?m("div",{key:e},!e.destroyed&&e.render()):m("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){var t;const e=(t=this.viewModel)==null?void 0:t.state;return m("div",{class:Un.base},e==="loading"?this.renderLoading():this.renderCreated())}_attachToNode(e){const t=this;e.appendChild(t)}};a([c()],Ai.prototype,"creator",null),a([c()],Ai.prototype,"graphic",null),a([c({type:un})],Ai.prototype,"viewModel",void 0),Ai=a([b("esri.widgets.Feature.FeatureContent")],Ai);const Gs=Ai;let yt=class extends V{constructor(e){super(e),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:e,fieldInfos:t}=this,s=[];return t==null||t.forEach(n=>{if(!(!n.hasOwnProperty("visible")||n.visible))return;const o=n.clone();o.label=Ul(o,e),s.push(o)}),s}};a([c()],yt.prototype,"attributes",void 0),a([c({type:[Jd]})],yt.prototype,"expressionInfos",void 0),a([c()],yt.prototype,"description",void 0),a([c({type:[_l]})],yt.prototype,"fieldInfos",void 0),a([c({readOnly:!0})],yt.prototype,"formattedFieldInfos",null),a([c()],yt.prototype,"title",void 0),yt=a([b("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],yt);const Cn=yt,hp=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function pp(i){let e=null;return hp.some(t=>(t.pattern.test(i)&&(e=t),!!e)),e}function mp(i,e){if(typeof e!="string"||!e)return e;const t=pp(e);if(!t)return e;const s=e.match(t.pattern),n=s&&s[2],o=Ui(Ui(t.label,{messages:i,hierPart:n}),{appName:t.appName}),r=t.target?` target="${t.target}"`:"",l=t.target==="_blank"?' rel="noreferrer"':"";return e.replace(t.pattern,`<a${r} href="$1"${l}>${o}</a>`)}const Zi={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let qe=class extends pe{constructor(e,t){super(e,t),this._featureElementInfo=null,this.viewModel=new Cn,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new In,this.addHandles(v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),U))}destroy(){this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(e){this.viewModel.expressionInfos=e}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(e){this.viewModel.fieldInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}renderFieldInfo(e,t){const{attributes:s}=this.viewModel,n=e.fieldName,o=e.label||n,r=s?s[n]==null?"":s[n]:"",l=!(!e.format||!e.format.dateFormat),d=typeof r=="number"&&!l?this._forceLTR(r):mp(this.messagesURIUtils,r),u={[Zi.fieldDataDate]:l};return m("tr",{key:`fields-element-info-row-${n}-${t}`},m("th",{key:`fields-element-info-row-header-${n}-${t}`,class:Zi.fieldHeader,innerHTML:o}),m("td",{key:`fields-element-info-row-data-${n}-${t}`,class:this.classes(Zi.fieldData,u),innerHTML:d}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e!=null&&e.length?m("table",{class:Zi.esriTable,summary:this.messages.fieldsSummary},m("tbody",null,e.map((t,s)=>this.renderFieldInfo(t,s)))):null}render(){var e;return m("div",{class:Zi.base},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_forceLTR(e){return`&lrm;${e}`}};a([c()],qe.prototype,"attributes",null),a([c()],qe.prototype,"description",null),a([c()],qe.prototype,"expressionInfos",null),a([c()],qe.prototype,"fieldInfos",null),a([c()],qe.prototype,"title",null),a([c({type:Cn,nonNullable:!0})],qe.prototype,"viewModel",void 0),a([c(),re("esri/widgets/Feature/t9n/Feature")],qe.prototype,"messages",void 0),a([c(),re("esri/widgets/support/t9n/uriUtils")],qe.prototype,"messagesURIUtils",void 0),qe=a([b("esri.widgets.Feature.FeatureFields")],qe);const Kl=qe,gp={maximumFractionDigits:20};function fp(i){return Bo(i,gp)}const _p="<",yp=">",vp=fl("short-date");function wp(i,e,t,s){let n="";e===0?n=`${_p} `:e===t&&(n=`${yp} `);let o=null;return o=s?on(i,vp):fp(i),n+o}const bp=new Jt([64,64,64]);function Mp(i,e){const t=[],s=i.length-1;return i.length===5?t.push(0,2,4):t.push(0,s),i.map((n,o)=>t.includes(o)?wp(n,o,s,e):null)}async function Ip(i,e,t){let s=!1,n=[],o=[];if(i.stops){const u=i.stops;n=u.map(h=>h.value),s=u.some(h=>!!h.label),s&&(o=u.map(h=>h.label))}const r=n[0],l=n[n.length-1];if(r==null&&l==null)return null;const d=s?null:Mp(n,t);return(await Promise.all(n.map(async(u,h)=>({value:u,color:i.type==="opacity"?await Cp(u,i,e):(await I(()=>import("./UniqueValueRenderer-8e382829.js").then(p=>p.v),["assets/UniqueValueRenderer-8e382829.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/enumeration-497ef064.js","assets/jsonMap-5afaf2ff.js","assets/Extent-d5fff12d.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/geometry-70b2a4a5.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/locale-30120714.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/Clonable-58355d3c.js","assets/LegendOptions-e31ff575.js","assets/reactiveUtils-b0e56010.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-34c50417.js","assets/PopupTemplate-29fe62b5.js","assets/number-c7f1bfee.js","assets/Identifiable-57df9761.js","assets/jsonUtils-5115c7e5.js","assets/compilerUtils-eefea0ec.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js"])).getColor(i,u),label:s?o[h]:d[h]})))).reverse()}async function Cp(i,e,t=bp){const s=new Jt(t),n=(await I(()=>import("./UniqueValueRenderer-8e382829.js").then(o=>o.v),["assets/UniqueValueRenderer-8e382829.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/enumeration-497ef064.js","assets/jsonMap-5afaf2ff.js","assets/Extent-d5fff12d.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/geometry-70b2a4a5.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/locale-30120714.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/Clonable-58355d3c.js","assets/LegendOptions-e31ff575.js","assets/reactiveUtils-b0e56010.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-34c50417.js","assets/PopupTemplate-29fe62b5.js","assets/number-c7f1bfee.js","assets/Identifiable-57df9761.js","assets/jsonUtils-5115c7e5.js","assets/compilerUtils-eefea0ec.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js"])).getOpacity(e,i);return n!=null&&(s.a=n),s}function Tp(i){if(!i.colorStops)return[];const e=[...i.colorStops].filter(s=>{var n;return((n=s.color)==null?void 0:n.a)>0});let t=e.length-1;if(e&&e[0]){const s=e[t];s&&s.ratio!==1&&(e.push(new uu({ratio:1,color:s.color})),t++)}return e.map((s,n)=>{var r,l;let o="";return n===0?o=((r=i.legendOptions)==null?void 0:r.minLabel)||"low":n===t&&(o=((l=i.legendOptions)==null?void 0:l.maxLabel)||"high"),{color:s.color,label:o,ratio:s.ratio}}).reverse()}N.getLogger("esri.renderers.support.utils");async function Le(i,e,t){gd(i,e,()=>[]).push(...t)}async function Ep(i){var t,s;const e=new Map;if(!i)return e;if("visualVariables"in i&&i.visualVariables){const n=i.visualVariables.filter(o=>o.type==="color");for(const o of n){const r=(await Ip(o)).map(l=>l.color);await Le(e,o.field||o.valueExpression,r)}}if(i.type==="heatmap"){const n=Tp(i).map(o=>o.color);await Le(e,i.field||i.valueExpression,n)}else if(i.type==="pie-chart"){for(const n of i.attributes)await Le(e,n.field||n.valueExpression,[n.color]);await Le(e,"default",[(t=i==null?void 0:i.othersCategory)==null?void 0:t.color,bi(i.backgroundFillSymbol,null)])}else if(i.type==="dot-density"){for(const n of i.attributes)await Le(e,n.field||n.valueExpression,[n.color]);await Le(e,"default",[i.backgroundColor])}else if(i.type==="unique-value")if(((s=i.authoringInfo)==null?void 0:s.type)==="predominance")for(const n of i.uniqueValueInfos??[])await Le(e,n.value.toString(),[bi(n.symbol,null)]);else{const n=(i.uniqueValueInfos??[]).map(u=>bi(u.symbol,null)),{field:o,field2:r,field3:l,valueExpression:d}=i;(o||d)&&await Le(e,o||d,n),r&&await Le(e,r,n),l&&await Le(e,l,n)}else if(i.type==="class-breaks"){const n=i.classBreakInfos.map(l=>bi(l.symbol,null)),{field:o,valueExpression:r}=i;await Le(e,o??r,n)}else i.type==="simple"&&await Le(e,"default",[bi(i.symbol,null)]);return"defaultSymbol"in i&&i.defaultSymbol&&await Le(e,"default",[bi(i.defaultSymbol,null)]),e.forEach((n,o)=>{const r=Md(n.filter(Boolean),(l,d)=>JSON.stringify(l)===JSON.stringify(d));e.set(o,r)}),e}const xp="esri.widgets.Feature.support.relatedFeatureUtils",Jr=N.getLogger(xp),Xr=new Map;function Io(i){if(!Et(i))return null;const[e,t]=i.split("/").slice(1);return{layerId:e,fieldName:t}}function kp(i,e){if(!e.relationships)return null;let t=null;const{relationships:s}=e;return s.some(n=>n.id===parseInt(i,10)&&(t=n,!0)),t}function Ap({originRelationship:i,relationships:e,layerId:t}){let s;return e&&e.some(n=>(`${n.relatedTableId}`===t&&n.id===i.id&&(s=n),!!s)),s}function Pp(i,e){const t=e.toLowerCase();for(const s in i)if(s.toLowerCase()===t)return i[s];return null}function $p(i,e){const t=kp(i,e);if(t)return{url:`${e.url}/${t.relatedTableId}`,sourceSpatialReference:e.spatialReference,relation:t,relatedFields:[],outStatistics:[]}}function Sp(i,e){if(!e||!i)return;const{features:t,statsFeatures:s}=i,n=t&&t.value;e.relatedFeatures=n?n.features:[];const o=s&&s.value;e.relatedStatsFeatures=o?o.features:[]}function Rp(i,e,t,s){const n=new co;return n.outFields=["*"],n.relationshipId=typeof e.id=="number"?e.id:parseInt(e.id,10),n.objectIds=[i.attributes[t.objectIdField]],t.queryRelatedFeatures(n,s)}function Lp(i,e,t){let s=0;const n=[];for(;s<e.length;)n.push(`${i} IN (${e.slice(s,t+s)})`),s+=t;return n.join(" OR ")}async function Fp(i,e,t,s){const n=t.layerId.toString(),{layerInfo:o,relation:r,relatedFields:l,outStatistics:d,url:u,sourceSpatialReference:h}=e,p=Ap({originRelationship:r,relationships:o.relationships,layerId:n});if(p.relationshipTableId&&p.keyFieldInRelationshipTable){const f=(await Rp(i,p,t,s))[i.attributes[t.objectIdField]];if(!f)return null;const _=f.features.map(T=>T.attributes[o.objectIdField]);if((d==null?void 0:d.length)>0&&o.supportsStatistics){const T=new Rn;T.where=Lp(o.objectIdField,_,1e3),T.outFields=l,T.outStatistics=d,T.sourceSpatialReference=h;const w={features:Promise.resolve(f),statsFeatures:$n(u,T)};return Xt(w)}}const g=p==null?void 0:p.keyField;if(g){const f=Yd(zp(o.fields,g)),_=Pp(i.attributes,r.keyField),T=f?`${g}=${_}`:`${g}='${_}'`,w=$n(u,new Rn({where:T,outFields:e.relatedFields,sourceSpatialReference:h}),s),E=e.outStatistics&&e.outStatistics.length>0&&o.supportsStatistics?$n(u,new Rn({where:T,outFields:e.relatedFields,outStatistics:e.outStatistics,sourceSpatialReference:h}),s):null,P={features:w};return E&&(P.statsFeatures=E),Xt(P)}return null}function Op(i,e){return ll(i,{query:{f:"json"},signal:e&&e.signal})}function Dp({relatedInfos:i,layer:e},t){const s={};return i.forEach((n,o)=>{const{relation:r}=n;if(!r){const p=new k("relation-required","A relation is required on a layer to retrieve related records.");throw Jr.error(p),p}const{relatedTableId:l}=r;if(typeof l!="number"){const p=new k("A related table ID is required on a layer to retrieve related records.");throw Jr.error(p),p}const d=`${e.url}/${l}`,u=Xr.get(d),h=u||Op(d,t);u||Xr.set(d,h),s[o]=h}),Xt(s)}function Vp({graphic:i,relatedInfos:e,layer:t},s){const n={};return e.forEach((o,r)=>{o.layerInfo&&(n[r]=Fp(i,o,t,s))}),Xt(n)}function Np({relatedInfo:i,fieldName:e,fieldInfo:t}){if(i.relatedFields.push(e),t.statisticType){const s=new hu({statisticType:t.statisticType,onStatisticField:e,outStatisticFieldName:e});i.outStatistics.push(s)}}function zp(i,e){if(i!=null){e=e.toLowerCase();for(const t of i)if(t&&t.name.toLowerCase()===e)return t}return null}const ea={chartAnimation:!0};let de=class extends V{constructor(e){super(e),this.abilities={...ea},this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}castAbilities(e){return{...ea,...e}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(e){this._setContentElementMedia(e)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(e){const{formattedMediaInfoCount:t}=this,s=(e+t)%t;this.activeMediaInfoIndex=s}_pageContentElementMedia(e){const{activeMediaInfoIndex:t}=this,s=t+e;this._setContentElementMedia(s)}_formatMediaInfos(){const{attributes:e,mediaInfos:t,formattedAttributes:s,expressionAttributes:n,fieldInfoMap:o,layer:r}=this;return t==null?void 0:t.map(l=>{const d=l==null?void 0:l.clone();if(!d)return null;if(d.title=fi({attributes:e,fieldInfoMap:o,globalAttributes:s,expressionAttributes:n,layer:r,text:d.title}),d.caption=fi({attributes:e,fieldInfoMap:o,globalAttributes:s,expressionAttributes:n,layer:r,text:d.caption}),d.altText=fi({attributes:e,fieldInfoMap:o,globalAttributes:s,expressionAttributes:n,layer:r,text:d.altText}),d.type==="image"){const{value:u}=d;return this._setImageValue({value:u,formattedAttributes:s,layer:r}),d.value.sourceURL?d:void 0}if(d.type==="pie-chart"||d.type==="line-chart"||d.type==="column-chart"||d.type==="bar-chart"){const{value:u}=d;return this._setChartValue({value:u,chartType:d.type,attributes:e,formattedAttributes:s,layer:r,expressionAttributes:n}),d}return null}).filter(Boolean)}_setImageValue(e){const{fieldInfoMap:t}=this,{value:s,formattedAttributes:n,layer:o}=e,{linkURL:r,sourceURL:l}=s;if(l){const d=Mo(l,o);s.sourceURL=bo({formattedAttributes:n,template:d,fieldInfoMap:t})}if(r){const d=Mo(r,o);s.linkURL=bo({formattedAttributes:n,template:d,fieldInfoMap:t})}}_setChartValue(e){const{value:t,attributes:s,formattedAttributes:n,chartType:o,layer:r,expressionAttributes:l}=e,{popupTemplate:d,relatedInfos:u}=this,{fields:h,normalizeField:p}=t;if(t.fields=Sh(h,r),p&&(t.normalizeField=bs(p,r)),!h.some(f=>!!(n[f]!=null||Et(f)&&u.size)))return;const g=d==null?void 0:d.fieldInfos;h.forEach(f=>{if(Et(f))return void(t.series=[...t.series,...this._getRelatedChartInfos({fieldInfos:g,fieldName:f,formattedAttributes:n,chartType:o,value:t})]);const _=this._getChartOption({value:t,attributes:s,chartType:o,formattedAttributes:n,expressionAttributes:l,fieldName:f,fieldInfos:g});t.series.push(_)})}_getRelatedChartInfos(e){var T;const{fieldInfos:t,fieldName:s,formattedAttributes:n,chartType:o,value:r}=e,l=[],d=Io(s),{layerId:u,fieldName:h}=d,p=(T=this.relatedInfos)==null?void 0:T.get(u.toString());if(!p)return l;const{relatedFeatures:g,relation:f}=p;if(!f||!g)return l;const{cardinality:_}=f;return g.forEach(w=>{const{attributes:E}=w;E&&Object.keys(E).forEach(P=>{P===h&&l.push(this._getChartOption({value:r,attributes:E,formattedAttributes:n,fieldName:s,chartType:o,relatedFieldName:P,fieldInfos:t}))})}),_==="one-to-many"||_==="many-to-many"?l:[l[0]]}_getTooltip({label:e,value:t,chartType:s}){return s==="pie-chart"?`${e}`:`${e}: ${t}`}_getChartOption(e){var R;const{value:t,attributes:s,formattedAttributes:n,expressionAttributes:o,fieldName:r,relatedFieldName:l,fieldInfos:d,chartType:u}=e,{layer:h,fieldInfoMap:p}=this,{normalizeField:g,tooltipField:f}=t,_=g?Et(g)?s[Io(g).fieldName]:s[g]:null,T=Wo(r)&&o&&o[r]!==void 0?o[r]:l&&s[l]!==void 0?s[l]:s[r]!==void 0?s[r]:n[r],w=new Xd({fieldName:r,value:T===void 0?null:T&&_?T/_:T});if(Et(r)){const x=p.get(r.toLowerCase()),H=p.get(f.toLowerCase()),G=(x==null?void 0:x.fieldName)??r,z=n[(H==null?void 0:H.fieldName)??f]??(x==null?void 0:x.label)??(x==null?void 0:x.fieldName)??l,Z=n[G];return w.tooltip=this._getTooltip({label:z,value:Z,chartType:u}),w}const E=Gl(d,r),P=bs(r,h),$=f&&n[f]!==void 0?n[f]:Ul(E||new _l({fieldName:P}),(R=this.popupTemplate)==null?void 0:R.expressionInfos),O=n[P];return w.tooltip=this._getTooltip({label:$,value:O,chartType:u}),w}};a([c()],de.prototype,"abilities",void 0),a([be("abilities")],de.prototype,"castAbilities",null),a([c()],de.prototype,"activeMediaInfoIndex",void 0),a([c({readOnly:!0})],de.prototype,"activeMediaInfo",null),a([c()],de.prototype,"attributes",void 0),a([c()],de.prototype,"description",void 0),a([c()],de.prototype,"fieldInfoMap",void 0),a([c()],de.prototype,"formattedAttributes",void 0),a([c()],de.prototype,"expressionAttributes",void 0),a([c({readOnly:!0})],de.prototype,"formattedMediaInfos",null),a([c()],de.prototype,"layer",void 0),a([c({readOnly:!0})],de.prototype,"formattedMediaInfoCount",null),a([c()],de.prototype,"mediaInfos",void 0),a([c()],de.prototype,"popupTemplate",void 0),a([c()],de.prototype,"relatedInfos",void 0),a([c()],de.prototype,"title",void 0),de=a([b("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],de);const _i=de;var ta=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],Bp=[].concat(ta.slice(30,39),ta.slice(28,30).reverse()),Up=[{name:"default",colors:Bp},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const ia="en-us",er=new Map([["ar",()=>I(()=>import("./ar-7e4d7001.js"),["assets/ar-7e4d7001.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.a)],["bg-bg",()=>I(()=>import("./bg_BG-fa0eaeae.js"),["assets/bg_BG-fa0eaeae.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.b)],["bs-ba",()=>I(()=>import("./bs_BA-4f949e9b.js"),["assets/bs_BA-4f949e9b.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.b)],["ca-es",()=>I(()=>import("./ca_ES-ac250c21.js"),["assets/ca_ES-ac250c21.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.c)],["cs-cz",()=>I(()=>import("./cs_CZ-41aa2dde.js"),["assets/cs_CZ-41aa2dde.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.c)],["da-dk",()=>I(()=>import("./da_DK-3cc83778.js"),["assets/da_DK-3cc83778.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["de-de",()=>I(()=>import("./de_DE-7cf156b8.js"),["assets/de_DE-7cf156b8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["de-ch",()=>I(()=>import("./de_CH-b40119c2.js"),["assets/de_CH-b40119c2.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.d)],["el-gr",()=>I(()=>import("./el_GR-f5b4e421.js"),["assets/el_GR-f5b4e421.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["en-us",()=>I(()=>import("./en_US-b653138f.js"),["assets/en_US-b653138f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["en-ca",()=>I(()=>import("./en_CA-b653138f.js"),["assets/en_CA-b653138f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["es-es",()=>I(()=>import("./es_ES-21713ea8.js"),["assets/es_ES-21713ea8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["et-ee",()=>I(()=>import("./et_EE-7e4a5525.js"),["assets/et_EE-7e4a5525.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.e)],["fi-fi",()=>I(()=>import("./fi_FI-9ff24319.js"),["assets/fi_FI-9ff24319.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.f)],["fr-fr",()=>I(()=>import("./fr_FR-51c37695.js"),["assets/fr_FR-51c37695.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.f)],["he-il",()=>I(()=>import("./he_IL-5c441159.js"),["assets/he_IL-5c441159.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["hr-hr",()=>I(()=>import("./hr_HR-f42ffa87.js"),["assets/hr_HR-f42ffa87.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["hu-hu",()=>I(()=>import("./hu_HU-5fba6ab9.js"),["assets/hu_HU-5fba6ab9.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.h)],["id-id",()=>I(()=>import("./id_ID-981fbb86.js"),["assets/id_ID-981fbb86.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.i)],["it-it",()=>I(()=>import("./it_IT-c635b784.js"),["assets/it_IT-c635b784.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.i)],["ja-jp",()=>I(()=>import("./ja_JP-e2cf7b21.js"),["assets/ja_JP-e2cf7b21.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.j)],["ko-kr",()=>I(()=>import("./ko_KR-32aae4f2.js"),["assets/ko_KR-32aae4f2.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.k)],["lt-lt",()=>I(()=>import("./lt_LT-3c0b9d54.js"),["assets/lt_LT-3c0b9d54.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.l)],["lv-lv",()=>I(()=>import("./lv_LV-c1cc4a4c.js"),["assets/lv_LV-c1cc4a4c.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.l)],["nb-no",()=>I(()=>import("./nb_NO-5958d98d.js"),["assets/nb_NO-5958d98d.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.n)],["nl-nl",()=>I(()=>import("./nl_NL-004b20fd.js"),["assets/nl_NL-004b20fd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.n)],["pl-pl",()=>I(()=>import("./pl_PL-d6d01c5e.js"),["assets/pl_PL-d6d01c5e.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["pt-br",()=>I(()=>import("./pt_BR-a08a6ce1.js"),["assets/pt_BR-a08a6ce1.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["pt-pt",()=>I(()=>import("./pt_PT-d532c840.js"),["assets/pt_PT-d532c840.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.p)],["ro-ro",()=>I(()=>import("./ro_RO-e4007f77.js"),["assets/ro_RO-e4007f77.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.r)],["ru-ru",()=>I(()=>import("./ru_RU-905ac2e8.js"),["assets/ru_RU-905ac2e8.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.r)],["sk-sk",()=>I(()=>import("./sk_SK-cae815ce.js"),["assets/sk_SK-cae815ce.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sl-sl",()=>I(()=>import("./sl_SL-50353bbe.js"),["assets/sl_SL-50353bbe.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sr-rs",()=>I(()=>import("./sr_RS-9a9b8450.js"),["assets/sr_RS-9a9b8450.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["sv-se",()=>I(()=>import("./sv_SE-346c1643.js"),["assets/sv_SE-346c1643.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.s)],["th-th",()=>I(()=>import("./th_TH-210af5ed.js"),["assets/th_TH-210af5ed.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.t)],["tr-tr",()=>I(()=>import("./tr_TR-855c517f.js"),["assets/tr_TR-855c517f.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.t)],["uk-ua",()=>I(()=>import("./uk_UA-7de21af4.js"),["assets/uk_UA-7de21af4.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.u)],["vi-vn",()=>I(()=>import("./vi_VN-f87f03fa.js"),["assets/vi_VN-f87f03fa.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.v)],["zh-cn",()=>I(()=>import("./zh_Hans-79f10982.js"),["assets/zh_Hans-79f10982.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)],["zh-hk",()=>I(()=>import("./zh_Hant-abc409cd.js"),["assets/zh_Hant-abc409cd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)],["zh-tw",()=>I(()=>import("./zh_Hant-abc409cd.js"),["assets/zh_Hant-abc409cd.js","assets/_commonjsHelpers-a430e9ea.js"]).then(i=>i.z)]]);function Hp(i){const e=i.split("-")[0].toLowerCase();let t=null;for(const s of er.keys())if(s.startsWith(e)){t=s;break}return t}function Gp(i){return i?er.has(i.toLowerCase())?i.toLowerCase():Hp(i)||ia:ia}let Ci,Ki;async function qp(i=vu()){if(i=Gp(i),Ci&&i===Ki)return Ci;Ci=I(()=>import("./index-3c8f1bc3.js"),["assets/index-3c8f1bc3.js","assets/_commonjsHelpers-a430e9ea.js"]).then(e=>e.i),Ki=i;try{const[e,t]=await Promise.all([Ci,er.get(Ki)()]);Ki===i&&(e.am4core.options.defaultLocale=t.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return Ci=null,Ki=null,null}return Ci}function jp(i,e="default"){const t=Up.find(s=>s.name===e);return t?t.colors.map(s=>i.color(s)):null}const te={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},Hn=.05,Gn=.95,qn=15,ut="color",Pt="tooltip",Yi="value",sa="default-line-value";let Ae=class extends pe{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.viewModel=new _i,this.messages=null,this._getChartDependencies=async s=>{const n=await qp(),{destroyed:o,viewModel:r}=this;if(o||!r||!s)return;const{activeMediaInfo:l}=r,d=await this._getRendererColors(n);this._renderChart({chartDiv:s,mediaInfo:l,chartsModule:n,colorMap:d})}}initialize(){this._featureElementInfo=new In,this.addHandles([v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.activeMediaInfo,(t=this.viewModel)==null?void 0:t.activeMediaInfoIndex]},()=>this._setupMediaRefreshTimer(),U),v(()=>{var e,t;return[(e=this.viewModel)==null?void 0:e.description,(t=this.viewModel)==null?void 0:t.title]},()=>this._setupFeatureElementInfo(),U)])}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){var e;return m("div",{bind:this,class:te.base,onkeyup:this._handleMediaKeyup},(e=this._featureElementInfo)==null?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?m("div",{key:"media-element-container",class:te.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:s,formattedMediaInfoCount:n}=this.viewModel,{value:o,refreshInterval:r,altText:l,title:d,type:u}=e,{sourceURL:h,linkURL:p}=o,g=Bl(p)?"_blank":"_self",f=g==="_blank"?"noreferrer":"",_=r?t:null,T=_?_.timestamp:0,w=_?_.sourceURL:h,E=m("img",{alt:l||d,key:`media-${u}-${s}-${n}-${T}`,src:w});return(p?m("a",{title:d,href:p,rel:f,target:g},E):null)||E}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:s}=this.viewModel;return m("div",{key:`media-${e.type}-${t}-${s}`,bind:this,class:te.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?e.type==="image"?this.renderImageMediaInfo(e):e.type.includes("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?m("div",{key:"media-title",class:te.mediaItemTitle,innerHTML:e.title}):null,s=e.caption?m("div",{key:"media-caption",class:te.mediaItemCaption,innerHTML:e.caption}):null;return m("div",{key:"media-container",class:te.mediaItemContainer},m("div",{key:"media-item-container",class:te.mediaItem},this.renderMediaInfoType()),t,s)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t=e==="previous",s=t?this.messages.previous:this.messages.next,n=t?this.classes(te.mediaButton,te.mediaPrevious):this.classes(te.mediaButton,te.mediaNext),o=t?this.classes(te.mediaIcon,te.mediaPreviousIconLTR,te.iconLeftTriangleArrow):this.classes(te.mediaIcon,te.mediaNextIconLTR,te.iconRightTriangleArrow),r=t?this.classes(te.mediaIcon,te.mediaPreviousIconRTL,te.iconRightTriangleArrow):this.classes(te.mediaIcon,te.mediaNextIconRTL,te.iconLeftTriangleArrow),l=t?"media-previous":"media-next",d=t?this._previous:this._next;return m("button",{type:"button",key:l,title:s,"aria-label":s,tabIndex:0,class:n,bind:this,onclick:d},m("span",{"aria-hidden":"true",class:o}),m("span",{"aria-hidden":"true",class:r}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getRendererColors(e){var l,d;const{am4core:t}=e,s=new Map,n=(d=(l=this.viewModel)==null?void 0:l.layer)==null?void 0:d.renderer,o="default";if(!n)return s;const r=await Ep(n);return r.delete(o),Array.from(r.values()).every(u=>(u==null?void 0:u.length)===1)&&(s.set(sa,t.color({r:50,g:50,b:50,a:1})),Array.from(r.keys()).forEach(u=>{u&&s.set(u,t.color(r.get(u)[0].toCss(!0)))})),s}_handleMediaKeyup(e){const t=pi(e);t==="ArrowLeft"&&(e.stopPropagation(),this.viewModel.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.viewModel.next())}_renderChart(e){const{abilities:t}=this.viewModel,{chartsModule:s,chartDiv:n,mediaInfo:o,colorMap:r}=e,{value:l,type:d}=o,{am4core:u}=s,h=jp(u);function p(_){_ instanceof u.ColorSet&&h&&(_.list=h)}hn()&&u.useTheme(s.am4themes_dark);const g=window.matchMedia("(prefers-reduced-motion: reduce)");t.chartAnimation&&!g.matches?u.useTheme(s.am4themes_animated):u.unuseTheme(s.am4themes_animated),u.useTheme(p);const f=d==="pie-chart"?this._createPieChart(e):this._createXYChart(e);n.setAttribute("aria-label",o.altText||o.title),f.data=l.series.map(_=>({[Pt]:_.tooltip,[Yi]:_.value,[ut]:r.get(_.fieldName)})).filter(_=>d!=="pie-chart"||_.value>0)}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7})}_createPieChart(e){const{chartDiv:t,chartsModule:s}=e,{am4core:n,am4charts:o}=s,r=n.create(t,o.PieChart);r.rtl=rt(this.container);const l=r.series.push(new o.PieSeries);return l.labels.template.disabled=!0,l.ticks.template.disabled=!0,l.dataFields.value=Yi,l.dataFields.category=Pt,this._customizeChartTooltip(l.tooltip,n),l.slices.template.propertyFields.fill=ut,l.slices.template.propertyFields.stroke=ut,r}_getMinSeriesValue(e){let t=0;return e.forEach(s=>t=Math.min(s.value,t)),t}_createColumnChart(e,t){const{chartsModule:s,mediaInfo:n}=t,{value:o}=n,{am4core:r,am4charts:l}=s,d=e.xAxes.push(new l.CategoryAxis);d.dataFields.category=Pt,d.renderer.labels.template.disabled=!0,this._customizeChartTooltip(d.tooltip,r),d.tooltip.events.on("sizechanged",()=>{d.tooltip.dy=-d.tooltip.contentHeight});const u=e.yAxes.push(new l.ValueAxis),h=u.renderer.labels.template;u.renderer.minLabelPosition=Hn,u.renderer.maxLabelPosition=Gn,u.min=this._getMinSeriesValue(o.series),this._customizeChartTooltip(u.tooltip,r),h.wrap=!0;const p=e.series.push(new l.ColumnSeries);p.dataFields.valueY=Yi,p.dataFields.categoryX=Pt,p.columns.template.propertyFields.fill=ut,p.columns.template.propertyFields.stroke=ut,e.cursor=new l.XYCursor,o.series.length>qn&&(e.scrollbarX=new r.Scrollbar)}_createBarChart(e,t){const{chartsModule:s,mediaInfo:n}=t,{value:o}=n,{am4core:r,am4charts:l}=s,d=e.yAxes.push(new l.CategoryAxis);d.dataFields.category=Pt,d.renderer.inversed=!0,d.renderer.labels.template.disabled=!0,this._customizeChartTooltip(d.tooltip,r),d.tooltip.events.on("sizechanged",()=>{d.tooltip.dx=d.tooltip.contentWidth});const u=e.xAxes.push(new l.ValueAxis),h=u.renderer.labels.template;u.renderer.minLabelPosition=Hn,u.renderer.maxLabelPosition=Gn,u.min=this._getMinSeriesValue(o.series),this._customizeChartTooltip(u.tooltip,r),h.wrap=!0;const p=e.series.push(new l.ColumnSeries);p.dataFields.valueX=Yi,p.dataFields.categoryY=Pt,p.columns.template.propertyFields.fill=ut,p.columns.template.propertyFields.stroke=ut,e.cursor=new l.XYCursor,o.series.length>qn&&(e.scrollbarY=new r.Scrollbar)}_createLineChart(e,t){const{chartsModule:s,mediaInfo:n,colorMap:o}=t,{value:r}=n,{am4core:l,am4charts:d}=s,u=e.xAxes.push(new d.CategoryAxis);u.dataFields.category=Pt,u.renderer.labels.template.disabled=!0,this._customizeChartTooltip(u.tooltip,l),u.tooltip.events.on("sizechanged",()=>{u.tooltip.dy=-u.tooltip.contentHeight});const h=e.yAxes.push(new d.ValueAxis),p=h.renderer.labels.template;h.renderer.minLabelPosition=Hn,h.renderer.maxLabelPosition=Gn,h.min=this._getMinSeriesValue(r.series),this._customizeChartTooltip(h.tooltip,l),p.wrap=!0;const g=e.series.push(new d.LineSeries);g.dataFields.categoryX=Pt,g.dataFields.valueY=Yi,g.strokeWidth=1;const f=o.get(sa);f&&(g.stroke=f);const _=g.bullets.push(new d.CircleBullet);_.propertyFields.fill=ut,_.propertyFields.stroke=ut,e.cursor=new d.XYCursor,r.series.length>qn&&(e.scrollbarX=new l.Scrollbar)}_createXYChart(e){const{chartDiv:t,chartsModule:s,mediaInfo:n}=e,{type:o}=n,{am4core:r,am4charts:l}=s,d=r.create(t,l.XYChart);return d.rtl=rt(this.container),o==="column-chart"&&this._createColumnChart(d,e),o==="bar-chart"&&this._createBarChart(d,e),o==="line-chart"&&this._createLineChart(d,e),d}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&e.type==="image"&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const{refreshInterval:t,value:s}=e;if(!t)return;const n=6e4*t;this._updateMediaInfoTimestamp(s.sourceURL);const o=setInterval(()=>{this._updateMediaInfoTimestamp(s.sourceURL)},n);this._refreshTimer=o}_getImageSource(e,t){const s=e.includes("?")?"&":"?",[n,o=""]=e.split("#");return`${n}${s}timestamp=${t}${o?"#":""}${o}`}};a([c()],Ae.prototype,"attributes",null),a([c()],Ae.prototype,"activeMediaInfoIndex",null),a([c()],Ae.prototype,"description",null),a([c()],Ae.prototype,"fieldInfoMap",null),a([c()],Ae.prototype,"layer",null),a([c()],Ae.prototype,"mediaInfos",null),a([c()],Ae.prototype,"popupTemplate",null),a([c()],Ae.prototype,"relatedInfos",null),a([c()],Ae.prototype,"title",null),a([c({type:_i})],Ae.prototype,"viewModel",void 0),a([c(),re("esri/widgets/Feature/t9n/Feature")],Ae.prototype,"messages",void 0),Ae=a([b("esri.widgets.Feature.FeatureMedia")],Ae);const Yl=Ae,Wp=["$datastore","$map","$layer","$aggregatedfeatures"],Zp="esri.widgets.Feature.support.arcadeFeatureUtils",Kp=N.getLogger(Zp);function Yp(i){return typeof i=="string"?ks(Ko(i)):Array.isArray(i)?Qp(i):(i==null?void 0:i.declaredClass)==="esri.arcade.Dictionary"?Jp(i):i}function Qp(i){return`<ul class="esri-widget__list">${i.map(e=>`<li>${typeof e=="string"?ks(Ko(e)):e}</li>`).join("")}</ul>`}function Jp(i){return`<table class="esri-widget__table">${i.keys().map(e=>{const t=i.field(e);return`<tr><th>${e}</th><td>${typeof t=="string"?ks(Ko(t)):t}</td></tr>`}).join("")}</table>`}function Xp({aggregatedFeatures:i,arcadeUtils:e,featureSetVars:t,context:s,viewInfo:n,map:o,graphic:r,interceptor:l}){t.forEach(d=>{const u=d.toLowerCase(),h={map:o,spatialReference:n.sr,interceptor:l};if(u==="$map"&&(s.vars[u]=e.convertMapToFeatureSetCollection(h)),u==="$layer"&&(s.vars[u]=e.convertFeatureLayerToFeatureSet({layer:r.sourceLayer,spatialReference:n.sr,interceptor:l})),u==="$datastore"&&(s.vars[u]=e.convertServiceUrlToWorkspace({url:r.sourceLayer.url,spatialReference:n.sr,interceptor:l})),u==="$aggregatedfeatures"){const p=r.layer,{fields:g,objectIdField:f,geometryType:_,spatialReference:T,displayField:w}=p,E=new Ml({fields:g,objectIdField:f,geometryType:_,spatialReference:T,displayField:w,...p.type==="feature"?{templates:p.templates,typeIdField:p.typeIdField,types:p.types}:null,source:i});s.vars[u]=e.convertFeatureLayerToFeatureSet({layer:E,spatialReference:n.sr,interceptor:l})}})}function Ql(){return I(()=>import("./arcadeUtils-0b7a0753.js").then(i=>i.ax),["assets/arcadeUtils-0b7a0753.js","assets/geometry-70b2a4a5.js","assets/ensureType-d98e08e1.js","assets/string-9c5e03f7.js","assets/typedArrayUtil-d02f10a8.js","assets/Error-4ed679d7.js","assets/Extent-d5fff12d.js","assets/cast-6d78d3c7.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/preload-helper-101896b7.js","assets/datetime-7cb5ae9e.js","assets/number-bf398f16.js","assets/locale-30120714.js","assets/Field-bb784640.js","assets/enumeration-497ef064.js","assets/fieldType-9bddd3d4.js","assets/jsonUtils-5115c7e5.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/request-e4299080.js","assets/unitUtils-b69647a1.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/sizeVariableUtils-d4870b0d.js"])}function em(i){return"createQuery"in i&&"queryFeatures"in i}async function tm({graphic:i,view:e}){const{isAggregate:t,layer:s}=i;if(!t||!s||(e==null?void 0:e.type)!=="2d")return[];const n=await e.whenLayerView(s);if(!em(n))return[];const o=n.createQuery();o.aggregateIds=[i.getObjectId()];const{features:r}=await n.queryFeatures(o);return r}async function Jl({expressionInfo:i,arcadeUtils:e,interceptor:t,spatialReference:s,map:n,graphic:o,view:r}){if(!i||!i.expression)return null;const l=e.createSyntaxTree(i.expression),d=Wp.filter(f=>e.hasVariable(l,f)),[u]=await Promise.all([tm({graphic:o,view:r}),e.loadScriptDependencies(l,!0,d)]),h=e.getViewInfo({spatialReference:s}),p=e.createExecContext(o,h);p.interceptor=t,p.useAsync=!0,Xp({aggregatedFeatures:u,arcadeUtils:e,featureSetVars:d,context:p,viewInfo:h,map:n,graphic:o,interceptor:t});const g=e.createFunction(l,p);return e.executeAsyncFunction(g,p).catch(f=>Kp.error("arcade-execution-error",{error:f,graphic:o,expressionInfo:i}))}async function im({expressionInfos:i,spatialReference:e,graphic:t,interceptor:s,map:n,view:o}){if(!i||!i.length)return{};const r=await Ql(),l={};for(const h of i)l[`expression/${h.name}`]=Jl({expressionInfo:h,arcadeUtils:r,interceptor:s,spatialReference:e,map:n,graphic:t,view:o});const d=await Xt(l),u={};for(const h in d)u[h]=Yp(d[h].value);return u}const sm=1;let Fe=class extends wn(V){constructor(e){super(e),this._abortController=null,this.expressionInfo=null,this.graphic=null,this.contentElement=null,this.contentElementViewModel=null,this.interceptor=null,this.view=null,this._cancelQuery=()=>{const{_abortController:t}=this;t&&t.abort(),this._abortController=null},this._createVM=()=>{var n,o;const t=(n=this.contentElement)==null?void 0:n.type;(o=this.contentElementViewModel)==null||o.destroy();const s=t==="fields"?new Cn:t==="media"?new _i:t==="text"?new un:null;this._set("contentElementViewModel",s)},this._compile=async()=>{this._cancelQuery();const t=new AbortController;this._abortController=t,await this._compileExpression(),this._abortController===t&&(this._abortController=null)},this._compileThrottled=zi(this._compile,sm,this),this._compileExpression=async()=>{const{expressionInfo:t,graphic:s,interceptor:n,spatialReference:o,map:r,view:l,_abortController:d}=this;if(!(t&&s&&o&&r))return void this._set("contentElement",null);const u=await Ql();if(d!==this._abortController)return;const h=await Jl({arcadeUtils:u,expressionInfo:t,graphic:s,interceptor:n,map:r,spatialReference:o,view:l});if(!h||h.declaredClass!=="esri.arcade.Dictionary")return void this._set("contentElement",null);const p=await h.castAsJsonAsync(d.signal),g=p==null?void 0:p.type,f=g==="media"?eu.fromJSON(p):g==="text"?yl.fromJSON(p):g==="fields"?tu.fromJSON(p):null;this._set("contentElement",f)},this.handles.add([v(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,this.view],()=>this._compileThrottled(),U),v(()=>[this.contentElement],()=>this._createVM(),U)])}destroy(){var e;this._cancelQuery(),(e=this.contentElementViewModel)==null||e.destroy(),this._set("contentElementViewModel",null),this._set("contentElement",null)}get spatialReference(){var e;return((e=this.view)==null?void 0:e.spatialReference)??null}set spatialReference(e){this._override("spatialReference",e)}get state(){const{_abortController:e,contentElement:t,contentElementViewModel:s}=this;return e?"loading":t||s?"ready":"disabled"}get map(){var e;return((e=this.view)==null?void 0:e.map)??null}set map(e){this._override("map",e)}};a([c()],Fe.prototype,"_abortController",void 0),a([c({type:iu})],Fe.prototype,"expressionInfo",void 0),a([c({type:lt})],Fe.prototype,"graphic",void 0),a([c({readOnly:!0})],Fe.prototype,"contentElement",void 0),a([c({readOnly:!0})],Fe.prototype,"contentElementViewModel",void 0),a([c()],Fe.prototype,"interceptor",void 0),a([c()],Fe.prototype,"spatialReference",null),a([c({readOnly:!0})],Fe.prototype,"state",null),a([c()],Fe.prototype,"map",null),a([c()],Fe.prototype,"view",void 0),Fe=a([b("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],Fe);const tr=Fe,Rs={iconLoading:"esri-icon-loading-indicator esri-rotating",base:"esri-feature-expression",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};let qs=class extends pe{constructor(e,t){super(e,t),this.viewModel=new tr}initialize(){this.addHandles(v(()=>{var e;return(e=this.viewModel)==null?void 0:e.contentElementViewModel},()=>this._setupExpressionWidget(),U))}destroy(){this._destroyContentWidget()}renderLoading(){return m("div",{key:"loading-container",class:Rs.loadingSpinnerContainer},m("span",{class:this.classes(Rs.iconLoading,Rs.spinner)}))}render(){var t;const{state:e}=this.viewModel;return m("div",{class:Rs.base},e==="loading"?this.renderLoading():e==="disabled"?null:(t=this._contentWidget)==null?void 0:t.render())}_destroyContentWidget(){const{_contentWidget:e}=this;e&&(e.viewModel=null,e.destroy()),this._contentWidget=null}_setupExpressionWidget(){const{contentElementViewModel:e,contentElement:t}=this.viewModel,s=t==null?void 0:t.type;this._destroyContentWidget();const n=e?s==="fields"?new Kl({viewModel:e}):s==="media"?new Yl({viewModel:e}):s==="text"?new Gs({viewModel:e}):null:null;this._contentWidget=n,this.scheduleRender()}};a([c({type:tr})],qs.prototype,"viewModel",void 0),qs=a([b("esri.widgets.Feature.FeatureExpression")],qs);const nm=qs,jn=100;let W=class extends cl(Il(wn(V))){constructor(e){super(e),this._queryAbortController=null,this._queryPageAbortController=null,this._queryFeatureCountAbortController=null,this.featuresPerPage=10,this.description=null,this.graphic=null,this.layer=null,this.map=null,this.orderByFields=null,this.featureCount=0,this.relationshipId=null,this.showAllEnabled=!1,this.title=null,this._cancelQuery=()=>{const{_queryAbortController:t}=this;t&&t.abort(),this._queryAbortController=null},this._cancelQueryFeatureCount=()=>{const{_queryFeatureCountAbortController:t}=this;t&&t.abort(),this._queryFeatureCountAbortController=null},this._cancelQueryPage=()=>{const{_queryPageAbortController:t}=this;t&&t.abort(),this._queryPageAbortController=null},this._queryController=async()=>{this._cancelQuery();const t=new AbortController;this._queryAbortController=t,await ps(this._query()),this._queryAbortController===t&&(this._queryAbortController=null)},this._queryFeatureCountController=async()=>{this._cancelQueryFeatureCount();const t=new AbortController;this._queryFeatureCountAbortController=t,await ps(this._queryFeatureCount()),this._queryFeatureCountAbortController===t&&(this._queryFeatureCountAbortController=null)},this._queryPageController=async()=>{const t=new AbortController;this._queryPageAbortController=t,await ps(this._queryPage()),this._queryPageAbortController===t&&(this._queryPageAbortController=null)},this._queryThrottled=zi(this._queryController,jn,this),this._queryFeatureCountThrottled=zi(this._queryFeatureCountController,jn,this),this._queryPageThrottled=zi(this._queryPageController,jn,this),this._query=async()=>{const{_queryAbortController:t,relatedFeatures:s}=this;this._destroyRelatedFeatureViewModels(),this.featurePage=1,s.removeAll(),s.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:t==null?void 0:t.signal})))},this.handles.add([v(()=>[this.displayCount,this.graphic,this.layer,this.map,this.orderByFieldsFixedCasing,this.relationshipId,this.featuresPerPage,this.showAllEnabled],()=>this._queryThrottled(),U),v(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageThrottled()),v(()=>[this.layer,this.relationshipId,this.objectId],()=>this._queryFeatureCountThrottled())])}destroy(){this._destroyRelatedFeatureViewModels(),this.relatedFeatures.removeAll(),this._cancelQuery(),this._cancelQueryFeatureCount(),this._cancelQueryPage()}set featurePage(e){const{featuresPerPage:t,featureCount:s}=this,n=1,o=Math.ceil(s/t)||1;this._set("featurePage",Math.min(Math.max(e,n),o))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const{orderByFields:e,relatedLayer:t}=this;return e&&(t!=null&&t.loaded)?e.map(s=>{const n=s.clone(),o=bs(s.field,t);return n.field=o,n}):e}get itemDescriptionFieldName(){var e,t;return((t=(e=this.orderByFieldsFixedCasing)==null?void 0:e[0])==null?void 0:t.field)||null}set displayCount(e){this._set("displayCount",Math.min(Math.max(e,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){var e,t;return((t=(e=this.graphic)==null?void 0:e.attributes)==null?void 0:t[this.objectIdField])??null}get objectIdField(){var e;return((e=this.layer)==null?void 0:e.objectIdField)||null}get relatedFeatures(){return this._get("relatedFeatures")||new ee}get relatedLayer(){const{layer:e,map:t,relationship:s}=this;return e!=null&&e.loaded?Jh(t,e,s):null}get relationship(){var s;const{relationshipId:e,layer:t}=this;return typeof e=="number"?((s=t==null?void 0:t.relationships)==null?void 0:s.find(({id:n})=>n===e))??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new ee}get state(){const{_queryAbortController:e,_queryFeatureCountAbortController:t,_queryPageAbortController:s,graphic:n,relatedLayer:o}=this;return t?"loading":e||s?"querying":n&&o?"ready":"disabled"}_destroyRelatedFeatureViewModels(){var e;(e=this.relatedFeatureViewModels)==null||e.forEach(t=>!t.destroyed&&t.destroy()),this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){var h,p,g,f;const{layer:e,relatedLayer:t,relationshipId:s,objectId:n,_queryFeatureCountAbortController:o}=this;if(await(e==null?void 0:e.load()),!t||typeof n!="number"||!((p=(h=e==null?void 0:e.capabilities)==null?void 0:h.queryRelated)!=null&&p.supportsCount))return void this._set("featureCount",0);await t.load();const r=t.createQuery(),l=((f=(g=e.capabilities)==null?void 0:g.queryRelated)==null?void 0:f.supportsCacheHint)??!1,d=new co({cacheHint:l,relationshipId:s,returnGeometry:!1,objectIds:[n],where:r.where}),u=await e.queryRelatedFeaturesCount(d,{signal:o==null?void 0:o.signal});this._set("featureCount",u[n]||0)}_sliceFeatures(e){const{showAllEnabled:t,displayCount:s}=this;return t?e:s?e.slice(0,s):[]}async _queryPage(){const{relatedFeatures:e,featurePage:t,showAllEnabled:s,_queryPageAbortController:n}=this;!s||t<2||e.addMany(await this._queryRelatedFeatures({signal:n==null?void 0:n.signal}))}async _queryRelatedFeatures(e){var x,H,G,z,Z;const{orderByFieldsFixedCasing:t,showAllEnabled:s,featuresPerPage:n,displayCount:o,layer:r,relationshipId:l,featurePage:d,featureCount:u,relatedLayer:h}=this;await(r==null?void 0:r.load());const{relationship:p,objectId:g}=this;if(!p||typeof g!="number"||!((H=(x=r==null?void 0:r.capabilities)==null?void 0:x.queryRelated)!=null&&H.supportsPagination))return[];const f=s?((d-1)*n+u)%u:0,_=s?n:o;if(!h)return[];await h.load();const T=h.objectIdField,w=[...t==null?void 0:t.map(ne=>ne.field),T],E=t==null?void 0:t.map(ne=>`${ne.field} ${ne.order}`),P=((z=(G=r.capabilities)==null?void 0:G.queryRelated)==null?void 0:z.supportsCacheHint)||!1,$=h.createQuery(),O=new co({orderByFields:E,start:f,num:_,outFields:w,cacheHint:P,relationshipId:l,returnGeometry:!1,objectIds:[g],where:$.where}),R=((Z=(await r.queryRelatedFeatures(O,{signal:e==null?void 0:e.signal}))[g])==null?void 0:Z.features)||[];return R.forEach(ne=>ne.sourceLayer=h),R}};a([c()],W.prototype,"_queryAbortController",void 0),a([c()],W.prototype,"_queryPageAbortController",void 0),a([c()],W.prototype,"_queryFeatureCountAbortController",void 0),a([c({value:1})],W.prototype,"featurePage",null),a([c()],W.prototype,"featuresPerPage",void 0),a([c({readOnly:!0})],W.prototype,"orderByFieldsFixedCasing",null),a([c()],W.prototype,"description",void 0),a([c({readOnly:!0})],W.prototype,"itemDescriptionFieldName",null),a([c({value:3})],W.prototype,"displayCount",null),a([c({type:lt})],W.prototype,"graphic",void 0),a([c()],W.prototype,"layer",void 0),a([c()],W.prototype,"map",void 0),a([c({readOnly:!0})],W.prototype,"objectId",null),a([c({readOnly:!0})],W.prototype,"objectIdField",null),a([c()],W.prototype,"orderByFields",void 0),a([c({readOnly:!0})],W.prototype,"relatedFeatures",null),a([c({readOnly:!0})],W.prototype,"relatedLayer",null),a([c({readOnly:!0})],W.prototype,"relationship",null),a([c({readOnly:!0})],W.prototype,"featureCount",void 0),a([c({readOnly:!0})],W.prototype,"relatedFeatureViewModels",null),a([c()],W.prototype,"relationshipId",void 0),a([c()],W.prototype,"showAllEnabled",void 0),a([c({readOnly:!0})],W.prototype,"state",null),a([c()],W.prototype,"title",void 0),W=a([b("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],W);const ir=W,ht={base:"esri-feature-relationship",esriWidget:"esri-widget",listContainer:"esri-feature-relationship__list",listContainerQuerying:"esri-feature-relationship__list--querying",featureObserver:"esri-feature__feature-observer",stickySpinnerContainer:"esri-feature__sticky-loading-container",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner",iconLoading:"esri-icon-loading-indicator esri-rotating"},na={title:!0,description:!0};let Ce=class extends pe{constructor(e,t){super(e,t),this._featureElementInfo=null,this._relatedFeatureIntersectionObserver=new IntersectionObserver(([s])=>{s!=null&&s.isIntersecting&&this._increaseFeaturePage()},{root:window.document}),this.headingLevel=2,this.viewModel=new ir,this.messages=null,this.messagesCommon=null,this.visibleElements={...na},this._increaseFeaturePage=()=>{const{state:s,showAllEnabled:n,relatedFeatures:o,featuresPerPage:r,featurePage:l}=this.viewModel;s==="ready"&&n&&o.length>=r*l&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new In,this.addHandles([v(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),U),v(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),Ze(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return Promise.all([I(()=>import("./calcite-list-2964d3a9.js"),["assets/calcite-list-2964d3a9.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/interactive-52dcf836.js"]),I(()=>import("./calcite-list-item-ea0806a3.js"),["assets/calcite-list-item-ea0806a3.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/conditionalSlot-5e8f49e5.js","assets/observers-32bcc375.js","assets/interactive-52dcf836.js"]),I(()=>import("./calcite-icon-901434b0.js"),["assets/calcite-icon-901434b0.js","assets/icon-ba19bc6b.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/observers-32bcc375.js"]),I(()=>import("./calcite-notice-c4b4be7f.js"),["assets/calcite-notice-c4b4be7f.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/conditionalSlot-5e8f49e5.js","assets/observers-32bcc375.js","assets/icon-ba19bc6b.js"])])}destroy(){this._unobserveRelatedFeatureObserver(),this._featureElementInfo=Ee(this._featureElementInfo)}get displayShowAllButton(){const{showAllEnabled:e,featureCount:t,displayCount:s}=this.viewModel;return!e&&(t>s||s===0)}get displayListItems(){return this.displayShowAllButton||this.viewModel.relatedFeatureViewModels.length>0}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get featureCountDescription(){const{messages:e}=this,{featureCount:t}=this.viewModel;return ot(t===1?e==null?void 0:e.numberRecord:e==null?void 0:e.numberRecords,{number:t})}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}castVisibleElements(e){return{...na,...e}}renderStickyLoading(){return this.viewModel.state==="querying"?m("div",{key:"sticky-loader",class:ht.stickySpinnerContainer},this.renderLoadingIcon()):null}renderLoadingIcon(){return m("span",{class:this.classes(ht.iconLoading,ht.spinner)})}renderLoading(){return m("div",{key:"loading-container",class:ht.loadingSpinnerContainer},this.renderLoadingIcon())}renderShowAllIconNode(){return m("calcite-icon",{scale:"s",icon:"list",slot:"content-end"})}renderChevronIconNode(){const e=rt(this.container)?"chevron-left":"chevron-right";return m("calcite-icon",{scale:"s",icon:e,slot:"content-end"})}renderRelatedFeature(e){var o,r;const{itemDescriptionFieldName:t}=this.viewModel,s=e.title;e.description=t&&((o=e.formattedAttributes)==null?void 0:o.global[t]);const n=e.state==="loading";return m("calcite-list-item",{key:e.uid,label:n?`${(r=this.messagesCommon)==null?void 0:r.loading}`:s,description:n?"":e.description,onclick:()=>this.emit("select-record",{featureViewModel:e})},this.renderChevronIconNode())}renderShowAllListItem(){var e;return this.displayShowAllButton?m("calcite-list-item",{key:"show-all-item",label:(e=this.messages)==null?void 0:e.showAll,description:this.featureCountDescription,onclick:()=>this.emit("show-all-records")},this.renderShowAllIconNode()):null}renderNoRelatedFeaturesMessage(){var e;return m("calcite-notice",{key:"no-related-features-message",icon:"information",open:!0,color:"blue",scale:"s",width:"full"},m("div",{slot:"message"},(e=this.messages)==null?void 0:e.noRelatedFeatures))}renderFeatureObserver(){return m("div",{key:"feature-observer",class:ht.featureObserver,bind:this,afterCreate:this._relatedFeatureIntersectionObserverCreated})}renderList(){const{relatedFeatureViewModels:e}=this.viewModel;return m("calcite-list",null,e.toArray().map(t=>this.renderRelatedFeature(t)),this.renderShowAllListItem())}renderRelatedFeatures(){const{displayListItems:e}=this,{state:t}=this.viewModel;return m("div",{key:"list-container",class:this.classes(ht.listContainer,{[ht.listContainerQuerying]:t==="querying"})},e?this.renderList():t==="ready"?this.renderNoRelatedFeaturesMessage():null,this.renderStickyLoading(),this.renderFeatureObserver())}renderRelationshipNotFound(){var e;return m("calcite-notice",{key:"relationship-not-found",icon:"exclamation-mark-triangle",open:!0,color:"red",scale:"s",width:"full"},m("div",{slot:"message"},(e=this.messages)==null?void 0:e.relationshipNotFound))}render(){var t;const{state:e}=this.viewModel;return m("div",{class:this.classes(ht.base,ht.esriWidget)},(t=this._featureElementInfo)==null?void 0:t.render(),e==="loading"?this.renderLoading():e==="disabled"?this.renderRelationshipNotFound():this.renderRelatedFeatures())}_setupRelatedFeatureViewModels(){const{relatedFeatureViewModels:e}=this.viewModel,t="related-feature-viewmodels";this.removeHandles(t),e==null||e.forEach(s=>{this.addHandles(v(()=>[s.title,s.state],()=>this.scheduleRender(),U),t)}),this.scheduleRender()}_setupFeatureElementInfo(){const{headingLevel:e,visibleElements:t}=this,s=t.description&&this.description,n=t.title&&this.title;this._featureElementInfo.set({description:s,title:n,headingLevel:e})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const{state:e,showAllEnabled:t}=this.viewModel;await Vo(0),this._relatedFeatureIntersectionObserverNode&&e==="ready"&&t&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(e){this._relatedFeatureIntersectionObserverNode=e}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};a([c()],Ce.prototype,"_relatedFeatureIntersectionObserverNode",void 0),a([c({readOnly:!0})],Ce.prototype,"displayShowAllButton",null),a([c({readOnly:!0})],Ce.prototype,"displayListItems",null),a([c()],Ce.prototype,"description",null),a([c({readOnly:!0})],Ce.prototype,"featureCountDescription",null),a([c()],Ce.prototype,"headingLevel",void 0),a([c()],Ce.prototype,"title",null),a([c({type:ir})],Ce.prototype,"viewModel",void 0),a([c(),re("esri/widgets/Feature/t9n/Feature")],Ce.prototype,"messages",void 0),a([c(),re("esri/t9n/common")],Ce.prototype,"messagesCommon",void 0),a([c()],Ce.prototype,"visibleElements",void 0),a([be("visibleElements")],Ce.prototype,"castVisibleElements",null),Ce=a([b("esri.widgets.Feature.FeatureRelationship")],Ce);const oa=Ce;let om=class{constructor(e,t){this.preLayerQueryCallback=e,this.preRequestCallback=t,this.preLayerQueryCallback||(this.preLayerQueryCallback=s=>{}),this.preRequestCallback||(this.preLayerQueryCallback=s=>{})}};var ls;const rm=1,ra="content-view-models",aa="relationship-view-models",la={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};let Y=ls=class extends Il(V){constructor(i){super(i),this._handles=new at,this._error=null,this._featureAbortController=null,this._graphicChangedThrottled=zi(this._graphicChanged,rm,this),this._expressionAttributes=null,this._graphicExpressionAttributes=null,this.abilities={...la},this.content=null,this.contentViewModels=[],this.description=null,this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return e.type==="attachments"&&t.attachmentsContent||e.type==="custom"&&t.customContent||e.type==="fields"&&t.fieldsContent||e.type==="media"&&t.mediaContent||e.type==="text"&&t.textContent||e.type==="expression"&&t.expressionContent||e.type==="relationship"&&t.relationshipContent},this._handles.add(v(()=>[this.graphic,this._effectivePopupTemplate,this.abilities],()=>this._graphicChangedThrottled(),U))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return M(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return Gh(qr(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return zl(this.graphic)}castAbilities(i){return{...la,...i}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(i){this._set("graphic",i?i.clone():null)}get spatialReference(){var i;return((i=this.view)==null?void 0:i.spatialReference)??null}set spatialReference(i){this._override("spatialReference",i)}get map(){var i;return((i=this.view)==null?void 0:i.map)||null}set map(i){this._override("map",i)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(i,e){const t=this.contentViewModels[i];t instanceof _i&&t.setActiveMedia(e)}nextMedia(i){const e=this.contentViewModels[i];e instanceof _i&&e.next()}previousMedia(i){const e=this.contentViewModels[i];e instanceof _i&&e.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:i}=this;if(!i)return;const e=new AbortController;this._featureAbortController=e;try{await this._queryFeature({signal:e.signal})}catch(t){il(t)||(this._error=t,N.getLogger(this.declaredClass).error("error","The popupTemplate could not be displayed for this feature.",{error:t,graphic:i,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===e&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:i}=this;i&&i.abort(),this._featureAbortController=null}_compileContentElement(i,e){return i.type==="attachments"?this._compileAttachments(i,e):i.type==="custom"?this._compileCustom(i,e):i.type==="fields"?this._compileFields(i,e):i.type==="media"?this._compileMedia(i,e):i.type==="text"?this._compileText(i,e):i.type==="expression"?this._compileExpression(i,e):i.type==="relationship"?this._compileRelationship(i,e):void 0}_compileContent(i){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(i)?i.filter(this._isAllowedContentType).map((e,t)=>this._compileContentElement(e,t)):typeof i=="string"?this._compileText(new yl({text:i}),0).text:i}_destroyContentViewModels(){var i,e;(i=this._handles)==null||i.remove(aa),(e=this._handles)==null||e.remove(ra),this.contentViewModels.forEach(t=>t&&!t.destroyed&&t.destroy()),this._set("contentViewModels",[])}_matchesFeature(i,e){var n;const t=(n=i==null?void 0:i.graphic)==null?void 0:n.getObjectId(),s=e==null?void 0:e.getObjectId();return M(t)&&M(s)&&t===s}_setRelatedFeaturesViewModels({relatedFeatureViewModels:i,relatedFeatures:e,map:t}){e==null||e.filter(Boolean).forEach(s=>{i.find(n=>this._matchesFeature(n,s))||i.add(new ls({abilities:{relationshipContent:!1},map:t,graphic:s}))}),i.forEach(s=>{(e==null?void 0:e.find(o=>this._matchesFeature(s,o)))||i.remove(s)})}_setExpressionContentVM(i,e){const{formattedAttributes:t}=this,{contentElement:s,contentElementViewModel:n}=i,o=s==null?void 0:s.type;n&&o&&(o==="fields"&&(this._createFieldsFormattedAttributes({contentElement:s,contentElementIndex:e,formattedAttributes:t}),n.set(this._createFieldsVMParams(s,e))),o==="media"&&(this._createMediaFormattedAttributes({contentElement:s,contentElementIndex:e,formattedAttributes:t}),n.set(this._createMediaVMParams(s,e))),o==="text"&&n.set(this._createTextVMParams(s)))}_compileRelationship(i,e){const{displayCount:t,orderByFields:s,relationshipId:n,title:o,description:r}=i,{_sourceLayer:l,graphic:d,map:u}=this,h=new ir({displayCount:t,graphic:d,orderByFields:s,relationshipId:n,layer:l,map:u,...this._compileTitleAndDesc({title:o,description:r})});return this.contentViewModels[e]=h,this._handles.add(Ze(()=>h.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(h)),aa),i}_compileExpression(i,e){const{expressionInfo:t}=i,{graphic:s,map:n,spatialReference:o,view:r}=this,l=new tr({expressionInfo:t,graphic:s,interceptor:ls.interceptor,map:n,spatialReference:o,view:r});return this.contentViewModels[e]=l,this._handles.add(v(()=>l.contentElementViewModel,()=>this._setExpressionContentVM(l,e),U),ra),i}_compileAttachments(i,e){const{graphic:t}=this,{description:s,title:n}=i;return this.contentViewModels[e]=new Qo({graphic:t,...this._compileTitleAndDesc({title:n,description:s})}),i}_compileCustom(i,e){const{graphic:t}=this,{creator:s,destroyer:n}=i;return this.contentViewModels[e]=new un({graphic:t,creator:s,destroyer:n}),i}_compileTitleAndDesc({title:i,description:e}){const{_fieldInfoMap:t,_sourceLayer:s,graphic:n,formattedAttributes:o,_expressionAttributes:r}=this,{attributes:l}=n,d=o.global;return{title:fi({attributes:l,fieldInfoMap:t,globalAttributes:d,expressionAttributes:r,layer:s,text:i}),description:fi({attributes:l,fieldInfoMap:t,globalAttributes:d,expressionAttributes:r,layer:s,text:e})}}_createFieldsVMParams(i,e){var u;const{_effectivePopupTemplate:t,formattedAttributes:s}=this,n={...s.global,...s.content[e]},o=(u=(i==null?void 0:i.fieldInfos)||(t==null?void 0:t.fieldInfos))==null?void 0:u.filter(({fieldName:h})=>Wo(h)||Et(h)||n.hasOwnProperty(h)),r=t==null?void 0:t.expressionInfos,{description:l,title:d}=i;return{attributes:n,expressionInfos:r,fieldInfos:o,...this._compileTitleAndDesc({title:d,description:l})}}_compileFields(i,e){const t=i.clone(),s=new Cn(this._createFieldsVMParams(i,e));return this.contentViewModels[e]=s,t.fieldInfos=s.formattedFieldInfos.slice(0),t}_createMediaVMParams(i,e){const{abilities:t,graphic:s,_fieldInfoMap:n,formattedAttributes:o,_effectivePopupTemplate:r,relatedInfos:l,_sourceLayer:d,_expressionAttributes:u}=this,{attributes:h}=s,{description:p,mediaInfos:g,title:f}=i;return{abilities:{chartAnimation:t.chartAnimation},activeMediaInfoIndex:i.activeMediaInfoIndex||0,attributes:h,layer:d,fieldInfoMap:n,formattedAttributes:{...o.global,...o.content[e]},expressionAttributes:u,mediaInfos:g,popupTemplate:r,relatedInfos:l,...this._compileTitleAndDesc({title:f,description:p})}}_compileMedia(i,e){const t=i.clone(),s=new _i(this._createMediaVMParams(i,e));return t.mediaInfos=s.formattedMediaInfos.slice(0),this.contentViewModels[e]=s,t}_createTextVMParams(i){const{graphic:e,_fieldInfoMap:t,_sourceLayer:s,_expressionAttributes:n}=this;if(i&&i.text){const{attributes:o}=e,r=this.formattedAttributes.global;i.text=fi({attributes:o,fieldInfoMap:t,globalAttributes:r,expressionAttributes:n,layer:s,text:i.text})}return{graphic:e,creator:i.text}}_compileText(i,e){const t=i.clone();return this.contentViewModels[e]=new un(this._createTextVMParams(t)),t}_compileLastEditInfo(){const{_effectivePopupTemplate:i,_sourceLayer:e,graphic:t}=this;if(!i)return;const{lastEditInfoEnabled:s}=i,n=e==null?void 0:e.editFieldsInfo;return s&&n?Hh(n,t.attributes):void 0}_compileTitle(i){const{_fieldInfoMap:e,_sourceLayer:t,graphic:s,_expressionAttributes:n}=this,{attributes:o}=s,r=this.formattedAttributes.global;return fi({attributes:o,fieldInfoMap:e,globalAttributes:r,expressionAttributes:n,layer:t,text:i})}async _getTitle(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.title;return dn(t,{graphic:e})}async _getContent(){const{_effectivePopupTemplate:i,graphic:e}=this,t=i==null?void 0:i.content;return dn(t,{graphic:e})}async _queryFeature(i){const{_featureAbortController:e,_sourceLayer:t,graphic:s,_effectivePopupTemplate:n,spatialReference:o,map:r,view:l}=this;if(e!==this._featureAbortController||!s)return;await Wh({graphic:s,popupTemplate:n,layer:t,spatialReference:o},i);const{content:{value:d},title:{value:u}}=await Xt({content:this._getContent(),title:this._getTitle()}),{expressionAttributes:{value:h}}=await Xt({checkForRelatedFeatures:this._checkForRelatedFeatures(i),expressionAttributes:im({expressionInfos:n==null?void 0:n.expressionInfos,spatialReference:o,graphic:s,map:r,interceptor:ls.interceptor,view:l})});e===this._featureAbortController&&s&&(this._expressionAttributes=h,this._graphicExpressionAttributes={...s.attributes,...h},this._set("formattedAttributes",this._createFormattedAttributes(d)),this._set("title",this._compileTitle(u)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(d)||null))}_createMediaFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){const{_effectivePopupTemplate:s,graphic:n,relatedInfos:o,_sourceLayer:r,_fieldInfoMap:l,_graphicExpressionAttributes:d}=this;t.content[e]=Nn({fieldInfos:s==null?void 0:s.fieldInfos,graphic:n,attributes:{...d,...i.attributes},layer:r,fieldInfoMap:l,relatedInfos:o})}_createFieldsFormattedAttributes({contentElement:i,contentElementIndex:e,formattedAttributes:t}){if(i.fieldInfos){const{graphic:s,relatedInfos:n,_sourceLayer:o,_fieldInfoMap:r,_graphicExpressionAttributes:l}=this;t.content[e]=Nn({fieldInfos:i.fieldInfos,graphic:s,attributes:{...l,...i.attributes},layer:o,fieldInfoMap:r,relatedInfos:n})}}_createFormattedAttributes(i){const{_effectivePopupTemplate:e,graphic:t,relatedInfos:s,_sourceLayer:n,_fieldInfoMap:o,_graphicExpressionAttributes:r}=this,l=e==null?void 0:e.fieldInfos,d={global:Nn({fieldInfos:l,graphic:t,attributes:r,layer:n,fieldInfoMap:o,relatedInfos:s}),content:[]};return Array.isArray(i)&&i.forEach((u,h)=>{u.type==="fields"&&this._createFieldsFormattedAttributes({contentElement:u,contentElementIndex:h,formattedAttributes:d}),u.type==="media"&&this._createMediaFormattedAttributes({contentElement:u,contentElementIndex:h,formattedAttributes:d})}),d}_checkForRelatedFeatures(i){const{graphic:e,_effectivePopupTemplate:t}=this;return this._queryRelatedInfos(e,qr(t),i)}async _queryRelatedInfos(i,e,t){const{relatedInfos:s,_sourceLayer:n}=this;s.clear();const o=M(n.associatedLayer)?await n.associatedLayer.load(t):n;if(!o)return;const r=e.filter(u=>u&&Et(u.fieldName));if(!r||!r.length)return;e.forEach(u=>this._configureRelatedInfo(u,o));const l=await Dp({relatedInfos:s,layer:o},t);Object.keys(l).forEach(u=>{var g;const h=s.get(u.toString()),p=(g=l[u])==null?void 0:g.value;h&&p&&(h.layerInfo=p.data)});const d=await Vp({graphic:i,relatedInfos:s,layer:o},t);Object.keys(d).forEach(u=>{var h;Sp((h=d[u])==null?void 0:h.value,s.get(u.toString()))})}_configureRelatedInfo(i,e){const{relatedInfos:t}=this,s=Io(i.fieldName);if(!s)return;const{layerId:n,fieldName:o}=s;if(!n)return;const r=t.get(n.toString())||$p(n,e);r&&(Np({relatedInfo:r,fieldName:o,fieldInfo:i}),this.relatedInfos.set(n,r))}};Y.interceptor=new om(Yh,Qh),a([c()],Y.prototype,"_error",void 0),a([c()],Y.prototype,"_featureAbortController",void 0),a([c({readOnly:!0})],Y.prototype,"_effectivePopupTemplate",null),a([c({readOnly:!0})],Y.prototype,"_fieldInfoMap",null),a([c({readOnly:!0})],Y.prototype,"_sourceLayer",null),a([c()],Y.prototype,"abilities",void 0),a([be("abilities")],Y.prototype,"castAbilities",null),a([c({readOnly:!0})],Y.prototype,"content",void 0),a([c({readOnly:!0})],Y.prototype,"contentViewModels",void 0),a([c()],Y.prototype,"description",void 0),a([c({type:Boolean})],Y.prototype,"defaultPopupTemplateEnabled",void 0),a([c({readOnly:!0})],Y.prototype,"state",null),a([c({readOnly:!0})],Y.prototype,"formattedAttributes",void 0),a([c({type:lt,value:null})],Y.prototype,"graphic",null),a([c({readOnly:!0})],Y.prototype,"lastEditInfo",void 0),a([c({readOnly:!0})],Y.prototype,"relatedInfos",void 0),a([c()],Y.prototype,"spatialReference",null),a([c({readOnly:!0})],Y.prototype,"title",void 0),a([c()],Y.prototype,"map",null),a([c({readOnly:!0})],Y.prototype,"waitingForContent",null),a([c()],Y.prototype,"view",void 0),Y=ls=a([b("esri.widgets.FeatureViewModel")],Y);const sr=Y,J={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},Xl=i=>{let e=class extends i{constructor(){super(...arguments),this.renderNodeContent=t=>ul(t)&&!t.destroyed?m("div",{class:J.contentNode,key:t},t.render()):t instanceof HTMLElement?m("div",{class:J.contentNode,key:t,bind:t,afterCreate:this._attachToNode}):Ud(t)?m("div",{class:J.contentNode,key:t,bind:t.domNode,afterCreate:this._attachToNode}):null}_attachToNode(t){const s=this;t.appendChild(s)}};return e=a([b("esri.widgets.Feature.ContentMixin")],e),e};var Co;const ca={title:!0,content:!0,lastEditedInfo:!0},da="relationship-handles";let ge=Co=class extends Xl(pe){constructor(i,e){super(i,e),this._contentWidgets=[],this.flowItems=null,this.headingLevel=2,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.visibleElements={...ca},this.viewModel=new sr}initialize(){this.addHandles(v(()=>{var i;return(i=this.viewModel)==null?void 0:i.contentViewModels},()=>this._setupContentWidgets(),U))}loadDependencies(){return I(()=>import("./calcite-notice-c4b4be7f.js"),["assets/calcite-notice-c4b4be7f.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/conditionalSlot-5e8f49e5.js","assets/observers-32bcc375.js","assets/icon-ba19bc6b.js"])}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(i){this.viewModel.graphic=i}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(i){this.viewModel.defaultPopupTemplateEnabled=i}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(i){this.viewModel.spatialReference=i}get title(){return this.viewModel.title}castVisibleElements(i){return{...ca,...i}}get map(){return this.viewModel.map}set map(i){this.viewModel.map=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}render(){const{state:i}=this.viewModel,e=m("div",{class:J.container,key:"container"},this.renderTitle(),i==="error"?this.renderError():i==="loading"?this.renderLoading():this.renderContentContainer());return m("div",{class:this.classes(J.base,J.esriWidget)},e)}setActiveMedia(i,e){return this.viewModel.setActiveMedia(i,e)}nextMedia(i){return this.viewModel.nextMedia(i)}previousMedia(i){return this.viewModel.previousMedia(i)}renderError(){const{messagesCommon:i,messages:e,visibleElements:t}=this;return m("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},t.title?m("div",{key:"error-title",slot:"title"},i.errorMessage):null,m("div",{key:"error-message",slot:"message"},e.loadingError))}renderLoading(){return m("div",{key:"loading-container",class:J.loadingSpinnerContainer},m("span",{class:this.classes(J.iconLoading,J.spinner)}))}renderContentContainer(){const{visibleElements:i}=this;return i.content?m("div",{class:J.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:i,title:e}=this;return i.title?m(Jo,{level:this.headingLevel,class:J.title,innerHTML:e}):null}renderContent(){const i=this.viewModel.content,e="content";if(!i)return null;if(Array.isArray(i))return i.length?m("div",{class:J.contentNode,key:`${e}-content-elements`},i.map(this.renderContentElement,this)):null;if(typeof i=="string"){const t=this._contentWidgets[0];return!t||t.destroyed?null:m("div",{class:J.contentNode,key:`${e}-content`},t.render())}return this.renderNodeContent(i)}renderContentElement(i,e){const{visibleElements:t}=this;if(typeof t.content!="boolean"&&!t.content[i.type])return null;switch(i.type){case"attachments":return this.renderAttachments(e);case"custom":return this.renderCustom(i,e);case"fields":return this.renderFields(e);case"media":return this.renderMedia(e);case"text":return this.renderText(i,e);case"expression":return this.renderExpression(e);case"relationship":return this.renderRelationship(e);default:return null}}renderAttachments(i){const e=this._contentWidgets[i];if(!e||e.destroyed)return null;const{state:t,attachmentInfos:s}=e.viewModel;return t==="loading"||s.length>0?m("div",{key:this._buildKey("attachments-element",i),class:this.classes(J.contentElement)},e.render()):null}renderRelationship(i){const e=this._contentWidgets[i];return e&&!e.destroyed&&this.flowItems?m("div",{key:this._buildKey("relationship-element",i),class:J.contentElement},e.render()):null}renderExpression(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("expression-element",i),class:J.contentElement},e.render())}renderCustom(i,e){const{creator:t}=i,s=this._contentWidgets[e];return!s||s.destroyed?null:t?m("div",{key:this._buildKey("custom-element",e),class:J.contentElement},s.render()):null}renderFields(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("fields-element",i),class:J.contentElement},e.render())}renderMedia(i){const e=this._contentWidgets[i];return!e||e.destroyed?null:m("div",{key:this._buildKey("media-element",i),class:J.contentElement},e.render())}renderLastEditInfo(){const{visibleElements:i,messages:e}=this,{lastEditInfo:t}=this.viewModel;if(!t||!i.lastEditedInfo)return null;const{date:s,user:n}=t,o=t.type==="edit"?n?e.lastEditedByUser:e.lastEdited:n?e.lastCreatedByUser:e.lastCreated,r=ot(o,{date:s,user:n});return m("div",{key:"edit-info-element",class:this.classes(J.lastEditedInfo,J.contentElement)},r)}renderText(i,e){const t=i.text,s=this._contentWidgets[e];return!s||s.destroyed?null:t?m("div",{key:this._buildKey("text-element",e),class:this.classes(J.contentElement,J.text)},s.render()):null}_buildKey(i,...e){return`${i}__${this.get("viewModel.graphic.uid")||"0"}-${e.join("-")}`}_destroyContentWidget(i){i&&(i.viewModel=null,!i.destroyed&&i.destroy())}_destroyContentWidgets(){this.removeHandles(da),this._contentWidgets.forEach(i=>this._destroyContentWidget(i)),this._contentWidgets=[]}_addFeatureRelationshipHandles(i){const{flowItems:e,visibleElements:t}=this;this.addHandles([Ze(()=>i,"select-record",({featureViewModel:s})=>{e&&(s.abilities={relationshipContent:!0},e.push(new Co({flowItems:e,viewModel:s,visibleElements:t})))}),Ze(()=>i,"show-all-records",()=>{if(!e)return;const{viewModel:s}=i;s.showAllEnabled=!0;const n=new oa({visibleElements:{title:!1,description:!1},viewModel:s});this._addFeatureRelationshipHandles(n),e.push(n)})],da)}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:i,visibleElements:e}=this,t=this.get("viewModel.content"),{contentViewModels:s}=this.viewModel;if(Array.isArray(t))t.forEach((n,o)=>{if(n.type==="attachments"&&(this._contentWidgets[o]=new np({displayType:n.displayType,headingLevel:e.title?i+1:i,viewModel:s[o]})),n.type==="fields"&&(this._contentWidgets[o]=new Kl({viewModel:s[o]})),n.type==="media"&&(this._contentWidgets[o]=new Yl({viewModel:s[o]})),n.type==="text"&&(this._contentWidgets[o]=new Gs({viewModel:s[o]})),n.type==="custom"&&(this._contentWidgets[o]=new Gs({viewModel:s[o]})),n.type==="expression"&&(this._contentWidgets[o]=new nm({viewModel:s[o]})),n.type==="relationship"){const r=new oa({viewModel:s[o]});this._addFeatureRelationshipHandles(r),this._contentWidgets[o]=r}},this);else{const n=s[0];n&&!n.destroyed&&(this._contentWidgets[0]=new Gs({viewModel:n}))}this.scheduleRender()}};a([c()],ge.prototype,"graphic",null),a([c()],ge.prototype,"defaultPopupTemplateEnabled",null),a([c()],ge.prototype,"flowItems",void 0),a([c()],ge.prototype,"headingLevel",void 0),a([c()],ge.prototype,"label",null),a([c(),re("esri/widgets/Feature/t9n/Feature")],ge.prototype,"messages",void 0),a([c(),re("esri/t9n/common")],ge.prototype,"messagesCommon",void 0),a([c(),re("esri/widgets/support/t9n/uriUtils")],ge.prototype,"messagesURIUtils",void 0),a([c()],ge.prototype,"spatialReference",null),a([c({readOnly:!0})],ge.prototype,"title",null),a([c()],ge.prototype,"visibleElements",void 0),a([be("visibleElements")],ge.prototype,"castVisibleElements",null),a([c()],ge.prototype,"map",null),a([c()],ge.prototype,"view",null),a([c({type:sr})],ge.prototype,"viewModel",void 0),ge=Co=a([b("esri.widgets.Feature")],ge);const am=ge;var ec;const js=Symbol("anchorHandles");let ri=class extends qi.EventedAccessor{constructor(e){super(e),this[ec]=new at,this.location=null,this.screenLocationEnabled=!1,this.view=null,this[js].add([At(()=>ss(this.screenLocationEnabled?this.view:null,t=>[t.size,t.type==="3d"?t.camera:t.viewpoint]),()=>this.notifyChange("screenLocation")),v(()=>this.screenLocation,(t,s)=>{M(t)&&M(s)&&this.emit("view-change")})])}destroy(){this.view=null,this[js]=Ee(this[js])}get screenLocation(){const{location:e,view:t,screenLocationEnabled:s}=this;return s&&M(e)&&M(t)&&t.ready?t.toScreen(e):null}};ec=js,a([c()],ri.prototype,"location",void 0),a([c()],ri.prototype,"screenLocation",null),a([c()],ri.prototype,"screenLocationEnabled",void 0),a([c()],ri.prototype,"view",void 0),ri=a([b("esri.widgets.support.AnchorElementViewModel")],ri);const tc=ri,lm="esri.widgets.CompassViewModel";let Ws=class extends tc{constructor(e){super(e),this.visible=!1}};a([c()],Ws.prototype,"visible",void 0),Ws=a([b(lm)],Ws);const ic=Ws,Wn={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let ai=class extends pe{constructor(e,t){super(e,t),this._animationDelay=500,this._animationPromise=null,this.viewModel=new ic}initialize(){this.addHandles(v(()=>this.visible,e=>this._visibleChange(e)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}show(e){const{location:t,promise:s}=e;t&&(this.viewModel.location=t),this.visible=!0;const n=()=>this.hide();s&&s.catch(()=>{}).then(n)}hide(){this.visible=!1}render(){const{visible:e}=this,{screenLocation:t}=this.viewModel,s=!!t,n=e&&s,o=!e&&s,r={[Wn.spinnerStart]:n,[Wn.spinnerFinish]:o},l=this._getPositionStyles();return m("div",{class:this.classes(Wn.base,r),styles:l})}_visibleChange(e){if(e)return void(this.viewModel.screenLocationEnabled=!0);const t=Vo(this._animationDelay);this._animationPromise=t,t.catch(()=>{}).then(()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}_getPositionStyles(){const{screenLocation:e,view:t}=this.viewModel;if(F(t)||F(e))return{};const{padding:s}=t;return{left:e.x-s.left+"px",top:e.y-s.top+"px"}}};a([c()],ai.prototype,"location",null),a([c()],ai.prototype,"view",null),a([c({type:ic})],ai.prototype,"viewModel",void 0),a([c()],ai.prototype,"visible",null),ai=a([b("esri.widgets.Spinner")],ai);const cm=ai,dm="OBJECTID";var ua;(function(i){i[i.size=22]="size",i[i.lineWidth=50]="lineWidth",i[i.maxSize=120]="maxSize",i[i.maxOutlineSize=80]="maxOutlineSize",i[i.tallSymbolWidth=20]="tallSymbolWidth"})(ua||(ua={}));const ha=Se("android");Se("chrome")||ha&&ha>=4;lo();function sc(i){return i&&"opacity"in i?i.opacity*sc(i.parent):1}async function um(i,e){if(!i)return;const t=i.sourceLayer,s=(M(e)&&e.useSourceLayer?t:i.layer)??t,n=sc(s);if(M(i.symbol)&&(!M(e)||e.ignoreGraphicSymbol!==!0)){const w=i.symbol.type==="web-style"?await i.symbol.fetchSymbol({...e,cache:M(e)?e.webStyleCache:null}):i.symbol.clone();return Sn(w,null,n),w}const o=(M(e)?e.renderer:null)??(s&&"renderer"in s?s.renderer:null);let r=o&&"getSymbolAsync"in o?await o.getSymbolAsync(i,e):null;if(!r)return;if(r=r.type==="web-style"?await r.fetchSymbol({...e,cache:M(e)?e.webStyleCache:null}):r.clone(),!(o&&"visualVariables"in o&&o.visualVariables&&o.visualVariables.length))return Sn(r,null,n),r;if("arcadeRequiredForVisualVariables"in o&&o.arcadeRequiredForVisualVariables&&(F(e)||F(e.arcade))){const w={...Ve(e)};w.arcade=await wl(),e=w}const l=await I(()=>import("./UniqueValueRenderer-8e382829.js").then(w=>w.v),["assets/UniqueValueRenderer-8e382829.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/enumeration-497ef064.js","assets/jsonMap-5afaf2ff.js","assets/Extent-d5fff12d.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/geometry-70b2a4a5.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/locale-30120714.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/Clonable-58355d3c.js","assets/LegendOptions-e31ff575.js","assets/reactiveUtils-b0e56010.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-34c50417.js","assets/PopupTemplate-29fe62b5.js","assets/number-c7f1bfee.js","assets/Identifiable-57df9761.js","assets/jsonUtils-5115c7e5.js","assets/compilerUtils-eefea0ec.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js"]),d=[],u=[],h=[],p=[];for(const w of o.visualVariables)switch(w.type){case"color":d.push(w);break;case"opacity":u.push(w);break;case"rotation":p.push(w);break;case"size":w.target||h.push(w)}const g=!!d.length&&d[d.length-1],f=g?l.getColor(g,i,e):null,_=!!u.length&&u[u.length-1];let T=_?l.getOpacity(_,i,e):null;if(n!=null&&(T=T!=null?T*n:n),Sn(r,f,T),h.length){const w=l.getAllSizes(h,i,e);await ru(r,w)}for(const w of p)au(r,l.getRotationAngle(w,i,e),w.axis);return r}let hm=class{constructor(e,t){this._owner=t,this._properties={},this._afterDispatchHandle=null;for(const s in e){const n=e[s],o=new sd(n,void 0,void 0,2,2);this._properties[s]={pool:o,acquired:[]}}this._afterDispatchHandle=nd(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const t=this._properties[e];for(const s of t.acquired)pr(s)||t.pool.release(s);t.pool.destroy(),t.pool=null,t.acquired=null}this._properties=null,this._owner=null}get(e){const t=this._owner._get(e),s=this._properties[e];let n=s.pool.acquire();for(s.acquired.push(n);n===t;)s.acquired.push(n),n=s.pool.acquire();return n}_release(){for(const e in this._properties){const t=this._properties[e];let s=0;for(const n of t.acquired)pr(n)?t.acquired[s++]=n:t.pool.release(n);t.acquired.length=s}}};const pm=Se("mac")?"Meta":"Ctrl",Tn={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let i=48;i<58;i++)Tn[i]=String.fromCharCode(i);for(let i=1;i<25;i++)Tn[111+i]=`F${i}`;for(let i=65;i<91;i++)Tn[i]=[String.fromCharCode(i+32),String.fromCharCode(i)];function mm(i){if(i.key!==void 0)return pi(i);const e=Tn[i.keyCode];return Array.isArray(e)?i.shiftKey?e[1]:e[0]:e}function gm(i){switch(i){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}let fm=class{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const t=e.modifiers;for(const s of this.keyModifiers)if(!t.has(s))return!1;return!0}};const pa=N.getLogger("esri.views.input.InputHandler");let me=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const s of t)this._incomingEventMatches.push(s.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager?pa.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback(t=>this._handleEvent(t)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,t,s){let n;typeof t=="function"?(s=t,n=[]):n=t||[];const o=typeof e=="string"?new fm(e,n):e,r=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},l=h=>{const p=this._incoming[h.match.eventType];if(p){const g=p.indexOf(h);p.splice(g,1),r(),this._manager&&this._manager.updateDependencies()}},d=new _m(o,s,{onPause:l,onRemove:l,onResume:h=>{const p=this._incoming[h.match.eventType];p&&!p.includes(h)&&(p.push(h),r(),this._manager&&this._manager.updateDependencies())}});let u=this._incoming[o.eventType];return u||(u=[],this._incoming[o.eventType]=u),u.push(d),r(),this._manager&&this._manager.updateDependencies(),d}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new ym(e,{onEmit:(s,n,o,r)=>{var l;(l=this._manager)==null||l.emit(s.eventType,n,o,r)},onRemove:s=>{var n;delete this._outgoing[s.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!0)}stopCapturingPointer(e){var t;(t=this._manager)==null||t.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):pa.error("This InputHandler is not registered with an InputManager")}_handleEvent(e){var s;const t=this._incoming[e.type];if(t){for(const n of t)if(n.match.matches(e)&&((s=n.callback)==null||s.call(n,e),e.shouldStopPropagation()))break}}},_m=class{constructor(e,t,s){this.match=e,this._callback=t,this._handler=s}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},ym=class{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t}emit(e,t,s){this._removed||this._handler.onEmit(this,e,t,s)}remove(){this._removed=!0,this._handler.onRemove(this)}},vm=class extends me{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",t=>{this._update(t.data)})}_update(e){const t=e.native.pointerType==="touch"?"touch":"mouse",{x:s,y:n}=e;t===this._value&&this._x===s&&this._y===n||(this._value=t,this._x=s,this._y=n,this._onChange(t,s,n))}},wm=class extends me{constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=new Cu(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}get multiTouchActive(){return this._multiTouchActive.get()}_update(){this._multiTouchActive.set(this._activeTouchPointerIds.size>1)}},et=class extends V{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=pm,this._latestPointerType="mouse",this._propertiesPool=new hm({latestPointerLocation:Mm},this),this.latestPointerLocation=null,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}installHandlers(e,t,s=Yt.INTERNAL){if(this._nameToGroup[e])return void N.getLogger(this.declaredClass).error("There is already an InputHandler group registered under the name `"+e+"`");if(t.length===0)return void N.getLogger(this.declaredClass).error("Can't register a group of zero handlers");const n={name:e,handlers:t.map(o=>({handler:o,active:!0,removed:!1,priorityIndex:0,groupPriority:s,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=n;for(let o=n.handlers.length-1;o>=0;o--){const r=n.handlers[o];this._handlers.push(r),r.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(l,d,u,h,p)=>{this._emitInputEvent(r.priorityIndex+1,l,d,u,p,h)},setPointerCapture:(l,d)=>{this._setPointerCapture(n,r,l,d)},setEventCallback:l=>{r.eventCallback=l},setUninstallCallback:l=>{r.uninstallCallback=l},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach(s=>{var n;s.removed=!0,(n=s.uninstallCallback)==null||n.call(s)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):N.getLogger(this.declaredClass).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let s=this._handlers.length-1;s>=0;s--){const n=this._handlers[s];n.priorityIndex=s,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let s=this._handlersPriority.length-1;s>=0;s--){const n=this._handlersPriority[s];n.priorityIndex=s;let o=n.handler.hasSideEffects;if(!o){for(const r of n.handler.outgoingEventTypes)if(e.has(r)){o=!0;break}}if(o)for(const r of n.handler.incomingEventMatches){e.add(r.eventType);for(const l of r.keyModifiers)gm(l)||t.add(l)}n.active=o}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,t,s){this._latestPointerType=e;const n=this._get("latestPointerLocation");if(F(n)||n.x!==t||n.y!==s){const o=this._propertiesPool.get("latestPointerLocation");o.x=t,o.y=s,this._set("latestPointerLocation",o)}}_onEventReceived(e,t){if(e==="pointer-capture-lost"){const o=t;this._pointerCaptures.delete(o.native.pointerId)}this._updateKeyModifiers(e,t);const s=this.test.timestamp!=null?this.test.timestamp:t.native?t.native.timestamp:void 0,n=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,s,n)}_updateKeyModifiers(e,t){if(!t)return;let s=!1;const n=()=>{if(!s){const l=new Set;this._activeKeyModifiers.forEach(d=>{l.add(d)}),this._activeKeyModifiers=l,s=!0}},o=(l,d)=>{d&&!this._activeKeyModifiers.has(l)?(n(),this._activeKeyModifiers.add(l)):!d&&this._activeKeyModifiers.has(l)&&(n(),this._activeKeyModifiers.delete(l))};if(e==="key-down"||e==="key-up"){const l=t.key;this._keyModifiers.has(l)&&o(l,e==="key-down")}const r=t.native;o("Alt",!(!r||!r.altKey)),o("Ctrl",!(!r||!r.ctrlKey)),o("Shift",!(!r||!r.shiftKey)),o("Meta",!(!r||!r.metaKey)),o("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new vm((e,t,s)=>this._setLatestPointer(e,t,s)),this._multiTouchHandler=new wm,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Yt.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Yt.INTERNAL)}_setPointerCapture(e,t,s,n){const o=e.name+"-"+t.priorityIndex,r=this._pointerCaptures.get(s.pointerId)||new Set;this._pointerCaptures.set(s.pointerId,r),n?(r.add(o),r.size===1&&this.eventSource&&this.eventSource.setPointerCapture(s,!0)):r.has(o)&&(r.delete(o),r.size===0&&(this._pointerCaptures.delete(s.pointerId),this.eventSource&&this.eventSource.setPointerCapture(s,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,t,s,n){this._emitInputEvent(0,e,t,s,n)}_emitInputEvent(e,t,s,n,o,r){const l=n!==void 0?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),d=o!==void 0&&o,u={event:new bm(t,s,l,r||this._activeKeyModifiers,d),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(u):this._doNewPropagation(u)}_doNewPropagation(e){this._currentPropagation={events:new Tr,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var t,s;const e=Id(this._currentPropagation);for(;e.events.length>0;){const{event:n,priorityIndex:o}=e.events.pop(),r=n.data&&n.data.eventId;if(!(r!=null&&this._stoppedPropagationEventIds.has(r)))for(e.currentHandler=this._handlersPriority[o];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!n.shouldStopPropagation()&&((s=(t=e.currentHandler).eventCallback)==null||s.call(t,n)),n.shouldStopPropagation()){r!=null&&this._stoppedPropagationEventIds.add(r);break}if(n.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:n,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}_pausePropagation(e){const t=new Tr;t.push(e);const s=this._currentPropagation;if(s){for(;s.events.length;)t.push(s.events.pop());s.events=t,s.currentHandler=null}}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const s of e.handler.incomingEventMatches)for(const n of t.handler.incomingEventMatches){if(s.eventType!==n.eventType)continue;const o=s.keyModifiers.filter(r=>n.keyModifiers.includes(r));if(o.length===s.keyModifiers.length!=(o.length===n.keyModifiers.length))return s.keyModifiers.length>n.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const s of e){let n=0;for(;n<t.length&&this._compareHandlerPriority(s,t[n])>=0;)n++;t.splice(n,0,s)}return t}get debug(){const e=t=>{const s=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=s};return{injectEvent:(t,s)=>{e(()=>{this._onEventReceived(t,s)})},disablePointerCapture:e}}};a([c({readOnly:!0})],et.prototype,"hasPendingInputs",null),a([c({constructOnly:!0})],et.prototype,"eventSource",void 0),a([c({constructOnly:!0})],et.prototype,"recognizers",void 0),a([c()],et.prototype,"_latestPointerType",void 0),a([c()],et.prototype,"latestPointerType",null),a([c()],et.prototype,"multiTouchActive",null),a([c({readOnly:!0})],et.prototype,"latestPointerLocation",void 0),et=a([b("esri.views.input.InputManager")],et);let bm=class{constructor(e,t,s,n,o){this.type=e,this.data=t,this.timestamp=s,this.modifiers=n,this.cancelable=o,this._propagationState=Zt.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=Zt.STOPPED}shouldStopPropagation(){return(this._propagationState&Zt.STOPPED)!=0}async(e){this._propagationState|=Zt.PAUSED;const t=(s,n)=>{this._propagationState&=~Zt.PAUSED;const o=this._resumeCallback;if(this._resumeCallback=null,o&&o(),n)throw s;return s};return(typeof e=="function"?e():e).then(s=>t(s,!1),s=>t(s,!0))}shouldPausePropagation(e){return!!(this._propagationState&Zt.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var Zt;(function(i){i[i.NONE=0]="NONE",i[i.STOPPED=1]="STOPPED",i[i.PAUSED=2]="PAUSED"})(Zt||(Zt={}));const Yt={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let Mm=class{};function ma(i){return i&&typeof i.highlight=="function"}const En={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},yi=new Ts({id:"zoom-to-feature",title:"{messages.zoom}",className:En.iconZoom}),To=new Ts({id:"remove-selected-feature",title:"{messages.remove}",className:En.iconTrash}),Di=new Ts({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:En.iconZoom}),Vi=new Ts({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:En.iconBrowseClusteredFeatures}),Im="esri.widgets.Popup.PopupViewModel",pn=N.getLogger(Im),Cm=i=>{const{event:e,view:t}=i,{action:s}=e,n=t&&t.popup;if(!s)return Promise.reject(new k("trigger-action:missing-arguments","Event has no action"));if(!n)return Promise.reject(new k("trigger-action:missing-arguments","view.popup is missing"));const{disabled:o,id:r}=s;if(!r)return Promise.reject(new k("trigger-action:invalid-action","action.id is missing"));if(o)return Promise.reject(new k("trigger-action:invalid-action","Action is disabled"));if(r===yi.id)return Em(n.viewModel).catch(dd);if(r===Di.id)return xm(n.viewModel);if(r===Vi.id)return n.featureMenuOpen=!n.featureMenuOpen,n.viewModel.browseClusterEnabled=!n.viewModel.browseClusterEnabled,Promise.resolve();if(n.viewModel.browseClusterEnabled=!1,r===To.id){n.close();const{selectedFeature:l}=n;if(!l)return Promise.reject(new k(`trigger-action:${To.id}`,"selectedFeature is required",{selectedFeature:l}));const{sourceLayer:d}=l;return d?d.remove(l):t.graphics.remove(l),Promise.resolve()}return Promise.resolve()};function nc(i){const{selectedFeature:e,location:t,view:s}=i;return s?s.type==="3d"?e||t:i.get("selectedFeature.geometry")||t:null}function mi(i){var e,t;return(i==null?void 0:i.isAggregate)&&((t=(e=i==null?void 0:i.sourceLayer)==null?void 0:e.featureReduction)==null?void 0:t.type)==="cluster"}async function Tm(i,e){if((e==null?void 0:e.type)!=="3d"||!i||i.declaredClass!=="esri.Graphic")return!0;const t=e.getViewForGraphic(i);if(t&&"whenGraphicBounds"in t){let s;try{s=await t.whenGraphicBounds(i,{useViewElevation:!0})}catch{}return!s||!s.boundingBox||s.boundingBox[0]===s.boundingBox[3]&&s.boundingBox[1]===s.boundingBox[4]&&s.boundingBox[2]===s.boundingBox[5]}return!0}async function Em(i){const{location:e,selectedFeature:t,view:s,zoomFactor:n}=i,o=nc(i);if(!o){const u=new k("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:o,view:s});throw pn.error(u),u}const r=s.scale/n,l=i.get("selectedFeature.geometry")||e,d=l&&l.type==="point"&&await Tm(t,s);yi.active=!0,yi.disabled=!0;try{await i.zoomTo({target:{target:o,scale:d?r:void 0}})}catch{const h=new k("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});pn.error(h)}finally{yi.active=!1,yi.disabled=!1,i.zoomToLocation=null,d&&(i.location=l)}}async function xm(i){const{selectedFeature:e,view:t}=i;if((t==null?void 0:t.type)!=="2d"){const l=new k("zoomToCluster:invalid-view","View must be 2d MapView.",{view:t});throw pn.error(l),l}if(!mi(e)){const l=new k("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw pn.error(l),l}const s=e.sourceLayer,n=await t.whenLayerView(s),o=n.createQuery();o.aggregateIds=[e.getObjectId()],Di.active=!0,Di.disabled=!0;const{extent:r}=await n.queryExtent(o);await i.zoomTo({target:r}),Di.active=!1,Di.disabled=!1}async function km(i){const{selectedFeature:e,view:t}=i,s=e.sourceLayer,n=await t.whenLayerView(s),o=n.createQuery();o.aggregateIds=[e.getObjectId()];const{extent:r}=await n.queryExtent(o);i.selectedClusterBoundaryFeature.geometry=r,t.graphics.add(i.selectedClusterBoundaryFeature)}async function Am(i){const{selectedFeature:e,view:t}=i,s=e.sourceLayer,n=await t.whenLayerView(s),o=n.createQuery();o.aggregateIds=[e.getObjectId()],Vi.active=!0,Vi.disabled=!0;const{features:r}=await n.queryFeatures(o);Vi.active=!1,Vi.disabled=!1,t.popup.open({features:[e].concat(r),featureMenuOpen:!0})}function Pm(i){const e=i.features.filter(t=>mi(t));e.length&&(i.features=e)}const xn=i=>{let e=class extends i{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:s}=this;return this.goToOverride?this.goToOverride(s,t):s.goTo(t.target,t.options)}};return a([c()],e.prototype,"goToOverride",void 0),a([c()],e.prototype,"view",void 0),e=a([b("esri.widgets.support.GoTo")],e),e},fs=ee.ofType({key:"type",defaultKeyValue:"button",base:su,typeMap:{button:Ts,toggle:nu}}),$m=()=>[yi.clone()],Sm=()=>[Di.clone(),Vi.clone()];let D=class extends xn(tc){constructor(e){super(e),this._handles=new at,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new fs,this.activeFeature=null,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new lt({symbol:new lu({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some(e=>e.waitingForContent)}initialize(){this._handles.add([v(()=>[this.autoOpenEnabled,this.view],()=>this._autoOpenEnabledChange()),this.on("view-change",()=>this._autoClose()),v(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),v(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),v(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.animation)==null?void 0:t.state},e=>this._animationStateChange(e)),v(()=>this.location,e=>this._locationChange(e)),v(()=>this.selectedFeature,e=>this._selectedFeatureChange(e)),v(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),v(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),v(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",e=>Cm({event:e,view:this.view})),At(()=>!this.waitingForResult,()=>this._waitingForResultChange(),ys),v(()=>{var e,t;return[this.features,(e=this.view)==null?void 0:e.map,(t=this.view)==null?void 0:t.spatialReference]},()=>this._updateFeatureVMs()),v(()=>{var e;return(e=this.view)==null?void 0:e.scale},()=>this._viewScaleChange()),At(()=>!this.visible,()=>this.browseClusterEnabled=!1),v(()=>this.browseClusterEnabled,e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new fs;e.removeAll();const{actions:t,defaultActions:s,defaultPopupTemplateEnabled:n,includeDefaultActions:o,selectedFeature:r}=this,l=o?s.concat(t):t,d=r&&(typeof r.getEffectivePopupTemplate=="function"&&r.getEffectivePopupTemplate(n)||r.popupTemplate),u=d&&d.actions,h=d&&d.overwriteActions?u:u?u.concat(l):l;return h&&h.filter(Boolean).forEach(p=>e.add(p)),e}get defaultActions(){const e=this._get("defaultActions")||new fs;return e.removeAll(),e.addMany(mi(this.selectedFeature)?Sm():$m()),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:s,promiseCount:n,selectedFeatureIndex:o}=this,r=n&&t.length;r&&s&&o===-1?this.selectedFeatureIndex=0:r&&o!==-1||(this.selectedFeatureIndex=t.length?0:-1)}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=No(e)),this._set("location",e)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||this.featureCount!==0)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach(t=>{this._pendingPromises.add(t);const s=o=>{this._pendingPromises.has(t)&&this._updateFeatures(o),this._updatePendingPromises(t)},n=()=>this._updatePendingPromises(t);t.then(s,n)}),this.notifyChange("pendingPromisesCount")}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;return t===-1?null:e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return typeof e=="number"?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this.activeFeature=null,this._set("selectedFeatureIndex",e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=nc(this);return t?this.callGoTo({target:{target:t,scale:e.scale}}):Promise.reject(new k("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e}))}zoomTo(e){return this.callGoTo(e)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(e,t){const{view:s}=this;if(!s||!e)throw new k("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:s});return s.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:s}=t;delete t.fetchFeatures,s&&this._setFetchFeaturesPromises(t.location);const n=["actionsMenuOpen","collapsed","featureMenuOpen"];for(const o of n)delete t[o];this.set(t)}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){Pm(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const{view:e,selectedFeature:t}=this;(e==null?void 0:e.type)==="2d"?mi(t)?(await km(this),await Am(this)):N.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",t):N.getLogger(this.declaredClass).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",t)}_animationStateChange(e){this.zoomToLocation||(yi.disabled=e==="waiting-for-target")}_clearBrowsedClusterGraphics(){var t;const e=(t=this.view)==null?void 0:t.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){if(mi(this.selectedFeature))return this.browseClusterEnabled=!1,this.visible=!1,void this.clear();this.browseClusterEnabled&&(this.features=[this.selectedFeature])}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:s}=this;s&&e&&(!t||t.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:s,featuresPerPage:n,featureViewModels:o}=this;if(s===null)return;const r=((s-1)*n+t)%t,l=r+n;o.slice(r,l).forEach((d,u)=>{d&&!d.graphic&&(d.graphic=e[r+u])})}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:s,view:n}=this;if(this.browseClusterEnabled)return this._selectedClusterFeature&&(n.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),mi(e)?void 0:(e.symbol=await um(e),this._selectedClusterFeature=e,void n.graphics.add(this._selectedClusterFeature));!s&&t||!e.geometry?s&&!e.geometry&&this.centerAtLocation().then(()=>{this.location=n.center.clone()}):this.location=Ve(this._getPointFromGeometry(e.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then(t=>{const{clientOnlyGraphics:s,promisesPerLayerView:n}=t,o=Promise.resolve(s),r=n.map(l=>l.promise);this.promises=[o,...r]})}_destroyFeatureVMs(){this.featureViewModels.forEach(e=>e&&!e.destroyed&&e.destroy()),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:s}=this;if(mi(e)||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const n=s.slice(0),o=[];t.forEach((r,l)=>{var u,h;if(!r)return;let d=null;if(n.some((p,g)=>(p&&p.graphic===r&&(d=p,n.splice(g,1)),!!d)),d)o[l]=d;else{const p=new sr({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:(u=this.view)==null?void 0:u.spatialReference,graphic:r===e?r:null,map:(h=this.view)==null?void 0:h.map,view:this.view});o[l]=p}}),n.forEach(r=>r&&!r.destroyed&&r.destroy()),this._set("featureViewModels",o)}_getScreenPoint(e){const{view:t}=this;return t&&e&&typeof t.toScreen=="function"?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:s}=this;if(t.remove(e),s&&this.view){const n=this.view.on("click",o=>{o.pointerType==="mouse"&&o.button!==0||this._fetchFeaturesAndOpen(o)},Yt.WIDGET);t.add(n,e)}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const s=new AbortController,{signal:n}=s;this._fetchFeaturesController=s,this.notifyChange("waitingForResult");const o=this.fetchFeatures(e,{signal:n,event:t});return o.catch(()=>{}).then(()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}),o}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:s}=e,{view:n}=this;this._fetchFeaturesWithController(t,e).then(o=>{const{clientOnlyGraphics:r,promisesPerLayerView:l,location:d}=o,u=[Promise.resolve(r),...l.map(h=>h.promise)];return n.popup.open({location:d||s,promises:u}),o})}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(e){var t;return F(e)?null:e.type==="point"?e:e.type==="extent"?e.center:e.type==="polygon"?e.centroid:e.type==="multipoint"||e.type==="polyline"?(t=e.extent)==null?void 0:t.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}_getHighlightLayer(e){const{layer:t,sourceLayer:s}=e;return s&&"layer"in s&&s.layer?s.layer:(s==null?void 0:s.type)==="map-notes"||(s==null?void 0:s.type)==="subtype-group"?s:t}_getHighlightTarget(e,t){const s=t.type==="imagery"?void 0:"objectIdField"in t?t.objectIdField||dm:null,n=e.attributes;return n&&s&&n[s]||e}async _highlightActiveFeature(){const e="highlight-active-feature";this._handles.remove(e);const{highlightEnabled:t,view:s,activeFeature:n,visible:o}=this;if(!(n&&s&&t&&o))return;const r=this._getHighlightLayer(n);if(!(r&&r instanceof Cr))return;const l=this._getLayerView(s,r);this._highlightActiveFeaturePromise=l;const d=await l;if(!(d&&ma(d)&&this._highlightActiveFeaturePromise===l&&this.activeFeature&&this.highlightEnabled))return;const u=d.highlight(this._getHighlightTarget(n,r));this._handles.add(u,e)}async _highlightSelectedFeature(){const e="highlight-selected-feature";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:s,view:n,visible:o}=this;if(!(t&&n&&s&&o))return;const r=this._getHighlightLayer(t);if(!(r&&r instanceof Cr))return;const l=this._getLayerView(n,r);this._highlightSelectedFeaturePromise=l;const d=await l;if(!(d&&ma(d)&&this._highlightSelectedFeaturePromise===l&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const u=d.highlight(this._getHighlightTarget(t,r));this._handles.add(u,e)}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const s=e.filter(n=>!t.includes(n));this.features=t.concat(s)}};a([c()],D.prototype,"featurePage",void 0),a([c()],D.prototype,"isLoadingFeature",null),a([c({type:fs})],D.prototype,"actions",void 0),a([c({readOnly:!0})],D.prototype,"active",null),a([c()],D.prototype,"activeFeature",void 0),a([c({readOnly:!0})],D.prototype,"allActions",null),a([c({type:Boolean})],D.prototype,"defaultPopupTemplateEnabled",void 0),a([c()],D.prototype,"autoCloseEnabled",void 0),a([c()],D.prototype,"autoOpenEnabled",void 0),a([c()],D.prototype,"browseClusterEnabled",void 0),a([c()],D.prototype,"content",void 0),a([c({type:fs,readOnly:!0})],D.prototype,"defaultActions",null),a([c({readOnly:!0})],D.prototype,"featureCount",null),a([c()],D.prototype,"features",null),a([c()],D.prototype,"featuresPerPage",void 0),a([c()],D.prototype,"featureViewModelAbilities",void 0),a([c({readOnly:!0})],D.prototype,"featureViewModels",void 0),a([c()],D.prototype,"highlightEnabled",void 0),a([c()],D.prototype,"includeDefaultActions",void 0),a([c({type:X})],D.prototype,"location",null),a([c({readOnly:!0})],D.prototype,"pendingPromisesCount",null),a([c({readOnly:!0})],D.prototype,"selectedClusterBoundaryFeature",void 0),a([c({readOnly:!0})],D.prototype,"waitingForResult",null),a([c({readOnly:!0})],D.prototype,"promiseCount",null),a([c()],D.prototype,"promises",null),a([c({value:null,readOnly:!0})],D.prototype,"selectedFeature",null),a([c({value:-1})],D.prototype,"selectedFeatureIndex",null),a([c({readOnly:!0})],D.prototype,"selectedFeatureViewModel",null),a([c({readOnly:!0})],D.prototype,"state",null),a([c()],D.prototype,"title",void 0),a([c()],D.prototype,"updateLocationEnabled",void 0),a([c()],D.prototype,"view",void 0),a([c()],D.prototype,"visible",void 0),a([c()],D.prototype,"zoomFactor",void 0),a([c()],D.prototype,"zoomToLocation",void 0),a([c()],D.prototype,"centerAtLocation",null),D=a([b("esri.widgets.Popup.PopupViewModel")],D);const oc=D,ga="selected-index",Rm=0,fa="popup-spinner",y={calciteThemeLight:"calcite-theme-light",calciteThemeDark:"calcite-theme-dark",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",contentHasFlows:"esri-content--has-flows",contentFlowItem:"esri-content__flow-item",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",actionExit:"esri-popup__action--exit",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button",collapseIcon:"esri-popup__collapse-icon"},_a={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},ya="esri-popup";function pt(i,e){return e===void 0?`${ya}__${i}`:`${ya}__${i}-${e}`}const va={closeButton:!0,featureNavigation:!0};let A=class extends Xl(pe){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new at,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([s])=>{s!=null&&s.isIntersecting&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document}),this._displaySpinnerThrottled=zi(()=>this._displaySpinner(),Rm),this._exitRelatedRecordsActions=new WeakMap,this._flowItems=new ee,this.alignment="auto",this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureMenuOpen=!1,this.headingLevel=2,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.spinnerEnabled=!0,this.viewModel=new oc,this.visibleElements={...va},this._addSelectedFeatureIndexHandle(),this.addHandles([v(()=>{var s;return(s=this.viewModel)==null?void 0:s.screenLocation},()=>this._positionContainer()),v(()=>{var s;return[(s=this.viewModel)==null?void 0:s.active,this.dockEnabled]},()=>this._toggleScreenLocationEnabled()),v(()=>{var s;return(s=this.viewModel)==null?void 0:s.screenLocation},(s,n)=>{!!s!=!!n&&this.reposition()}),v(()=>{var s,n,o,r,l,d;return[(n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.padding,(r=(o=this.viewModel)==null?void 0:o.view)==null?void 0:r.size,(l=this.viewModel)==null?void 0:l.active,(d=this.viewModel)==null?void 0:d.location,this.alignment]},()=>this.reposition()),v(()=>this.spinnerEnabled,s=>this._spinnerEnabledChange(s)),v(()=>{var s,n;return(n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.size},(s,n)=>this._updateDockEnabledForViewSize(s,n)),v(()=>{var s;return(s=this.viewModel)==null?void 0:s.view},(s,n)=>this._viewChange(s,n)),v(()=>{var s,n;return(n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.ready},(s,n)=>this._viewReadyChange(s,n)),v(()=>{var s,n;return[(s=this.viewModel)==null?void 0:s.waitingForResult,(n=this.viewModel)==null?void 0:n.location]},()=>{this._hideSpinner(),this._displaySpinnerThrottled()}),v(()=>this.selectedFeatureWidget,()=>this._destroyFlowItemWidgets()),v(()=>{var s,n,o,r;return[(n=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:n.title,(r=(o=this.selectedFeatureWidget)==null?void 0:o.viewModel)==null?void 0:r.state]},()=>this._setTitleFromFeatureWidget()),v(()=>{var s,n,o,r;return[(n=(s=this.selectedFeatureWidget)==null?void 0:s.viewModel)==null?void 0:n.content,(r=(o=this.selectedFeatureWidget)==null?void 0:o.viewModel)==null?void 0:r.state]},()=>this._setContentFromFeatureWidget()),At(()=>!this.collapsed,()=>{var s,n;((n=(s=this.viewModel)==null?void 0:s.view)==null?void 0:n.widthBreakpoint)==="xsmall"&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()}),Ze(()=>{var s;return(s=this.viewModel)==null?void 0:s.allActions},"change",()=>this._watchActions()),v(()=>{var s;return(s=this.viewModel)==null?void 0:s.allActions},()=>this._watchActions(),U),v(()=>{var s;return(s=this.viewModel)==null?void 0:s.featureViewModels},()=>this._featureMenuViewportScrollTop()),Ze(()=>this._flowItems,"change",()=>{this.notifyChange("_activeFlowItemWidget"),this.scheduleRender()}),v(()=>{var s,n,o,r;return[(n=(s=this._activeFlowItemWidget)==null?void 0:s.viewModel)==null?void 0:n.state,(r=(o=this._activeFlowItemWidget)==null?void 0:o.viewModel)==null?void 0:r.title]},()=>this.scheduleRender())])}loadDependencies(){return Promise.all([I(()=>import("./calcite-flow-b512b524.js"),["assets/calcite-flow-b512b524.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/observers-32bcc375.js"]),I(()=>import("./calcite-flow-item-8da0cf87.js"),["assets/calcite-flow-item-8da0cf87.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/guid-e49c4e43.js","assets/action-994c8c10.js","assets/observers-32bcc375.js","assets/interactive-52dcf836.js","assets/icon-ba19bc6b.js","assets/tooltip-a947abbf.js"]),I(()=>import("./calcite-action-680e7c11.js"),["assets/calcite-action-680e7c11.js","assets/action-994c8c10.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/observers-32bcc375.js","assets/interactive-52dcf836.js","assets/icon-ba19bc6b.js","assets/guid-e49c4e43.js"]),I(()=>import("./calcite-tooltip-485111fb.js"),["assets/calcite-tooltip-485111fb.js","assets/tooltip-a947abbf.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/guid-e49c4e43.js"]),I(()=>import("./calcite-icon-901434b0.js"),["assets/calcite-icon-901434b0.js","assets/icon-ba19bc6b.js","assets/widget-4becb80f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/intl-a5c99ea3.js","assets/number-c7f1bfee.js","assets/jsonMap-5afaf2ff.js","assets/locale-30120714.js","assets/messages-634811b5.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/assets-6ba3cd63.js","assets/Evented-b378ccab.js","assets/Promise-6bd0b483.js","assets/reactiveUtils-b0e56010.js","assets/uuid-73213768.js","assets/observers-32bcc375.js"])])}destroy(){var e,t;this._destroyFlowItemWidgets(),this._destroySelectedFeatureWidget(),this._destroySpinner(),(e=this._handles)==null||e.destroy(),this._unobserveFeatureMenuObserver(),(t=this._featureMenuIntersectionObserver)==null||t.disconnect(),this._handles=null}get actionsMenuId(){return`${this.id}-actions-menu`}get actionsMenuButtonId(){return`${this.id}-actions-menu-button`}get featureMenuId(){return`${this.id}-feature-menu`}get titleId(){return`${this.id}-popup-title`}get contentId(){return`${this.id}-popup-content`}get hasContent(){const{selectedFeatureWidget:e,viewModel:t}=this;if(!e)return!!(t!=null&&t.content);const s=e.viewModel;if(s!=null&&s.waitingForContent||(s==null?void 0:s.state)==="error")return!0;const n=s==null?void 0:s.content;return Array.isArray(n)?!!n.length:!!n}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}get _activeFlowItemWidget(){const{_flowItems:e}=this;return e.getItemAt(e.length-1)||null}get actions(){return this.viewModel.actions}set actions(e){this.viewModel.actions=e}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(e){this.viewModel.autoCloseEnabled=e}get autoOpenEnabled(){return this.viewModel.autoOpenEnabled}set autoOpenEnabled(e){this.viewModel.autoOpenEnabled=e}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(e){this.viewModel.defaultPopupTemplateEnabled=e}get content(){return this.viewModel.content}set content(e){this.viewModel.content=e}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||_a}set dockOptions(e){const t={..._a},s=this.get("viewModel.view.breakpoints"),n={};s&&(n.width=s.xsmall,n.height=s.xsmall);const o={...t,...e},r={...t.breakpoint,...n},{breakpoint:l}=o;l===!0?o.breakpoint=r:typeof l=="object"&&(o.breakpoint={...r,...l}),this._set("dockOptions",o),this._setCurrentDockPosition(),this.reposition()}get featureCount(){return this.viewModel.featureCount}get features(){return this.viewModel.features}set features(e){this.viewModel.features=e}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(e){this.viewModel.highlightEnabled=e}get location(){return this.viewModel.location}set location(e){this.viewModel.location=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get promises(){return this.viewModel.promises}set promises(e){this.viewModel.promises=e}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(e){this.viewModel.selectedFeatureIndex=e}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:s,_flowItems:n}=this,{selectedFeatureViewModel:o}=this.viewModel,r={...t,title:!1};return o?(e?(e.viewModel=o,e.visibleElements=r):this._feature=new am({flowItems:n,headingLevel:s+1,viewModel:o,visibleElements:r}),this._feature):null}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(e){this.viewModel.updateLocationEnabled=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get visible(){return this.viewModel.visible}set visible(e){this.viewModel.visible=e}castVisibleElements(e){return{...va,...e}}blur(){const{active:e}=this.viewModel;e||N.getLogger(this.declaredClass).warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||N.getLogger(this.declaredClass).warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(e){var o,r;this._handles.remove(ga);const t=!!e&&!!e.featureMenuOpen,s=!!e&&!!e.actionsMenuOpen,n={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:s,featureMenuOpen:t};((r=(o=this.viewModel)==null?void 0:o.view)==null?void 0:r.widthBreakpoint)==="xsmall"&&(n.collapsed=!0),this.set(n),this.viewModel.open(e),this._shouldFocus(e),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(e){return this.viewModel.triggerAction(e)}render(){var T,w,E,P;const{actionsMenuOpen:e,dockEnabled:t,featureMenuVisible:s,dividedActions:n,currentAlignment:o,currentDockPosition:r}=this,{active:l}=this.viewModel,{menuActions:d}=n,u=l&&d.length>1&&e,h=l&&t,p=l&&!t,g=(w=(T=this.selectedFeature)==null?void 0:T.layer)==null?void 0:w.title,f=(P=(E=this.selectedFeature)==null?void 0:E.layer)==null?void 0:P.id,_={[y.alignTopCenter]:o==="top-center",[y.alignBottomCenter]:o==="bottom-center",[y.alignTopLeft]:o==="top-left",[y.alignBottomLeft]:o==="bottom-left",[y.alignTopRight]:o==="top-right",[y.alignBottomRight]:o==="bottom-right",[y.isDocked]:h,[y.shadow]:p,[y.isDockedTopLeft]:r==="top-left",[y.isDockedTopCenter]:r==="top-center",[y.isDockedTopRight]:r==="top-right",[y.isDockedBottomLeft]:r==="bottom-left",[y.isDockedBottomCenter]:r==="bottom-center",[y.isDockedBottomRight]:r==="bottom-right",[y.isFeatureMenuOpen]:s,[y.isActionsMenuOpen]:u};return m("div",{class:this.classes(y.base,_),role:"presentation","data-layer-title":g,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},l?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return m("span",{"aria-hidden":"true",class:this.classes(y.icon,y.iconLoading,y.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?m("div",{key:pt("loading-container"),role:"presentation",class:y.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=rt(this.container),t={[y.iconRightTriangleArrow]:e,[y.paginationPreviousIconRTL]:e,[y.iconLeftTriangleArrow]:!e,[y.paginationPreviousIconLTR]:!e};return m("span",{"aria-hidden":"true",class:this.classes(y.icon,t)})}renderPreviousButton(){const{messages:e}=this;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(y.button,y.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=rt(this.container),t={[y.iconLeftTriangleArrow]:e,[y.paginationNextIconRTL]:e,[y.iconRightTriangleArrow]:!e,[y.paginationNextIconLTR]:!e};return m("span",{"aria-hidden":"true",class:this.classes(y.icon,t)})}renderNextButton(){const{messages:e}=this;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(y.button,y.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:s}=this,{featureCount:n,selectedFeatureIndex:o}=this.viewModel;return m("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(y.button,y.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":s.menu,title:s.menu},this._getPageText(n,o))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),s={[y.iconUndock]:e,[y.iconDock]:!e,[y.iconDockToRight]:!e&&(t==="top-right"||t==="bottom-right"),[y.iconDockToLeft]:!e&&(t==="top-left"||t==="bottom-left"),[y.iconDockToTop]:!e&&t==="top-center",[y.iconDockToBottom]:!e&&t==="bottom-center"};return m("span",{"aria-hidden":"true",class:this.classes(s,y.icon)})}renderDockButton(){var o,r,l;const{dockEnabled:e,messages:t}=this,s=(r=(o=this.viewModel)==null?void 0:o.view)==null?void 0:r.widthBreakpoint,n=e?t.undock:t.dock;return s!=="xsmall"&&((l=this.dockOptions)!=null&&l.buttonEnabled)?m("div",{role:"button","aria-label":n,title:n,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(y.button,y.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:s,contentCollapsed:n,messagesCommon:o}=this,r={[y.headerContainerButton]:s},l=m(Jo,{level:this.headingLevel,class:y.headerTitle,innerHTML:e}),d=s?m("button",{key:`${e}--collapsible`,id:t,title:n?o.expand:o.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(y.headerContainer,r),"aria-expanded":n?"false":"true",onclick:this._toggleCollapsed,type:"button"},l,m("calcite-icon",{class:y.collapseIcon,key:"collapse-icon",icon:n?"chevron-down":"chevron-up",scale:"m"})):m("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(y.headerContainer,r)},l);return e?d:null}renderCloseIcon(){return m("span",{"aria-hidden":"true",class:this.classes(y.icon,y.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?m("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:y.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return m("header",{class:y.header},this.renderTitle(),m("div",{class:y.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:s,_flowItems:n,messagesCommon:o}=this,{content:r}=this.viewModel,l=n.toArray(),d={[y.contentHasFlows]:!!l.length};return t&&!s?m("div",{key:r,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:this.classes(y.content,d)},m("calcite-flow",{bind:this,onCalciteFlowItemBack:this._handleBackClick},m("calcite-flow-item",{bind:this,"data-node-ref":"_rootFlowItemNode","intl-back":o.back,afterCreate:nn,key:"root-flow-item"},this.renderContent()),l.map(u=>this.renderFlowItem(u))),l.map(u=>this.renderFlowItemTooltip(u))):null}renderFlowItem(e){const{messages:t,messagesCommon:s}=this,n=hn();return m("calcite-flow-item",{class:this.classes({[y.calciteThemeDark]:!n,[y.calciteThemeLight]:n}),heading:e.title,"intl-back":s.back,description:this._getFlowItemDescription(e),key:`flow-item-${e.viewModel.uid}`},m("calcite-action",{class:y.actionExit,icon:"move-up",label:t==null?void 0:t.exitRelatedRecords,text:t==null?void 0:t.exitRelatedRecords,slot:"header-actions-start",bind:this,afterCreate:o=>this._storeExitRelatedRecordsAction(e,o),onclick:this._destroyFlowItemWidgets}),m("div",{class:this.classes(y.contentFlowItem,{[y.calciteThemeDark]:n,[y.calciteThemeLight]:!n})},e.render()))}renderFlowItemTooltip(e){const{messages:t,_exitRelatedRecordsActions:s}=this,n=hn();return m("calcite-tooltip",{class:this.classes({[y.calciteThemeDark]:!n,[y.calciteThemeLight]:n}),key:`exit-related-records-tooltip-${e.viewModel.uid}`,label:t==null?void 0:t.exitRelatedRecords,overlayPositioning:"fixed",referenceElement:s.get(e),placement:"top"},t==null?void 0:t.exitRelatedRecords)}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:s,dividedActions:n,messagesCommon:o}=this,r=s?o.close:o.open,{menuActions:l}=n;return l.length?m("div",{key:pt("actions-menu-button"),class:this.classes(y.button,y.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":s?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":r,title:r},m("span",{"aria-hidden":"true",class:y.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:s,dividedActions:n}=this,{menuActions:o}=n;return o.length&&s?m("ul",{id:e,role:"menu","aria-labelledby":t,key:pt("actions"),class:y.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},o.toArray().map(r=>this.renderAction({action:r,type:"menu-item"}))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return!!e.length&&e.toArray().map(t=>this.renderAction({action:t,type:"inline"}))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,s=!!e.length,n=!!t.length;return s||n?m("div",{key:"inline-actions-container","data-inline-actions":s.toString(),"data-menu-actions":n.toString(),class:y.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?m("section",{key:pt("navigation"),class:this.classes(y.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:s,menuActions:n}=t,o=!!s.length,r=!!n.length,l={[y.footerHasPagination]:e,[y.footerHasActions]:o,[y.footerHasActionsMenu]:r};return e||o?m("div",{key:pt("feature-buttons"),class:this.classes(y.footer,l)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:s}=this.viewModel,n=ot(e.selectedFeatures,{total:t.length});return m("section",{key:pt("menu"),class:y.featureMenu},m("strong",{class:y.featureMenuHeader},n),m("nav",{bind:this,class:y.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:nn},this.renderFeatureMenu(),m("div",{class:y.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),s?m("div",{class:y.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:m("div",{key:pt("pointer"),class:y.pointer,role:"presentation"},m("div",{class:this.classes(y.pointerDirection,y.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:s,titleId:n,contentId:o,collapsible:r,hasContent:l,contentCollapsed:d,visibleElements:u}=this,{title:h}=this.viewModel,p=t==="bottom-left"||t==="bottom-center"||t==="bottom-right"||s==="top-left"||s==="top-center"||s==="top-right",g=t==="top-left"||t==="top-center"||t==="top-right"||s==="bottom-left"||s==="bottom-center"||s==="bottom-right",f={[y.shadow]:e,[y.isCollapsible]:r,[y.isCollapsed]:d};return m("div",{class:this.classes(y.main,y.widget,f),tabIndex:u.closeButton?null:-1,role:"dialog","aria-labelledby":h?n:"","aria-describedby":l&&!d?o:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},p?this.renderFooter():null,p?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),g?this.renderFooter():null,g?this.renderFeatureMenuContainer():null)}renderContent(){var t;const e=(t=this.viewModel)==null?void 0:t.content;return e?typeof e=="string"?m("div",{class:J.contentNode,key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(e){return m("span",{key:"text",class:y.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),s=this._getActionImage(e),n={[y.iconLoading]:e.active,[y.rotating]:e.active,[y.icon]:!!t,[y.actionImage]:!e.active&&!!s};return t&&(n[t]=!e.active),m("span",{key:"icon","aria-hidden":"true",class:this.classes(y.icon,n),styles:this._getIconStyles(s)})}renderAction(e){const{action:t,type:s}=e,n=this._getActionTitle(t),o={[y.action]:t.type!=="toggle",[y.actionToggle]:t.type==="toggle",[y.actionToggleOn]:t.type==="toggle"&&t.value,[y.buttonDisabled]:t.disabled},r=[this.renderActionIcon(t),this.renderActionText(n)],l=s==="menu-item"?m("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(y.button,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},r):m("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(y.button,o),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-uid":t.uid,onclick:this._triggerAction,onkeydown:this._triggerAction},r);return t.visible?l:null}renderFeatureMenuItem(e,t){const{messages:s,messagesCommon:n}=this,{selectedFeatureIndex:o,selectedFeatureViewModel:r}=this.viewModel,l=e===r,d={[y.featureMenuSelected]:l},u=l?m("span",{key:pt(`feature-menu-selected-feature-${o}`),title:s.selectedFeature,"aria-label":s.selectedFeature,class:y.iconCheckMark}):null,h=m("span",{innerHTML:e.title||n.untitled});return m("li",{role:"menuitem",tabIndex:-1,key:pt(`feature-menu-feature-${o}`),class:this.classes(d,y.featureMenuItem),bind:this,"data-feature-index":t,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature,onmouseover:this._setActiveFeature,onmouseleave:this._removeActiveFeature},m("span",{class:y.featureMenuTitle},h,u))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?m("ol",{class:y.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter(s=>!!s.graphic).map((s,n)=>this.renderFeatureMenuItem(s,n))):null}_storeExitRelatedRecordsAction(e,t){this._exitRelatedRecordsActions.set(e,t),this.scheduleRender()}_getFlowItemDescription(e){return"featureCountDescription"in e?e.featureCountDescription:e.viewModel.description}_destroyFlowItemWidgets(){this._flowItems.removeAll().forEach(e=>{"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e.viewModel=null,e.destroy()})}_handleBackClick(){const e=this._flowItems.pop();this._exitRelatedRecordsActions.delete(e),"showAllEnabled"in e.viewModel&&(e.viewModel.showAllEnabled=!1),e&&(e.viewModel=null,e.destroy())}_getActionTitle(e){const{messages:t,selectedFeature:s,messagesCommon:n}=this,{id:o}=e,r=s==null?void 0:s.attributes,l=o==="zoom-to-feature"?ot(e.title,{messages:t}):o==="remove-selected-feature"?ot(e.title,{messages:n}):o==="zoom-to-clustered-features"||o==="browse-clustered-features"?ot(e.title,{messages:t}):e.title;return l&&r?ot(l,r):l}_getActionClass(e){const{selectedFeature:t}=this,s=t==null?void 0:t.attributes,{className:n,image:o}=e,r=o||n?n:y.iconDefaultAction;return r&&s?ot(r,s):r}_getActionImage(e){const{selectedFeature:t}=this,s=t==null?void 0:t.attributes,{image:n}=e;return n&&s?ot(n,s):n}_createFeatureUpdatedAnimation(){return Hd("enter",y.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if(typeof e!="number")return null;const s=Math.round(e);return Math.max(t?s-1:s,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach(s=>{this._handles.add(v(()=>[s.uid,s.active,s.className,s.disabled,s.id,s.title,s.image,s.visible],()=>this.scheduleRender()),t)})}_divideActions(){const{allActions:e}=this.viewModel,t=e.filter(r=>r.visible),s=this._getInlineActionCount(),n=s===null,o=s===0;return{inlineActions:n?t.slice(0):o?new ee:t.slice(0,s),menuActions:n?new ee:o?t.slice(0):t.slice(s)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(){var s,n;const{selectedFeatureWidget:e,messagesCommon:t}=this;e&&(this.viewModel.title=((s=e.viewModel)==null?void 0:s.state)==="error"?t.errorMessage:((n=e.viewModel)==null?void 0:n.title)||"")}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e}_handleFeatureMenuKeyup(e){pi(e)==="Escape"&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(e){pi(e)==="Escape"&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_setActiveFeature(e){const{viewModel:t}=this,s=e.currentTarget["data-feature-index"];t.activeFeature=t.features[s]||null}_removeActiveFeature(){this.viewModel.activeFeature=null}_handleFeatureMenuItemKeyup(e){const t=pi(e),{_featureMenuNode:s}=this,n=e.currentTarget["data-feature-index"];if(!s)return;const o=s.querySelectorAll("li"),r=o.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),o[o.length-1].focus()):(e.stopPropagation(),o[0].focus()):(e.stopPropagation(),o[(n+1+r)%r].focus()):(e.stopPropagation(),o[(n-1+r)%r].focus())}_handleActionMenuItemKeyup(e){const t=pi(e),{_actionsMenuNode:s}=this,n=e.currentTarget.dataset.actionUid,{menuActions:o}=this.dividedActions,r=o.findIndex(u=>u.uid===n);if(!s)return;const l=s.querySelectorAll("li"),d=l.length;t!=="ArrowUp"?t!=="ArrowDown"?t!=="Home"?t!=="End"||(e.stopPropagation(),l[l.length-1].focus()):(e.stopPropagation(),l[0].focus()):(e.stopPropagation(),l[(r+1+d)%d].focus()):(e.stopPropagation(),l[(r-1+d)%d].focus())}_handleMainKeyup(e){const t=pi(e);t==="ArrowLeft"&&(e.stopPropagation(),this.previous()),t==="ArrowRight"&&(e.stopPropagation(),this.next())}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t)}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide())}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:s}=this.viewModel;s?e.show({location:t}):e.hide()}_getIconStyles(e){return{"background-image":e?`url(${e})`:""}}async _shouldFocus(e){e.shouldFocus&&(await zo(()=>{var t;return((t=this.viewModel)==null?void 0:t.active)===!0}),this.focus())}_addSelectedFeatureIndexHandle(){const e=v(()=>{var t;return(t=this.viewModel)==null?void 0:t.selectedFeatureIndex},(t,s)=>this._selectedFeatureIndexUpdated(t,s));this._handles.add(e,ga)}_selectedFeatureIndexUpdated(e,t){const{featureCount:s}=this;s&&e!==t&&e!==-1&&(this._destroyFlowItemWidgets(),this.actionsMenuOpen=!1,this.featureMenuOpen=!1,this._mainContainerNode&&(this._mainContainerNode.scrollTop=0),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:s,screenLocation:n,side:o,view:r}=e;if(isNaN(s)||isNaN(t)||!r||!n)return!1;const l=r.padding;return o==="right"&&n.x+s/2>r.width-l.right||o==="left"&&n.x-s/2<l.left||o==="top"&&n.y-t<l.top||o==="bottom"&&n.y+t>r.height-l.bottom}_calculateAutoAlignment(e){if(e!=="auto")return e;const{_pointerOffsetInPx:t,_containerNode:s,_mainContainerNode:n,viewModel:o}=this,{screenLocation:r,view:l}=o;if(F(r)||!l||!s)return"top-center";if(!this._isScreenLocationWithinView(r,l))return this._get("currentAlignment")||"top-center";function d(O){return parseInt(O.replace(/[^-\d\.]/g,""),10)}const u=n?window.getComputedStyle(n,null):null,h=u?d(u.getPropertyValue("max-height")):0,p=u?d(u.getPropertyValue("height")):0,{height:g,width:f}=s.getBoundingClientRect(),_=f+t,T=Math.max(g,h,p)+t,w=this._isOutsideView({popupHeight:T,popupWidth:_,screenLocation:r,side:"right",view:l}),E=this._isOutsideView({popupHeight:T,popupWidth:_,screenLocation:r,side:"left",view:l}),P=this._isOutsideView({popupHeight:T,popupWidth:_,screenLocation:r,side:"top",view:l}),$=this._isOutsideView({popupHeight:T,popupWidth:_,screenLocation:r,side:"bottom",view:l});return E?P?"bottom-right":"top-right":w?P?"bottom-left":"top-left":P?$?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return typeof e=="function"?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(e){const t=["left","right"];return rt(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return typeof e=="function"?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition((e=this.dockOptions)==null?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var l;if(e!=="auto")return e;const t=(l=this.viewModel)==null?void 0:l.view,s=rt(this.container)?"top-left":"top-right";if(!t)return s;const n=t.padding||{left:0,right:0,top:0,bottom:0},o=t.width-n.left-n.right,{breakpoints:r}=t;return r&&o<=r.xsmall?"bottom-center":s}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:s}=e.getBoundingClientRect(),n=this._calculatePositionStyle(t,s);n&&(e.style.top=n.top,e.style.left=n.left,e.style.bottom=n.bottom,e.style.right=n.right)}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:s}=this;return t==="top-left"||t==="bottom-left"||t==="top-right"||t==="bottom-right"?e+s:e}_calculateAlignmentPosition(e,t,s,n){const{currentAlignment:o,_pointerOffsetInPx:r}=this,l=n/2,d=s.height-t,u=s.width-e,{padding:h}=this.view;return o==="bottom-center"?{top:t+r-h.top,left:e-l-h.left}:o==="top-left"?{bottom:d+r-h.bottom,right:u+r-h.right}:o==="bottom-left"?{top:t+r-h.top,right:u+r-h.right}:o==="top-right"?{bottom:d+r-h.bottom,left:e+r-h.left}:o==="bottom-right"?{top:t+r-h.top,left:e+r-h.left}:o==="top-center"?{bottom:d+r-h.bottom,left:e-l-h.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:s,view:n}=this;if(!n)return;if(s)return{left:"",top:"",right:"",bottom:""};if(F(e)||!t)return;const o=this._calculateFullWidth(t),r=this._calculateAlignmentPosition(e.x,e.y,n,o);return r?{top:r.top!==void 0?`${r.top}px`:"auto",left:r.left!==void 0?`${r.left}px`:"auto",bottom:r.bottom!==void 0?`${r.bottom}px`:"auto",right:r.right!==void 0?`${r.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear())}_viewReadyChange(e,t){if(e){const s=this.get("viewModel.view");this._wireUpView(s)}else t&&(this.close(),this.clear())}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(e,t,s){const[n,o]=e,[r,l]=t,{width:d,height:u}=s;return n<=d&&r>d||n>d&&r<=d||o<=u&&l>u||o>u&&l<=u}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const s=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},n=s.left+s.right,o=s.top+s.bottom,r=[],l=[];r[0]=e[0]-n,r[1]=e[1]-o,l[0]=t[0]-n,l[1]=t[1]-o;const{dockOptions:d}=this,u=d.breakpoint;this._dockingThresholdCrossed(r,l,u)&&this._setDockEnabledForViewSize(d),this._setCurrentDockPosition()}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus())}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");t.length&&t[0].focus()}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus())}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const s=t.active&&!e;t.screenLocationEnabled=s}_shouldDockAtCurrentViewSize(e){var d,u;const t=e.breakpoint,s=(u=(d=this.viewModel)==null?void 0:d.view)==null?void 0:u.ui;if(!s)return!1;const{width:n,height:o}=s;if(isNaN(n)||isNaN(o))return!1;const r=t.hasOwnProperty("width")&&n<=t.width,l=t.hasOwnProperty("height")&&o<=t.height;return r||l}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e))}_getPageText(e,t){return this.featureNavigationVisible?ot(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,fa),e.destroy(),this._spinner=null)}_createSpinner(e){e&&(this._spinner=new cm({view:e}),e.ui.add(this._spinner,{key:fa,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e}_triggerAction(e){const t=e.currentTarget.dataset.actionUid,{allActions:s}=this.viewModel,n=s.findIndex(r=>r.uid===t),o=s.getItemAt(n);o&&o.type==="toggle"&&(o.value=!o.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(n)}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};a([c({readOnly:!0})],A.prototype,"actionsMenuId",null),a([c({readOnly:!0})],A.prototype,"actionsMenuButtonId",null),a([c({readOnly:!0})],A.prototype,"featureMenuId",null),a([c({readOnly:!0})],A.prototype,"titleId",null),a([c({readOnly:!0})],A.prototype,"contentId",null),a([c({readOnly:!0})],A.prototype,"hasContent",null),a([c({readOnly:!0})],A.prototype,"featureNavigationVisible",null),a([c({readOnly:!0})],A.prototype,"collapsible",null),a([c({readOnly:!0})],A.prototype,"featureMenuVisible",null),a([c({readOnly:!0})],A.prototype,"contentCollapsed",null),a([c({readOnly:!0})],A.prototype,"dividedActions",null),a([c({readOnly:!0,dependsOn:["_flowItems.length"]})],A.prototype,"_activeFlowItemWidget",null),a([c()],A.prototype,"actions",null),a([c()],A.prototype,"actionsMenuOpen",null),a([c()],A.prototype,"alignment",void 0),a([c()],A.prototype,"autoCloseEnabled",null),a([c()],A.prototype,"autoOpenEnabled",null),a([c()],A.prototype,"defaultPopupTemplateEnabled",null),a([c()],A.prototype,"content",null),a([c()],A.prototype,"collapsed",void 0),a([c()],A.prototype,"collapseEnabled",void 0),a([c({readOnly:!0})],A.prototype,"currentAlignment",null),a([c({readOnly:!0})],A.prototype,"currentDockPosition",null),a([c()],A.prototype,"dockOptions",null),a([c()],A.prototype,"dockEnabled",void 0),a([c({readOnly:!0})],A.prototype,"featureCount",null),a([c()],A.prototype,"featureMenuOpen",void 0),a([c()],A.prototype,"features",null),a([c()],A.prototype,"goToOverride",null),a([c()],A.prototype,"headingLevel",void 0),a([c()],A.prototype,"highlightEnabled",null),a([c()],A.prototype,"location",null),a([c()],A.prototype,"label",null),a([c()],A.prototype,"maxInlineActions",void 0),a([c(),re("esri/widgets/Popup/t9n/Popup")],A.prototype,"messages",void 0),a([c(),re("esri/t9n/common")],A.prototype,"messagesCommon",void 0),a([c()],A.prototype,"promises",null),a([c({readOnly:!0})],A.prototype,"selectedFeature",null),a([c()],A.prototype,"selectedFeatureIndex",null),a([c({readOnly:!0})],A.prototype,"selectedFeatureWidget",null),a([c()],A.prototype,"spinnerEnabled",void 0),a([c()],A.prototype,"title",null),a([c()],A.prototype,"updateLocationEnabled",null),a([c()],A.prototype,"view",null),a([c({type:oc}),Xo(["triggerAction","trigger-action"])],A.prototype,"viewModel",void 0),a([c()],A.prototype,"visible",null),a([c()],A.prototype,"visibleElements",void 0),a([be("visibleElements")],A.prototype,"castVisibleElements",null),a([$e()],A.prototype,"_close",null),a([$e()],A.prototype,"_toggleDockEnabled",null),a([$e()],A.prototype,"_toggleFeatureMenu",null),a([$e()],A.prototype,"_toggleActionsMenu",null),a([$e()],A.prototype,"_triggerAction",null),a([$e()],A.prototype,"_selectFeature",null),a([$e()],A.prototype,"_next",null),a([$e()],A.prototype,"_previous",null),A=a([b("esri.widgets.Popup")],A);const wa=A,Zn=[0,0];function Lm(i){const e=(i.ownerDocument||window.document).defaultView,t=i.getBoundingClientRect();return Zn[0]=t.left+((e==null?void 0:e.pageXOffset)??0),Zn[1]=t.top+((e==null?void 0:e.pageYOffset)??0),Zn}function ba(i){i&&(pl(i),i.parentNode&&i.parentNode.removeChild(i))}function Fm(i){const e=document.createElement("div");return i.appendChild(e),e}const Qi=16,Ls=750,Om=512,Dm=2,Vm=i=>{let e=class extends i{constructor(...t){var s;super(...t),this._freqInfo={freq:Qi,time:Ls},this._overlayRenderTaskHandle=null,this.height=0,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,t.length!==0&&((s=t[0])==null?void 0:s.popup)!==void 0||(this.popup=new wa({view:this})),this.handles.add([v(()=>this.cursor,n=>{const{surface:o}=this;o&&o.setAttribute("data-cursor",n)}),v(()=>this.interacting,n=>{const{surface:o}=this;o&&o.setAttribute("data-interacting",n.toString())})])}initialize(){this.handles.add(v(()=>this.ui,(t,s)=>this._handleUIChange(t,s))),this._wireUI(this.ui),this.handles.add([this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){this.destroyed||(this.ui=Ee(this.ui),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(t){const s=this._get("container"),n=hl(t),o=n instanceof HTMLDivElement?n:null;if(o||typeof t!="string"||N.getLogger(this.declaredClass).error("#container",`element with id '${t}' not found`),s===o)return;const r="dom-size";if(this.handles.remove(r),this._stopMeasuring(),s&&(s.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(ba(this.root),this._set("root",null)),this.userContent&&(wr(this.userContent,s),ba(this.userContent),this._set("userContent",null))),!o)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);o.classList.add("esri-view");const l=document.createElement("div");l.className="esri-view-user-storage",wr(o,l),o.appendChild(l),this._set("userContent",l);const d=document.createElement("div");d.className="esri-view-root",o.insertBefore(d,o.firstChild),this._set("root",d);const u=document.createElement("div");u.className="esri-view-surface",u.setAttribute("role","application"),u.tabIndex=0,d.appendChild(u),this._set("surface",u);const h=new Br;d.appendChild(h.surface),this._set("overlay",h),v(()=>h.needsRender,p=>{p&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=Bi({render:()=>{var g;return(g=this.overlay)==null?void 0:g.render()}}):this._overlayRenderTaskHandle=ei(this._overlayRenderTaskHandle)}),this.forceDOMReadyCycle(),this.handles.add(v(()=>this.size,p=>{const[g,f]=p,_="esri-view-surface--inset-outline";g>=document.body.clientWidth||f>=document.body.clientHeight?u.classList.add(_):u.classList.remove(_)},U),r),this._set("container",o),this._startMeasuring()}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}set popup(t){const s=this._get("popup");s&&s!==t&&s.destroy(),this._set("popup",t)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(t,s,n){const o=this.position;return t-=o?o[0]:0,s-=o?o[1]:0,n?(n[0]=t,n[1]=s):n=[t,s],n}containerToPage(t,s,n){const o=this.position;return t+=o?o[0]:0,s+=o?o[1]:0,n?(n[0]=t,n[1]=s):n=[t,s],n}_handleUIChange(t,s){s&&(this.handles.remove("ui"),s.destroy()),t&&this._wireUI(t),this._set("ui",t)}_wireUI(t){this.handles.remove("ui"),t&&(t.view=this,this.handles.add([v(()=>this.root,s=>{t.container=s?Fm(s):null},U),v(()=>this.popup,(s,n)=>{const o="popup",r="manual";n&&t.remove(n,o),s&&(s.view=t.view,t.add(s,{key:o,position:r}))},U)],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=Qi,t.time=Ls,this.handles.add([(()=>{const s=()=>{t.freq=Qi,t.time=Ls};return window.addEventListener("resize",s),{remove(){window.removeEventListener("resize",s)}}})(),Bi({prepare:s=>{const n=this._measure(),o=this._freqInfo;if(o.time+=s.deltaTime,n&&(o.freq=Qi,this._get("resizing")||this._set("resizing",!0)),o.time<o.freq)return;o.time=0;const r=this._position();o.freq=r||n?Qi:Math.min(Ls,o.freq*Dm),!n&&o.freq>=Om&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,s=t?t.clientWidth:0,n=t?t.clientHeight:0;if(s===0||n===0)return this.suspended||this._set("suspended",!0),!1;const o=this.width,r=this.height;return s===o&&n===r?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",s),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:o,oldHeight:r,width:s,height:n}),!0)}_position(){const t=this.container,s=this.position,n=t&&Lm(t);return!!n&&(!s||n[0]!==s[0]||n[1]!==s[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return a([c()],e.prototype,"container",null),a([c({readOnly:!0})],e.prototype,"focused",null),a([c({readOnly:!0})],e.prototype,"height",void 0),a([c({type:wa})],e.prototype,"popup",null),a([c({type:Br})],e.prototype,"overlay",void 0),a([c({readOnly:!0})],e.prototype,"position",void 0),a([c({readOnly:!0})],e.prototype,"resizing",void 0),a([c({readOnly:!0})],e.prototype,"root",void 0),a([c({value:null,readOnly:!0})],e.prototype,"size",null),a([c({readOnly:!0})],e.prototype,"surface",void 0),a([c({readOnly:!0})],e.prototype,"suspended",void 0),a([c()],e.prototype,"ui",void 0),a([c({readOnly:!0})],e.prototype,"userContent",void 0),a([c({readOnly:!0})],e.prototype,"width",void 0),a([c()],e.prototype,"widthBreakpoint",void 0),e=a([b("esri.views.DOMContainer")],e),e},Nm=i=>{let e=class extends i{async fetchPopupFeatures(t,s){await this.when();const{location:n,queryArea:o,layerViewsAndGraphics:r,clientOnlyGraphics:l}=await this._prepareFetchPopupFeatures(t,s),d=Promise.resolve(l),u=this._queryLayerPopupFeatures(o,r,s),h=u.map(p=>p.promise);return{location:n,clientOnlyGraphics:l,allGraphicsPromise:ud([d,...h]).then(p=>Array.from(new Set(p.flat()))),promisesPerLayerView:u}}_queryLayerPopupFeatures(t,s,n){return s.map(({layerView:o,graphics:r})=>{const l={clientGraphics:r,event:M(n)?n.event:null,signal:M(n)?n.signal:null,defaultPopupTemplateEnabled:!!M(n)&&!!n.defaultPopupTemplateEnabled},d=o.fetchPopupFeatures(t,l);return{layerView:o,promise:d}})}_isValidPopupGraphic(t,s){return t&&!!t.getEffectivePopupTemplate(M(s)&&s.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(t,s){const{clientGraphics:n,queryArea:o,location:r}=await this._popupHitTestGraphics(t,s),l=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:d,clientOnlyGraphics:u}=this._graphicsPerFetchPopupLayerView(n,l);return{clientOnlyGraphics:u,layerViewsAndGraphics:d,queryArea:o,location:r}}async _popupHitTestGraphics(t,s){const{results:n,mapPoint:o}=await this.popupHitTest(t),r=n.filter(d=>d.type==="graphic"&&this._isValidPopupGraphic(d.graphic,s)),l=r.length?r[0].mapPoint:null;return{clientGraphics:r.map(d=>d.graphic),queryArea:o,location:o||l}}_getFetchPopupLayerViews(){const t=[];return this.allLayerViews.forEach(s=>{this._isValidPopupLayerView(s)&&t.push(s)}),M(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}_isValidPopupLayerView(t){return M(t)&&(!("layer"in t)||!t.suspended)&&"fetchPopupFeatures"in t}_graphicsPerFetchPopupLayerView(t,s){const n=[],o=new Map,r=s.map(l=>{const d=[];return"layer"in l?o.set(l.layer,d):o.set(l.graphics,d),{layerView:l,graphics:d}});for(const l of t){const d=o.get(l.layer)||o.get(l.sourceLayer)||null;d?d.push(l):n.push(l)}return{layerViewsAndGraphics:r,clientOnlyGraphics:n}}};return e=a([b("esri.views.PopupView")],e),e};let mn=class extends $u{constructor(e){super(e),this.handles.add(this.on("before-add",t=>{F(t.item)||t.item.parent===this.owner&&(N.getLogger(this.declaredClass).warn("Analysis inside the collection must be unique. Not adding this element again."),t.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};mn=a([b("esri.support.AnalysesCollection")],mn);let Nt=class extends V{constructor(e){super(e),this.view=null,this.baseLayerViews=new ee,this.referenceLayerViews=new ee,this._loadingHandle=v(()=>{var t,s;return(s=(t=this.view)==null?void 0:t.map)==null?void 0:s.basemap},t=>{t&&t.load().catch(()=>{})},U)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}get suspended(){return!this.view||this.view.suspended}get updating(){var t,s;if(this.view&&this.view.suspended)return!1;const e=(s=(t=this.view)==null?void 0:t.map)==null?void 0:s.basemap;return!!e&&!!e.loaded&&(this.baseLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};a([c({constructOnly:!0})],Nt.prototype,"view",void 0),a([c({readOnly:!0})],Nt.prototype,"baseLayerViews",void 0),a([c({readOnly:!0})],Nt.prototype,"referenceLayerViews",void 0),a([c({readOnly:!0})],Nt.prototype,"suspended",null),a([c({type:Boolean,readOnly:!0})],Nt.prototype,"updating",null),Nt=a([b("esri.views.BasemapView")],Nt);let zm=class{constructor(e,t,s){this.layer=e,this.view=t,this.layerViewImporter=s,this._controller=new AbortController,this._deferred=sl(),this._started=!1,this.done=!1,_r(this._controller.signal,()=>{const n=new k("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(n)})}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:t,view:s}=this;t.emit("layerview-destroy",{view:s,layerView:e}),s.emit("layerview-destroy",{layer:t,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}async start(){var n,o;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:t,view:s}=this;this._map=s.map;try{let r,l;if(await t.load({signal:e}),"prefetchResources"in t&&await t.prefetchResources({signal:e}),t.createLayerView)r=await t.createLayerView(s,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(t))throw new k("layer:view-not-supported","No layerview implementation was found");const h=await this.layerViewImporter.importLayerView(t);Kt(e),r="default"in h?new h.default({layer:t,view:s}):new h({layer:t,view:s})}const d=()=>{l=ei(l),r.destroyed||r.destroy(),r.layer=null,r.parent=null,r.view=null,this.done=!0};l=_r(e,d),Kt(e);try{await r.when()}catch(h){throw d(),h}if(!((o=(n=this._map)==null?void 0:n.allLayers)==null?void 0:o.includes(t)))return d(),void this._deferred.reject(new k("view:no-layerview-for-layer","The layer has been removed from the map",{layer:t}));this.layerView=r,t.emit("layerview-create",{view:s,layerView:r}),s.emit("layerview-create",{layer:t,layerView:r}),this.done=!0,this._deferred.resolve(r)}catch(r){t.emit("layerview-create-error",{view:s,error:r}),s.emit("layerview-create-error",{layer:t,error:r}),this.done=!0,this._deferred.reject(new k("layerview:create-error","layerview creation failed",{layer:t,error:r}))}}},Ue=class extends V{constructor(i){super(i),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new ml,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var t;const e=(t=this.view.map)==null?void 0:t.allLayers;if(e)for(const s of e)this.layerViewImporter.hasLayerViewModule(s)&&this.layerViewImporter.importLayerView(s)},this._reschedule=()=>(F(this._workPromise)&&(this._workPromise=sl(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(od(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var r,l,d;const e=this.view.map;if(this._map!==e&&(this.clear(),this._map=e),F(this._workPromise))return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const t=[],s=u=>{if(!F(u))for(const h of u)h&&(t.push(h),this._createLayerView(h),"layers"in h&&h.layers&&s(h.layers))};for(const u of this._rootCollectionNames)s(this.get(u));this._refreshCollections();for(const[u,h]of this._layerLayerViewInfoMap)t.includes(u)||(this._layerLayerViewInfoMap.delete(h.layer),h.destroy());const n=t.filter(u=>u.type==="group").map(u=>u.layers),o=[(r=e==null?void 0:e.ground)==null?void 0:r.layers,(l=e==null?void 0:e.basemap)==null?void 0:l.baseLayers,(d=e==null?void 0:e.basemap)==null?void 0:d.referenceLayers,e==null?void 0:e.layers,...n].filter(u=>!!u);this.addHandles(o.map(u=>this._watchUpdatingTracking.addOnCollectionChange(()=>u,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.own([Ze(()=>{var i,e;return(e=(i=this.view)==null?void 0:i.map)==null?void 0:e.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),v(()=>{const i=this.view,e=i==null?void 0:i.map;return[e==null?void 0:e.basemap,e==null?void 0:e.ground,e==null?void 0:e.layers,i==null?void 0:i.ready]},()=>this._reschedule(),oi)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null,M(this._workPromise)&&(this._workPromise.reject(hd()),this._workPromise=null)}get _layersToLayerViews(){const i=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&i.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(i)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return M(this._workPromise)||this._watchUpdatingTracking.updating||fn(this._layerLayerViewInfoMap,i=>!i.done)}get updatingRemaining(){let i=0;for(const e of this._layerLayerViewInfoMap.values())e.done||++i;return i}clear(){if(!this.destroyed){for(const i of this._layerLayerViewInfoMap.values())i.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}async whenLayerView(i){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(i))throw new k("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:i});return this._layerLayerViewInfoMap.get(i).promise}_refreshCollections(){for(const[i,e]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(i),this.get(e),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(i,e,t){if(!i||!e)return void(e&&e.removeAll());let s=0;for(const n of i){const o=this._layerLayerViewInfoMap.get(n);if(!o||!o.layerView)continue;const r=o.layerView;r.layer=n,r.parent=t,e.getItemAt(s)!==r&&e.splice(s,0,r),n.layers&&this._populateLayerViewsOwners(n.layers,r.layerViews,r),s+=1}s<e.length&&e.splice(s,e.length)}_createLayerView(i){if(this._layerLayerViewInfoMap.has(i))return this.view.ready&&this._layerLayerViewInfoMap.get(i).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");i.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i);const e=new zm(i,this.view,this.layerViewImporter);e.promise.then(()=>this._refreshCollections(),t=>{t&&(il(t)||t.name==="cancelled:layerview-create")||N.getLogger(this.declaredClass).error(`Failed to create layerview for layer title:'${i.title??"no title"}', id:'${i.id??"no id"}' of type '${i.type}'.`,{layer:i,error:t}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(i,e),this.view.ready&&e.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};a([c()],Ue.prototype,"_workPromise",void 0),a([c({readOnly:!0})],Ue.prototype,"_watchUpdatingTracking",void 0),a([c({readOnly:!0})],Ue.prototype,"_layersToLayerViews",null),a([c({readOnly:!0})],Ue.prototype,"_rootCollectionNames",null),a([c()],Ue.prototype,"layerViewImporter",void 0),a([c()],Ue.prototype,"supportsGround",void 0),a([c({readOnly:!0})],Ue.prototype,"updating",null),a([c({readOnly:!0})],Ue.prototype,"updatingRemaining",null),a([c({constructOnly:!0})],Ue.prototype,"view",void 0),Ue=a([b("esri.views.LayerViewManager")],Ue);const Bm=Ue;let Oe=class extends V{constructor(e){super(e),this.factor=1.5,this.offset=fe(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};a([c({type:Number})],Oe.prototype,"factor",void 0),a([c({nonNullable:!0})],Oe.prototype,"offset",void 0),a([c()],Oe.prototype,"position",void 0),a([c({type:Number,range:{min:0}})],Oe.prototype,"size",void 0),a([c()],Oe.prototype,"maskUrl",void 0),a([c()],Oe.prototype,"maskEnabled",void 0),a([c()],Oe.prototype,"overlayUrl",void 0),a([c()],Oe.prototype,"overlayEnabled",void 0),a([c({readOnly:!0})],Oe.prototype,"version",null),a([c({type:Boolean})],Oe.prototype,"visible",void 0),Oe=a([b("esri.views.Magnifier")],Oe);const rc=Oe;let cs=class extends V{constructor(e,t){super({}),this._stage=e,this._textureRequests=new Map,this._frameTask=(t==null?void 0:t.registerTask(Tu.TEXTURE_UNLOAD))??Eu}normalizeCtorArgs(){return{}}destroy(){super.destroy(),this._frameTask.remove(),this._textureRequests.forEach(e=>this._releaseTextureRequest(e)),this._textureRequests.clear()}get updating(){return this._frameTask.updating}fromData(e,t,s){const n=this.makeUid(e);let o=this._textureRequests.get(n);return o||(o={referenceCount:0,texture:t(),textureAsync:null,abortController:null,onRemove:s},this._stage&&(this._stage.add(o.texture),this._stage.loadImmediate(o.texture)),this._textureRequests.set(n,o)),o.referenceCount++,{uid:n,texture:o.texture,release:()=>this._release(n)}}_release(e){const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule(()=>this._releaseNow(e))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e))}_releaseTextureRequest(e){var t;e.onRemove&&e.onRemove(),e.texture?(t=this._stage)==null||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null)}makeUid(e,t=null){return M(t)?`${e}.${t}px`:e}};a([c()],cs.prototype,"_frameTask",void 0),a([c()],cs.prototype,"updating",null),cs=a([b("esri.views.3d.support.TextureCollection")],cs);var Ma;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right"})(Ma||(Ma={}));const ac=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],lc={};function cc(i){return!!lc[i]}function Um(i){for(const e of i)if(!cc(e))return!1;return!0}ac.forEach(i=>{lc[i]=!0});let Hm=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:t,priority:s},n)=>this.inputManager.installHandlers(n,[t],s))}disconnect(){this.inputManager&&this._handlers.forEach((e,t)=>this.inputManager.uninstallHandlers(t)),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,t,s,n){const o=Array.isArray(e)?e:e.split(",");if(!Um(o))return o.some(cc)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let r,l;Array.isArray(t)?l=t:(r=t,l=[]),typeof s=="function"?r=s:n=s,n=n??Yt.DEFAULT;const d=this._createUniqueGroupName(),u=new Gm(this.view,o,l,r);this._handlers.set(d,{handler:u,priority:n});for(const h of o){const p=this._handlerCounts.get(h)||0;this._handlerCounts.set(h,p+1)}return this.inputManager&&this.inputManager.installHandlers(d,[u],n),{remove:()=>this._removeHandler(d,o)}}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,t){if(this._handlers.has(e)){this._handlers.delete(e);for(const s of t){const n=this._handlerCounts.get(s);n===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",s):n===1?this._handlerCounts.delete(s):this._handlerCounts.set(s,n-1)}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},Gm=class extends me{constructor(e,t,s,n){super(!0),this.view=e;for(const o of t)switch(o){case"click":this.registerIncoming("click",s,r=>n(this._wrapClick(r)));break;case"double-click":this.registerIncoming("double-click",s,r=>n(this._wrapDoubleClick(r)));break;case"immediate-click":this.registerIncoming("immediate-click",s,r=>n(this._wrapImmediateClick(r)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",s,r=>n(this._wrapImmediateDoubleClick(r)));break;case"hold":this.registerIncoming("hold",s,r=>n(this._wrapHold(r)));break;case"drag":this.registerIncoming("drag",s,r=>{const l=this._wrapDrag(r);l&&n(l)});break;case"key-down":this.registerIncoming("key-down",s,r=>n(this._wrapKeyDown(r)));break;case"key-up":this.registerIncoming("key-up",s,r=>n(this._wrapKeyUp(r)));break;case"pointer-down":this.registerIncoming("pointer-down",s,r=>n(this._wrapPointer(r,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",s,r=>n(this._wrapPointer(r,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",s,r=>n(this._wrapPointer(r,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",s,r=>n(this._wrapPointerDrag(r)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",s,r=>n(this._wrapMouseWheel(r)));break;case"pointer-enter":this.registerIncoming("pointer-enter",s,r=>n(this._wrapPointer(r,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",s,r=>n(this._wrapPointer(r,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",s,r=>{n(this._wrapGamepad(r))});break;case"focus":this.registerIncoming("focus",s,r=>{n(this._wrapFocus(r))});break;case"blur":this.registerIncoming("blur",s,r=>{n(this._wrapBlur(r))})}}_wrapFocus(e){return{type:"focus",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapBlur(e){return{type:"blur",timestamp:e.timestamp,native:e.data.native,cancelable:e.cancelable,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}_wrapClick(e){const{pointerType:t,button:s,buttons:n,x:o,y:r,native:l,eventId:d}=e.data,{cancelable:u,timestamp:h}=e;return{type:"click",pointerType:t,button:s,buttons:n,x:o,y:r,native:l,timestamp:h,screenPoint:fe(o,r),mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapDoubleClick(e){const{pointerType:t,button:s,buttons:n,x:o,y:r,native:l,eventId:d}=e.data,{cancelable:u,timestamp:h}=e;return{type:"double-click",pointerType:t,button:s,buttons:n,x:o,y:r,native:l,timestamp:h,mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:p=>e.async(p),preventDefault:()=>e.preventDefault()}}_wrapImmediateClick(e){const{pointerType:t,button:s,buttons:n,x:o,y:r,native:l,eventId:d}=e.data,u=l.pointerId,{cancelable:h,timestamp:p}=e;return{type:"immediate-click",pointerId:u,pointerType:t,button:s,buttons:n,x:o,y:r,native:l,timestamp:p,mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapImmediateDoubleClick(e){const{pointerType:t,button:s,buttons:n,x:o,y:r,native:l,eventId:d}=e.data,u=l.pointerId,{cancelable:h,timestamp:p}=e;return{type:"immediate-double-click",pointerId:u,pointerType:t,button:s,buttons:n,x:o,y:r,native:l,timestamp:p,mapPoint:this._getMapPoint(o,r),eventId:d,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:g=>e.async(g),preventDefault:()=>e.preventDefault()}}_wrapHold(e){const{pointerType:t,button:s,buttons:n,x:o,y:r,native:l}=e.data,{cancelable:d,timestamp:u}=e;return{type:"hold",pointerType:t,button:s,buttons:n,x:o,y:r,native:l,timestamp:u,mapPoint:this._getMapPoint(o,r),cancelable:d,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}_getMapPoint(e,t){return this.view.toMap(fe(e,t),{exclude:[]})}_wrapDrag(e){const t=e.data,{x:s,y:n}=t.center,{action:o,pointerType:r,button:l}=t;if(o==="start"&&(this._latestDragStart=t),!this._latestDragStart)return;const d=t.pointer.native,u=t.buttons,{cancelable:h,timestamp:p}=e,g={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return o==="end"&&(this._latestDragStart=void 0),{type:"drag",action:o,x:s,y:n,origin:g,pointerType:r,button:l,buttons:u,radius:t.radius,angle:Sd(t.angle),native:d,timestamp:p,cancelable:h,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapKeyDown(e){const{key:t,repeat:s,native:n}=e.data,{cancelable:o,timestamp:r}=e;return{type:"key-down",key:t,repeat:s,native:n,timestamp:r,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:l=>e.async(l),preventDefault:()=>e.preventDefault()}}_wrapKeyUp(e){const{key:t,native:s}=e.data,{cancelable:n,timestamp:o}=e;return{type:"key-up",key:t,native:s,timestamp:o,cancelable:n,stopPropagation:()=>e.stopPropagation(),async:r=>e.async(r),preventDefault:()=>e.preventDefault()}}_wrapPointer(e,t){const{x:s,y:n,button:o,buttons:r,native:l,eventId:d}=e.data,u=l.pointerId,h=l.pointerType,{cancelable:p,timestamp:g}=e;return{type:t,x:s,y:n,pointerId:u,pointerType:h,button:o,buttons:r,native:l,timestamp:g,eventId:d,cancelable:p,stopPropagation:()=>e.stopPropagation(),async:f=>e.async(f),preventDefault:()=>e.preventDefault()}}_wrapPointerDrag(e){const{x:t,y:s,buttons:n,native:o,eventId:r}=e.data.currentEvent,{button:l}=e.data.startEvent,d=e.data.startEvent.native.pointerId,u=e.data.startEvent.native.pointerType,h=e.data.action,p={x:e.data.startEvent.x,y:e.data.startEvent.y},{cancelable:g,timestamp:f}=e;return{type:"pointer-drag",x:t,y:s,pointerId:d,pointerType:u,button:l,buttons:n,action:h,origin:p,native:o,timestamp:f,eventId:r,cancelable:g,stopPropagation:()=>e.stopPropagation(),async:_=>e.async(_),preventDefault:()=>e.preventDefault()}}_wrapMouseWheel(e){const{cancelable:t,data:s,timestamp:n}=e,{x:o,y:r,deltaY:l,native:d}=s;return{type:"mouse-wheel",x:o,y:r,deltaY:l,native:d,timestamp:n,cancelable:t,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}_wrapGamepad(e){const{action:t,state:s,device:n}=e.data,{cancelable:o,timestamp:r}=e,{buttons:l,axes:d}=s;return{type:"gamepad",device:n,timestamp:r,action:t,buttons:l,axes:d,cancelable:o,stopPropagation:()=>e.stopPropagation(),async:u=>e.async(u),preventDefault:()=>e.preventDefault()}}};var Ms,Ia,Ca;(function(i){i[i.USER=0]="USER",i[i.MANAGER=1]="MANAGER"})(Ms||(Ms={})),function(i){i[i.None=0]="None",i[i.Unfocused=1]="Unfocused",i[i.Focused=2]="Focused",i[i.Unselected=4]="Unselected",i[i.Selected=8]="Selected",i[i.All=15]="All"}(Ia||(Ia={})),function(i){i[i.None=0]="None",i[i.Custom1=16]="Custom1",i[i.Custom2=32]="Custom2",i[i.Custom3=64]="Custom3",i[i.Custom4=128]="Custom4",i[i.Custom5=256]="Custom5",i[i.Custom6=512]="Custom6",i[i.Custom7=1024]="Custom7",i[i.Custom8=2048]="Custom8",i[i.Custom9=4096]="Custom9",i[i.Custom10=8192]="Custom10",i[i.Custom11=16384]="Custom11",i[i.Custom12=32768]="Custom12",i[i.All=65520]="All"}(Ca||(Ca={}));function qm(i){return[i.on("before-add",e=>{const t=e.item;if(t==null||i.includes(t))return N.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();t.onAdd()}),i.on("after-remove",e=>{const t=e.item;t.active&&(t.view.activeTool=null),t.destroy()})]}function Eo(i){return i.visible&&i.getEditableFlag(Ms.USER)&&i.getEditableFlag(Ms.MANAGER)}function tt(i){return fe(i.x,i.y)}function dc(i,e){const t=(i instanceof HTMLElement?i:i.surface).getBoundingClientRect();return fe(e.clientX-t.left,e.clientY-t.top)}function Ta(i,e){return e instanceof Event?dc(i,e):tt(e)}function Ea(i){if(i instanceof Event)return!0;if(typeof i=="object"&&"type"in i)switch(i.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let jm=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}handleInputEvent(e,t){const s=()=>e.stopPropagation();switch(e.type){case"pointer-move":xa(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(s(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!ka(e))break;const n=tt(e),o=this._intersect(n,e.pointerType,t.forEachTool);if(F(o))break;const r=o.manipulator,l=o.tool;!(M(r)&&M(l)&&r.interactive)||r.grabbable&&r.grabbableForEvent(e)||!r.grabbing||r.dragging||this._ungrabManipulatorBeforeDragging(r,e,t),M(r)&&M(l)&&r.interactive&&r.grabbable&&r.grabbableForEvent(e)&&!r.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:r,tool:l,start:n,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&F(t.activeTool)&&(this._revertToNullActiveTool=!0,t.setActiveTool(o.tool)),r.grabbing=!0,r.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),s());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,t);break;case"pointer-drag":{if(!ka(e))break;const n=this._grabbedManipulators.get(e.pointerId),o=ss(n,({manipulator:h})=>h),r=ss(n,({tool:h})=>h);if(F(o)||F(r))break;const l=tt(e);l.x=Hi(l.x,0,t.view.width),l.y=Hi(l.y,0,t.view.height);const d=Ve(n).start,u=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(o.dragging=!0,u?o.events.emit("drag",{action:"update",start:d,screenPoint:l}):o.events.emit("drag",{action:"start",start:d,screenPoint:l,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:r,manipulator:o,start:d}));break;case"end":o.dragging=!1,u&&o.events.emit("drag",{action:"end",start:d,screenPoint:l}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,t)}s();break}case"immediate-click":{const n=tt(e),o=this._intersect(n,e.pointerType,t.forEachTool);if(Wm(e)||t.forEachTool(u=>{if((!M(o)||o.tool!==u||u.automaticManipulatorSelection)&&u.manipulators){let h=!1;u.manipulators.forEach(({manipulator:p})=>{p.selected&&(p.selected=!1,h=!0)}),h&&u.onManipulatorSelectionChanged&&u.onManipulatorSelectionChanged()}}),F(o))break;const{manipulator:r,tool:l}=o;if(!r.interactive)break;r.selectable&&l.automaticManipulatorSelection&&(r.selected=!r.selected,l.onManipulatorSelectionChanged&&l.onManipulatorSelectionChanged());const d=e.native.shiftKey;r.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:d,stopPropagation:s});break}case"click":{const n=tt(e),o=this._intersect(n,e.pointerType,t.forEachTool),r=M(o)?o.manipulator:null;if(F(r)||!r.interactive)break;const l=e.native.shiftKey;r.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:l}),s();break}case"double-click":{const n=tt(e),o=this._intersect(n,e.pointerType,t.forEachTool),r=M(o)?o.manipulator:null;if(F(r)||!r.interactive)break;const l=e.native.shiftKey;r.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:s});break}case"immediate-double-click":{const n=tt(e),o=this._intersect(n,e.pointerType,t.forEachTool),r=M(o)?o.manipulator:null;if(F(r)||!r.interactive)break;const l=e.native.shiftKey;r.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:s});break}}this._onFocusChange(t.forEachTool)}_ungrabManipulatorBeforeDragging(e,t,s){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:tt(t)}),this._grabbedManipulators.forEach(({manipulator:n},o)=>{n===e&&this._grabbedManipulators.delete(o)}),this._afterManipulatorUngrab(s.setActiveTool)}_handlePointerEnd(e,t){const s=ss(this._grabbedManipulators.get(e.pointerId),({manipulator:n})=>n);F(s)||s.grabbing&&(s.grabbing=!1,s.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:tt(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorUngrab(t.setActiveTool))}_cursorFromMap(e){let t=null;return fn(e,({manipulator:s})=>!(F(s)||!s.interactive)&&(s.grabbing&&s.grabCursor?(t=s.grabCursor,!0):!!s.cursor&&(t=s.cursor,!0))),t}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const t=new Set,s=new Set;this._grabbedManipulators.forEach(({tool:n})=>{t.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{s.add(n)}),e(n=>{n.hasGrabbedManipulators=t.has(n),n.hasHoveredManipulators=s.has(n);const o=this._grabbedManipulators.values(),r=rd(o,({tool:l})=>l===n);n.firstGrabbedManipulator=M(r)?r.manipulator:null})}clearPointers(e,{forEachTool:t,setActiveTool:s},n=!0,o){const r=(l,d)=>l===e&&(F(o)||o===d);this._grabbedManipulators.forEach(({tool:l,manipulator:d,pointerType:u},h)=>{r(l,d)&&(this._grabbedManipulators.delete(h),d.grabbing=!1,d.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:u}))}),this._draggedManipulators.forEach(({tool:l,manipulator:d},u)=>{r(l,d)&&(this._draggedManipulators.delete(u),d.dragging=!1,d.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:l,manipulator:d},u)=>{r(l,d)&&(this._hoveredManipulators.delete(u),d.hovering=!1)}),this._afterManipulatorUngrab(s),this._onFocusChange(t)}_intersect(e,t,s){let n=null;return s(o=>{if(o.manipulators==null||!Eo(o))return!1;const r=o.manipulators.intersect(e,t);return!F(r)&&(n={tool:o,manipulator:r},!0)}),n}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((t,s)=>{this._updateHoveredStateForPointerAtScreenPosition(fe(t.x,t.y),s,t.pointerType,e)})}handleHoverEvent(e,t){e.type!=="pointer-up"&&e.type!=="immediate-click"&&e.type!=="pointer-move"||!xa(e.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(tt(e),e.pointerId,e.pointerType,t)}_updateHoveredStateForPointerAtScreenPosition(e,t,s,n){let o=this._intersect(e,s,n);const r=ss(this._hoveredManipulators.get(t),({manipulator:l})=>l);M(o)&&!o.manipulator.interactive&&(o=null),M(o)&&r===o.manipulator||(M(r)&&(r.hovering=!1),M(o)?(o.manipulator.hovering=!0,this._hoveredManipulators.set(t,o)):this._hoveredManipulators.delete(t),this._onFocusChange(n))}_afterManipulatorUngrab(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}};function xa(i){return i==="mouse"}function ka(i){return i.pointerType!=="mouse"||i.button===0}function Wm(i){return!!i.native.shiftKey}const Aa="attached",Kn="tools";let vt=class extends gl{constructor(e){super(e),this._manipulatorState=new jm,this.tools=new ee,this.cursor=null,this._forEachTool=t=>{for(const s of this.tools.items)if(t(s))return}}initialize(){this.handles.add([this.view.on(ac,e=>{this._handleInputEvent(e)},Yt.TOOL),...qm(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.detach(),this.handles.removeAll()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(M(e)&&!this.view.ready)return void N.getLogger(this.declaredClass).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const t=this.activeTool;this._set("activeTool",e),M(t)&&t.deactivate(),M(e)&&e.activate(),this._removeIncompleteTools(e);for(const s of this.tools){this._updateToolEditableFlag(s);const n=Eo(s);!F(this.activeTool)&&n||this._manipulatorState.clearPointers(s,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){var e;return this.updatingHandles.updating||this.tools.some(t=>t.updating)||(((e=this.textures)==null?void 0:e.updating)??!1)}attach(){this.view.type==="3d"?(this._set("textures",new cs(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([v(()=>{const{state:e}=this.view;return"camera"in e&&e.camera},()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}),this.view.elevationProvider.on("elevation-change",e=>{this._forEachManipulator(t=>{t.onElevationChange!=null&&t.onElevationChange(e)})}),tl(()=>this._set("textures",Ee(this.textures)))],Aa)):this.handles.add(v(()=>this.view.extent,()=>{this._forEachManipulator(e=>{e.onViewChange!=null&&e.onViewChange()})}))}detach(){M(this.activeTool)&&(this.activeTool=null),this.tools.removeAll(),this.handles.remove(Aa)}_forEachManipulator(e){this._forEachTool(t=>{t.manipulators&&t.manipulators.forEach(({manipulator:s})=>e(s,t))})}_handleInputEvent(e){let t=!1;const s={...e,stopPropagation:()=>{t=!0,e.stopPropagation()}};M(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(s):this._forEachTool(n=>{!t&&n.visible&&n.handleInputEvent(s)}),!t&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(s,this._manipulatorStateEventArgs),!t&&M(this.activeTool)&&this.activeTool.handleInputEventAfter(s),this._manipulatorState.handleHoverEvent(s,this._forEachTool),this._updateCursor()}_refreshToolWatchers(){this.handles.remove(Kn),this._forEachTool(e=>{if(e instanceof V){const t=v(()=>[e.cursor,e.visible,e.editable],()=>{Eo(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.handles.add(t,Kn)}e.manipulators&&this.handles.add([e.manipulators.on("after-remove",t=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,t.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],Kn)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){e.setEditableFlag(Ms.MANAGER,F(this.activeTool)||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;F(e)&&this._forEachTool(t=>!(!M(t.cursor)||!t.visible)&&(e=t.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(t=>(F(e)||t!==e)&&!t.created&&t.removeIncompleteOnCancel).forEach(t=>{this.tools.remove(t)})}};a([c({constructOnly:!0,nonNullable:!0})],vt.prototype,"view",void 0),a([c({readOnly:!0,nonNullable:!0})],vt.prototype,"textures",void 0),a([c({value:null})],vt.prototype,"activeTool",null),a([c({readOnly:!0,type:ee})],vt.prototype,"tools",void 0),a([c({readOnly:!0})],vt.prototype,"cursor",void 0),a([c({readOnly:!0})],vt.prototype,"updating",null),vt=a([b("esri.views.ToolViewManager")],vt);const Zm=vt;let Pi=class extends V{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":Km.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return Ym[this.deviceType]}};a([c({nonNullable:!0,readOnly:!0})],Pi.prototype,"nativeIndex",void 0),a([c({type:String,readOnly:!0})],Pi.prototype,"deviceType",null),a([c({type:Number,readOnly:!0})],Pi.prototype,"axisThreshold",null),Pi=a([b("esri.views.input.gamepad.GamepadInputDevice")],Pi);const Km=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),Ym={standard:.15,spacemouse:.025,unknown:0},nr=Pi;let ds=class extends V{constructor(...e){super(...e),this.devices=new ee,this.enabledFocusMode="document"}};a([c({type:ee.ofType(nr),readOnly:!0})],ds.prototype,"devices",void 0),a([c({type:["document","view","none"]})],ds.prototype,"enabledFocusMode",void 0),ds=a([b("esri.views.input.gamepad.GamepadSettings")],ds);const Qm=ds;let Zs=class extends V{constructor(){super(...arguments),this.gamepad=new Qm}};a([c({readOnly:!0})],Zs.prototype,"gamepad",void 0),Zs=a([b("esri.views.input.Input")],Zs);const Jm=Zs;let zt=class extends V{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};a([c({type:Boolean,nonNullable:!0})],zt.prototype,"enabled",void 0),a([c({type:nr})],zt.prototype,"device",void 0),a([c({type:["pan","zoom"],nonNullable:!0})],zt.prototype,"mode",void 0),a([c({type:["forward-down","forward-up"],nonNullable:!0})],zt.prototype,"tiltDirection",void 0),a([c({type:Number,nonNullable:!0})],zt.prototype,"velocityFactor",void 0),zt=a([b("esri.views.navigation.gamepad.GamepadSettings")],zt);const uc=zt;let li=class extends V{constructor(e){super(e),this.browserTouchPanEnabled=!0,this.gamepad=new uc,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};a([c({type:Boolean})],li.prototype,"browserTouchPanEnabled",void 0),a([c({type:uc,nonNullable:!0})],li.prototype,"gamepad",void 0),a([c({type:Boolean})],li.prototype,"momentumEnabled",void 0),a([c({type:Boolean})],li.prototype,"mouseWheelZoomEnabled",void 0),li=a([b("esri.views.navigation.Navigation")],li);const hc=li;var Pa;function Xm(i){var s;const e=i.url?Ru(i.url):void 0;return!(((s=i.spatialReference)==null?void 0:s.vcsWkid)==null&&M(e)&&e.serverType==="ImageServer")&&pc(i)&&i.heightModelInfo?i.heightModelInfo:eg(i)?qo.deriveUnitFromSR(ig,i.spatialReference):null}function pc(i){return"heightModelInfo"in i}function mc(i){if(i.type==="unknown"||!("capabilities"in i))return!1;switch(i.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":return!0;default:return!1}}function eg(i){return mc(i)?!!(i.capabilities&&i.capabilities.data&&i.capabilities.data.supportsZ):gc(i)}function tg(i){return i.layers!=null||gc(i)||mc(i)||pc(i)}function gc(i){switch(i.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(i){i[i.Ok=0]="Ok",i[i.Units=1]="Units",i[i.HeightModel=2]="HeightModel",i[i.CRS=3]="CRS",i[i.Unsupported=4]="Unsupported"})(Pa||(Pa={}));const ig=new qo({heightModel:"gravity-related-height"});let xo,Yn=null;async function sg(i){Yn||(Yn=I(()=>import("./geometryServiceUtils-03540de6.js"),["assets/geometryServiceUtils-03540de6.js","assets/Error-4ed679d7.js","assets/string-9c5e03f7.js","assets/typedArrayUtil-d02f10a8.js","assets/Portal-95b0f852.js","assets/preload-helper-101896b7.js","assets/cast-6d78d3c7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/request-e4299080.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/Extent-d5fff12d.js","assets/locale-30120714.js","assets/PortalGroup-813428fa.js","assets/jsonMap-5afaf2ff.js","assets/PortalUser-4126c27a.js","assets/Basemap-fd6389f3.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/collectionUtils-3d8a9611.js","assets/deprecate-46fadabd.js","assets/loadAll-1ae88564.js","assets/asyncUtils-18831bb1.js","assets/PortalItem-bbd2de41.js","assets/assets-6ba3cd63.js","assets/messages-634811b5.js","assets/writeUtils-44b0e78b.js","assets/layerUtils-6996b9ea.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/compilerUtils-eefea0ec.js","assets/enumeration-497ef064.js","assets/opacityUtils-8b7acc4e.js","assets/CollectionFlattener-b89887c0.js","assets/TablesMixin-019c9675.js","assets/Layer-f9f81f65.js","assets/geometry-70b2a4a5.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/Identifiable-57df9761.js","assets/Graphic-34c50417.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/fieldUtils-2efa8993.js","assets/arcadeOnDemand-72a1843c.js","assets/number-c7f1bfee.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/screenUtils-7afeb41c.js","assets/aaBoundingBox-33fc923c.js","assets/persistableUrlUtils-d18becd9.js","assets/jsonUtils-5115c7e5.js","assets/Cyclical-1a93cb12.js","assets/reactiveUtils-b0e56010.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/Queue-8aae62d3.js","assets/intl-a5c99ea3.js","assets/projection-6146477c.js","assets/unitUtils-b69647a1.js","assets/mat4-62d5e6a4.js","assets/zscale-72b4355d.js","assets/TileInfo-92f7dc61.js","assets/aaBoundingRect-ca34962d.js","assets/widget-4becb80f.js","assets/uuid-73213768.js","assets/HandleOwner-6ac6f00a.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-710cf21c.js","assets/normalizeUtils-91a64c2b.js","assets/query-4348ce6f.js","assets/pbfQueryUtils-91f50fb5.js","assets/pbf-e4fd0249.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/queryZScale-1674984c.js","assets/FeatureSet-622e3076.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/RelationshipQuery-b5b427dc.js","assets/LegendOptions-e31ff575.js","assets/utils-cb77f8a5.js","assets/parser-f68dd732.js","assets/ItemCache-b4db8f82.js","assets/MemCache-1e028041.js","assets/jsonUtils-7ad404a7.js","assets/UniqueValueRenderer-8e382829.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-0dde2114.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js","assets/DictionaryLoader-46cd8e54.js","assets/LRUCache-4d56ba4d.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/featureConversionUtils-d9ec654e.js","assets/TopFeaturesQuery-7da1d7c1.js","assets/FeatureLayer-95c99e68.js","assets/MultiOriginJSONSupport-1970ed0f.js","assets/LayerFloorInfo-0d02c503.js","assets/FeatureLayerBase-6192846c.js","assets/HeightModelInfo-645087b5.js","assets/arcgisLayerUrl-02fe1a62.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/editsZScale-e318eb4a.js","assets/APIKeyMixin-f90cfebd.js","assets/ArcGISService-f6f32fbc.js","assets/BlendLayer-7a735871.js","assets/CustomParametersMixin-5e3018da.js","assets/EditBusLayer-1372e92b.js","assets/FeatureReductionLayer-d24025a2.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-7b3473c8.js","assets/PortalLayer-5c12bdba.js","assets/RefreshableLayer-84ec1468.js","assets/ScaleRangeLayer-c6a35aba.js","assets/TemporalLayer-ac8e2c3d.js","assets/TimeInfo-a1791ae0.js","assets/FeatureTemplate-773a8865.js","assets/FeatureType-6c50f4e3.js","assets/fieldProperties-9268e64b.js","assets/FieldsIndex-0e507864.js","assets/versionUtils-5ccafbea.js","assets/styleUtils-45e2d86c.js","assets/popupUtils-40f744cb.js","assets/mat2d-80bd93af.js","assets/Scheduler-343fdba6.js","assets/GraphicsLayer-18770580.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/vec2-f978aef8.js","assets/vec2f64-e0301652.js","assets/mat3-45e3f2eb.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/TileKey-ed432ae5.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/capabilities-5736b16f.js","assets/context-util-abf86a85.js","assets/datetime-7cb5ae9e.js"]).then(e=>xo=e)),await Yn,Kt(i)}async function fc(i,e,t,s){if(!i)return null;const n=i.spatialReference;return vs()||yn(n,e)?Cs(i,e):xo?xo.projectGeometry(i,e,t,s):(await Promise.race([sg(s),vn(s)]),fc(i,e,t,s))}let q=class extends V{constructor(e){super(e),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=ao(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return M(this.userSpatialReference)?this.userSpatialReference:Ve(this._spatialReferenceTask.spatialReference)}get extent(){return Ve(this._extentTask.extent)}get heightModelInfo(){return Ve(this._heightModelInfoTask.heightModelInfo)}get vcsWkid(){return Ve(this._heightModelInfoTask.vcsWkid)}get latestVcsWkid(){return Ve(this._heightModelInfoTask.latestVcsWkid)}get viewingMode(){return F(this.userSpatialReference)||this.userSpatialReference.equals(Ve(this._spatialReferenceTask.spatialReference))?Ve(this._spatialReferenceTask.viewingMode):null}get tileInfo(){return Ve(this._tileInfoTask.tileInfo)}get mapCollections(){var s,n,o,r;const e=(s=this.map)==null?void 0:s.call(this),t=[];return M(this.priorityCollection)&&t.push(this.priorityCollection),t.push({parent:e==null?void 0:e.basemap,layers:(n=e==null?void 0:e.basemap)==null?void 0:n.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(o=e==null?void 0:e.ground)==null?void 0:o.layers},{parent:e==null?void 0:e.basemap,layers:(r=e==null?void 0:e.basemap)==null?void 0:r.referenceLayers}),t}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;let s=null;for(const o of e){const r=this._getSupportedSpatialReferences(o);if(r.length>0){const l=this._narrowDownSpatialReferenceCandidates(s,r);M(l)&&(s=l)}if(M(s)&&s.length===1)break}if(t&&(F(s)||s.length!==1))return{updating:!0};const n=this._pickSpatialReferenceCandidate(s);return{spatialReference:M(n)?n.spatialReference:null,viewingMode:M(n)?n.viewingMode:null,updating:!1}}get _tileInfoTask(){var s,n,o,r,l,d,u;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:e,updating:t}=this._collectLayers([{parent:(n=(s=this.map)==null?void 0:s.call(this))==null?void 0:n.basemap,layers:(l=(r=(o=this.map)==null?void 0:o.call(this))==null?void 0:r.basemap)==null?void 0:l.baseLayers},{layers:(u=(d=this.map)==null?void 0:d.call(this))==null?void 0:u.layers}]);if(e&&e.length>0&&"tileInfo"in e[0]){const h=e[0].tileInfo;return{tileInfo:h&&h.spatialReference.equals(this.spatialReference)?h:null,updating:!1}}return{updating:t}}get _heightModelInfoTask(){var s,n,o;if(!this.required.heightModelInfo||this.suspended&&((s=this._get("_heightModelInfoTask"))!=null&&s.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:e,updating:t}=this._allLayers;for(const r of e)if(tg(r)){const l=Xm(r);if(l)return{heightModelInfo:l,vcsWkid:(n=r.spatialReference)==null?void 0:n.vcsWkid,latestVcsWkid:(o=r.spatialReference)==null?void 0:o.latestVcsWkid,updating:!1}}return{updating:t}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=this._allLayers,t=e.updating,s=[];for(const n of e.layers){const o="fullExtents"in n&&n.fullExtents||(M(n.fullExtent)?[n.fullExtent]:[]),r=this.requiresExtentInSpatialReference?null:o[0],l=o.find(d=>d.spatialReference.equals(this.spatialReference))??r;if(l)return{candidates:[{extent:l,layer:n}],updating:!1};if(this._getSupportedSpatialReferences(n).length>0)for(const d of o)s.push({extent:d,layer:n})}return{candidates:s,updating:t}}get _extentTask(){const{candidates:e,updating:t}=this._extentCandidatesTask;if(t)return{updating:t};if(F(e)||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const s=this._pickExtentCandidate(e),n=this.spatialReference;return s.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:M(this._projectExtentTask.task)&&!this._projectExtentTask.task.finished}:(M(this._projectExtentTask.task)&&(this._projectExtentTask.task=ao(this._projectExtentTask.task)),this._projectExtentTask={input:s.extent.clone(),output:null,spatialReference:n.clone(),task:xl(async o=>{try{const r=await fc(s.extent,n,s.layer.portalItem,o);this._projectExtentTask={...this._projectExtentTask,task:null,output:r}}catch{if(pd(o))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,t){if(F(e))return t;const s=[],n=(o,r)=>M(o)?M(r)?o===r&&o:o:r;for(const o of e)for(const r of t){if(!o.spatialReference.equals(r.spatialReference))continue;const l=n(o.viewingMode,r.viewingMode);if(l!==!1){s.push({spatialReference:o.spatialReference,viewingMode:l});break}}return s.length>0?s:null}_pickSpatialReferenceCandidate(e){const t=this.defaultSpatialReference;return F(e)||e.length<1?M(t)?{spatialReference:t,viewingMode:null}:null:(M(t)&&e.length>1&&e.some(({spatialReference:s})=>s.equals(t))&&(e=e.filter(({spatialReference:s})=>s.equals(t))),e.length>1&&e.some(({viewingMode:s})=>s!==xr.Local)&&(e=e.filter(({viewingMode:s})=>s!==xr.Local)),e[0])}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(t.length===0)return[];const s=[];for(const n of t){const o=this.getSpatialReferenceSupport({spatialReference:n,layer:e});if(M(o)){const r=M(o.constraints)?o.constraints:[{spatialReference:n,viewingMode:null}];for(const{spatialReference:l,viewingMode:d}of r)(!this.requiresExtentInSpatialReference||F(this.userSpatialReference)||l.equals(this.userSpatialReference))&&s.push({spatialReference:l,viewingMode:d})}}return s}_pickExtentCandidate(e){const t=this.spatialReference;return e.find(({extent:s})=>t.equals(s.spatialReference))||e[0]}_collectLayers(e){var s;if(this._loadMaybe((s=this.map)==null?void 0:s.call(this))!=="loaded")return{layers:[],updating:!0};const t={layers:[],preloading:-1,updating:!1};for(const n of e)if(this._collectCollection(n,t),t.preloading===this.sourcePreloadCount)break;return{layers:t.layers,updating:t.updating}}_collectCollection(e,t){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return t.updating=!0,void++t.preloading;case"failed":return}for(const s of e.layers){switch(this._loadMaybe(s)){case"failed":continue;case"loading":t.updating=!0,++t.preloading;break;case"loaded":t.updating||t.layers.push(s),"layers"in s&&this._collectCollection({layers:s.layers},t)}if(t.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e?e.loadStatus==="not-loaded"?(e.load().catch(()=>{}),"loading"):e.loadStatus:"loaded"}};a([c()],q.prototype,"required",void 0),a([c({constructOnly:!0})],q.prototype,"map",void 0),a([c({constructOnly:!0})],q.prototype,"getSpatialReferenceSupport",void 0),a([c()],q.prototype,"defaultSpatialReference",void 0),a([c()],q.prototype,"userSpatialReference",void 0),a([c()],q.prototype,"sourcePreloadCount",void 0),a([c()],q.prototype,"priorityCollection",void 0),a([c()],q.prototype,"requiresExtentInSpatialReference",void 0),a([c()],q.prototype,"suspended",void 0),a([c({readOnly:!0})],q.prototype,"ready",null),a([c({readOnly:!0})],q.prototype,"heightModelInfoReady",null),a([c({readOnly:!0})],q.prototype,"spatialReference",null),a([c({readOnly:!0})],q.prototype,"extent",null),a([c({readOnly:!0})],q.prototype,"heightModelInfo",null),a([c({readOnly:!0})],q.prototype,"vcsWkid",null),a([c({readOnly:!0})],q.prototype,"latestVcsWkid",null),a([c({readOnly:!0})],q.prototype,"viewingMode",null),a([c({readOnly:!0})],q.prototype,"tileInfo",null),a([c({readOnly:!0})],q.prototype,"mapCollections",null),a([c({readOnly:!0})],q.prototype,"_allLayers",null),a([c({readOnly:!0})],q.prototype,"_spatialReferenceTask",null),a([c({readOnly:!0})],q.prototype,"_tileInfoTask",null),a([c({readOnly:!0})],q.prototype,"_heightModelInfoTask",null),a([c({readOnly:!0})],q.prototype,"_extentCandidatesTask",null),a([c()],q.prototype,"_extentTask",null),a([c()],q.prototype,"_projectExtentTask",void 0),q=a([b("esri.views.support.DefaultsFromMap")],q);var Ks;let S=Ks=class extends wn(qi.EventedMixin(Au(V))){constructor(i){super(i),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new sn({getCollections:()=>{var e,t,s;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(t=this.groundView)==null?void 0:t.layerViews,this.layerViews,(s=this.basemapView)==null?void 0:s.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new kl,this.analyses=new mn,this.typeSpecificPreconditionsReady=!0,this.layerViews=new ee,this.magnifier=new rc,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new Jm,this.navigation=new hc,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new Hm(this),this.persistableViewModels=new ee,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(v(()=>this.preconditionsReady,e=>{var t,s;e?(this._currentSpatialReference=this.spatialReference,Ks.views.add(this)):(this._currentSpatialReference=null,Ks.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?((t=this.toolViewManager)==null||t.detach(),M(this.analysisViewManager)&&this.analysisViewManager.detach(),(s=this.layerViewManager)==null||s.clear(),this._teardown()):e&&!this.ready&&(this._startup(),M(this.analysisViewManager)&&this.analysisViewManager.attach(),this.toolViewManager.attach())},ys))}initialize(){this.addResolvingPromise(this.validate().then(()=>(this._isValid=!0,zo(()=>this.ready)))),this.basemapView=new Nt({view:this}),this.layerViewManager=new Bm({view:this,layerViewImporter:{importLayerView:i=>this.importLayerView(i),hasLayerViewModule:i=>this.hasLayerViewModule(i)},supportsGround:this.supportsGround}),this.toolViewManager=new Zm({view:this}),this._setupSpatialReferenceLogger(),this.handles.add([v(()=>this.initialExtentRequired,i=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:i},{sync:!0,initial:!0}),v(()=>this.ready,i=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=i,this.defaultsFromMap.userSpatialReference=i?this.spatialReference:this._userSpatialReference)},{sync:!0}),v(()=>this._userSpatialReference,i=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=i)},{sync:!0,initial:!0})])}_setupSpatialReferenceLogger(){let i=null;this.handles.add([v(()=>{var e;return(e=this.defaultsFromMap)==null?void 0:e.ready},e=>{var s;const t=((s=this.map)==null?void 0:s.allLayers.length)>0;if(e&&!this.spatialReference&&t){if(M(i))return;const n=tl(()=>i=ao(i));i=xl(async o=>{try{await Vo(this.spatialReferenceWarningDelay,null,o)}catch{return}finally{i=null}N.getLogger(this.declaredClass).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.handles.add(n,"spatial-reference-logger-task")}else this.handles.remove("spatial-reference-logger-task")},{sync:!0})])}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=Ee(this.graphics),this.analyses=Ee(this.analyses),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),Ee(this.analysisViewManager),this.toolViewManager=Ee(this.toolViewManager),this.layerViewManager=Ee(this.layerViewManager),this.basemapView=Ee(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const i=this.map;this.map=null,i==null||i.destroy()}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return N.getLogger(this.declaredClass).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var i;return(i=this.toolViewManager)==null?void 0:i.activeTool}set activeTool(i){this.toolViewManager&&(this.toolViewManager.activeTool=i)}get animation(){return this._get("animation")}set animation(i){this._set("animation",i)}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new q({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:i=>this.getSpatialReferenceSupport(i),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(i){this._set("extent",i)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var i;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||ro.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._currentSpatialReference&&!((i=this.defaultsFromMap)!=null&&i.ready)||!this.typeSpecificPreconditionsReady)}set map(i){i!==this._get("map")&&(i!=null&&i.destroyed&&(N.getLogger(this.declaredClass).warn("#map","The provided map is already destroyed",{map:i}),i=null),ro.isLoadable(i)&&i.load().catch(()=>{}),this.constructed&&(this.forceReadyCycle(),this._currentSpatialReference=null),this._set("map",i))}get spatialReference(){var e,t;let i=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return i&&((t=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&t.heightModelInfo)&&(i=i.clone(),i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),i}set spatialReference(i){const e=!_n(i,this._get("spatialReference"));this._set("_userSpatialReference",i),e&&(this._set("spatialReference",i),this._spatialReferenceChanged(i))}_spatialReferenceChanged(i){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get tools(){var i;return(i=this.toolViewManager)==null?void 0:i.tools}get initialExtent(){var i;return(i=this.defaultsFromMap)==null?void 0:i.extent}get cursor(){const i=this.toolViewManager?this.toolViewManager.cursor:null;return M(i)?i:this._cursor||"default"}set cursor(i){this._cursor=i,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(i){return this.layerViewManager.whenLayerView(i)}getDefaultSpatialReference(){var i;return(i=this.defaultsFromMap)==null?void 0:i.spatialReference}getDefaultHeightModelInfo(){var i;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((i=this.defaultsFromMap)==null?void 0:i.heightModelInfo)??null}importLayerView(i){throw new k("importLayerView() not implemented")}hasLayerViewModule(i){return!1}async validate(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(i){return M(this.getSpatialReferenceSupport({spatialReference:i}))}when(i,e){return this.isResolved()&&!this.ready&&N.getLogger(this.declaredClass).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(i,e)}forceReadyCycle(){this.ready&&(At(()=>this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(i){this.toolViewManager.tools.add(i),this.activeTool=i}tryFatalErrorRecovery(){this.fatalError=null}};S.views=new ee,a([c()],S.prototype,"_userSpatialReference",void 0),a([c()],S.prototype,"activeTool",null),a([c({readOnly:!0})],S.prototype,"allLayerViews",void 0),a([c()],S.prototype,"groundView",void 0),a([c()],S.prototype,"animation",null),a([c()],S.prototype,"basemapView",void 0),a([c({readOnly:!0})],S.prototype,"_defaultsFromMapSettings",null),a([c()],S.prototype,"defaultsFromMap",null),a([c()],S.prototype,"fatalError",void 0),a([c({type:Gi})],S.prototype,"extent",null),a([c(Er(kl,"graphics"))],S.prototype,"graphics",void 0),a([c(Er(mn,"analyses"))],S.prototype,"analyses",void 0),a([c({readOnly:!0,type:qo})],S.prototype,"heightModelInfo",null),a([c({readOnly:!0})],S.prototype,"interacting",null),a([c({readOnly:!0})],S.prototype,"navigating",null),a([c({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],S.prototype,"preconditionsReady",null),a([c({readOnly:!0})],S.prototype,"typeSpecificPreconditionsReady",void 0),a([c({type:ee,readOnly:!0})],S.prototype,"layerViews",void 0),a([c({type:rc})],S.prototype,"magnifier",void 0),a([c({value:null,type:Dl})],S.prototype,"map",null),a([c()],S.prototype,"padding",void 0),a([c({readOnly:!0})],S.prototype,"ready",void 0),a([c({type:Is})],S.prototype,"spatialReference",null),a([c()],S.prototype,"spatialReferenceWarningDelay",void 0),a([c()],S.prototype,"stationary",null),a([c({readOnly:!0})],S.prototype,"supportsGround",void 0),a([c({type:xu})],S.prototype,"timeExtent",void 0),a([c()],S.prototype,"tools",null),a([c()],S.prototype,"toolViewManager",void 0),a([c({readOnly:!0})],S.prototype,"type",void 0),a([c({type:Number})],S.prototype,"scale",void 0),a([c({readOnly:!0})],S.prototype,"updating",void 0),a([c({readOnly:!0})],S.prototype,"initialExtentRequired",void 0),a([c({readOnly:!0})],S.prototype,"initialExtent",null),a([c()],S.prototype,"cursor",null),a([c({readOnly:!0})],S.prototype,"input",void 0),a([c({type:hc,nonNullable:!0})],S.prototype,"navigation",void 0),a([c()],S.prototype,"layerViewManager",void 0),a([c()],S.prototype,"analysisViewManager",void 0),a([c()],S.prototype,"width",void 0),a([c()],S.prototype,"height",void 0),a([c({readOnly:!0})],S.prototype,"resizing",void 0),a([c({value:null,readOnly:!0})],S.prototype,"size",null),a([c({readOnly:!0})],S.prototype,"suspended",void 0),a([c({readOnly:!0})],S.prototype,"viewEvents",void 0),a([c({readOnly:!0})],S.prototype,"persistableViewModels",void 0),a([c()],S.prototype,"_isValid",void 0),a([c()],S.prototype,"_readyCycleForced",void 0),a([c()],S.prototype,"_currentSpatialReference",void 0),S=Ks=a([b("esri.views.View")],S);const ng=S;let Bt=class extends Pu{constructor(e){super(e),this.state="running",this.target=null,this._dfd=null}initialize(){this.addResolvingPromise(new Promise((e,t)=>this._dfd={resolve:e,reject:t}))}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._dfd)==null||e.reject(new k("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._dfd)==null||e.resolve())}update(e,t){t||(t=md(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",t)}};a([c({readOnly:!0})],Bt.prototype,"done",null),a([c({readOnly:!0,type:String})],Bt.prototype,"state",void 0),a([c()],Bt.prototype,"target",void 0),Bt=a([b("esri.views.ViewAnimation")],Bt),function(i){i.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(Bt||(Bt={}));const ko=Bt;function Qt(){return[1,0,0,1,0,0]}function og(i){return[i[0],i[1],i[2],i[3],i[4],i[5]]}function rg(i,e,t,s,n,o){return[i,e,t,s,n,o]}function ag(i,e){return new Float64Array(i,e,6)}Object.freeze(Object.defineProperty({__proto__:null,create:Qt,clone:og,fromValues:rg,createView:ag},Symbol.toStringTag,{value:"Module"}));const _c=96,yc=39.37,lg=180/Math.PI;function vc(i){return i.wkid?i:i.spatialReference||Is.WGS84}function or(i,e){return e.type?ye(i,e.x,e.y):an(i,e)}function wc(i){return Gd(i)}function _s(i,e){const t=Math.max(1,e[0]),s=Math.max(1,e[1]);return Math.max(i.width/t,i.height/s)*_g(i.spatialReference)}async function us(i,e,t,s){let n,o;if(!i||Array.isArray(i)&&!i.length)return null;if(ee.isCollection(i)&&(i=i.toArray()),Array.isArray(i)&&i.length&&typeof i[0]=="object"){const l=i.every(h=>"attributes"in h),d=i.some(h=>!h.geometry);let u=i;if(l&&d&&e&&e.allLayerViews){const h=new Map;for(const _ of i){const T=_.layer,w=h.get(T)||[],E=_.attributes[T.objectIdField];E!=null&&w.push(E),h.set(T,w)}const p=[];h.forEach((_,T)=>{const w=e.allLayerViews.find(E=>E.layer.id===T.id);if("queryFeatures"in w){const E=T.createQuery();E.objectIds=_,E.returnGeometry=!0,p.push(w.queryFeatures(E))}});const g=await Promise.all(p),f=[];for(const _ of g)if(_&&_.features&&_.features.length)for(const T of _.features)M(T.geometry)&&f.push(T.geometry);u=f}for(const h of u)s=await us(h,e,t,s);return s}if(Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number")n=new X(i);else if(i instanceof _d)n=i;else if("geometry"in i){if(i.geometry)n=i.geometry;else if(i.layer){const l=i.layer,d=e.allLayerViews.find(u=>u.layer.id===l.id);if("queryFeatures"in d){const u=l.createQuery();u.objectIds=[i.attributes[l.objectIdField]],u.returnGeometry=!0;const h=await d.queryFeatures(u);n=Cd(h,"features",0,"geometry")}}}if(F(n)||(o=n.type==="point"?new Gi({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference}):n.extent,!o))return null;vs()||yn(o.spatialReference,t)||await vn();const r=Cs(o,t);return r?s=s?s.union(r):r:null}function cg(i){if(i&&(!Array.isArray(i)||typeof i[0]!="number")&&(typeof i=="object"||Array.isArray(i)&&typeof i[0]=="object")){if("layer"in i&&i.layer&&i.layer.minScale&&i.layer.maxScale){const e=i.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(i)&&i.length&&i.every(e=>"layer"in e)){let e=0,t=0;for(const s of i){const n=s.layer;n&&n.minScale&&n.maxScale&&(e=n.minScale<e?n.minScale:e,t=n.maxScale>t?n.maxScale:t)}return e&&t?{min:e,max:t}:null}}}function Qn(i,e){return _n(vc(i),e)?i:Cs(i,e)}async function dg(i,e){if(!i||!e)return new We({targetGeometry:new X,scale:0,rotation:0});let t=e.spatialReference;const{constraints:s,padding:n,viewpoint:o,size:r}=e,l=[n?r[0]-n.left-n.right:r[0],n?r[1]-n.top-n.bottom:r[1]];let d=null;i instanceof We?d=i:i.viewpoint?d=i.viewpoint:i.target&&i.target.declaredClass==="esri.Viewpoint"&&(d=i.target);let u=null;d&&d.targetGeometry?u=d.targetGeometry:i instanceof Gi?u=i:(i||i&&("center"in i||"extent"in i||"target"in i))&&(u=await us(i.center,e,t)||await us(i.extent,e,t)||await us(i.target,e,t)||await us(i,e,t)),!u&&o&&o.targetGeometry?u=o.targetGeometry:!u&&e.extent&&(u=e.extent),t||(t=vc(e.spatialReference||e.extent||u)),vs()||_n(u.spatialReference,t)||yn(u,t)||await vn();const h=Qn(u.center?u.center:u,t);let p=null;if(d&&M(d.targetGeometry)&&d.targetGeometry.type==="point")p=d.scale;else if("scale"in i&&i.scale)p=i.scale;else if("zoom"in i&&i.zoom!==-1&&s&&s.effectiveLODs)p=s.zoomToScale(i.zoom);else if(Array.isArray(u)||u.type==="point"||u.type==="extent"&&u.width===0&&u.height===0){const T=Qn(e.extent,t);p=M(T)?_s(T,l):e.extent?_s(e.extent,l):o.scale}else p=_s(Qn(u.extent,t),l);const g=cg(i);g&&(g.min&&g.min>p?p=g.min:g.max&&g.max<p&&(p=g.max));let f=0;d?f=d.rotation:i.hasOwnProperty("rotation")?f=i.rotation:o&&(f=o.rotation);let _=new We({targetGeometry:h,scale:p,rotation:f});return s&&(_=s.fit(_),s.constrainByGeometry(_),s.rotationEnabled||(_.rotation=f)),_}function Ye(i,e){const t=i.targetGeometry,s=e.targetGeometry;return t.x=s.x,t.y=s.y,t.spatialReference=s.spatialReference,i.scale=e.scale,i.rotation=e.rotation,i}function ug(i,e,t){return t?ye(i,.5*(e[0]-t.right+t.left),.5*(e[1]-t.bottom+t.top)):bn(i,e,.5)}const hg=function(){const i=he();return function(e,t,s){const n=t.targetGeometry;or(i,n);const o=.5*Wi(t);return e.xmin=i[0]-o*s[0],e.ymin=i[1]-o*s[1],e.xmax=i[0]+o*s[0],e.ymax=i[1]+o*s[1],e.spatialReference=n.spatialReference,e}}();function pg(i,e,t,s,n){return Ao(i,e,t.center),i.scale=_s(t,s),n&&n.constraints&&n.constraints.constrain(i),i}function mg(i,e,t,s){return lr(i,e,t,s),El(i,i)}const bc=function(){const i=he();return function(e,t,s){return Pl(e,yg(e,t),ug(i,t,s))}}(),gg=function(){const i=Qt(),e=he();return function(t,s,n,o){const r=Wi(s),l=rr(s);return ye(e,r,r),Mu(i,e),Go(i,i,l),rn(i,i,bc(e,n,o)),rn(i,i,[0,o.top-o.bottom]),ye(t,i[4],i[5])}}();function Wi(i){return i.scale*fg(i.targetGeometry)}function fg(i){return M(i)&&ol(i.spatialReference)?1/(wc(i.spatialReference)*yc*_c):1}function rr(i){return Al(i.rotation)||0}function _g(i){return ol(i)?wc(i)*yc*_c:1}function yg(i,e){return bn(i,e,.5)}const ar=function(){const i=he(),e=he(),t=he();return function(s,n,o,r,l,d){return Du(i,n),bn(e,o,.5*d),ye(t,1/r*d,-1/r*d),Tl(s,e),l&&Go(s,s,l),Cl(s,s,t),rn(s,s,i),s}}(),lr=function(){const i=he();return function(e,t,s,n){const o=Wi(t),r=rr(t);return or(i,t.targetGeometry),ar(e,i,s,o,r,n)}}(),vg=function(){const i=he();return function(e,t,s,n){const o=Wi(t);return or(i,t.targetGeometry),ar(e,i,s,o,0,n)}}();function wg(i){const e=rl(i);return e?e.valid[1]-e.valid[0]:0}function bg(i,e){return Math.round(wg(i)/e)}const Mg=function(){const i=he(),e=he(),t=[0,0,0];return function(s,n,o){ho(i,s,n),kr(i,i),ho(e,s,o),kr(e,e),Fu(t,i,e);let r=Math.acos(Ou(i,e)/(Ar(i)*Ar(e)))*lg;return t[2]<0&&(r=-r),isNaN(r)&&(r=0),r}}(),Ig=function(){const i=he();return function(e,t,s,n){const o=e.targetGeometry;return Ye(e,t),gg(i,t,s,n),o.x+=i[0],o.y+=i[1],e}}(),Ao=function(i,e,t){Ye(i,e);const s=i.targetGeometry;return s.x=t.x,s.y=t.y,s.spatialReference=t.spatialReference,i},Cg=function(){const i=he();return function(e,t,s,n,o){o||(o="center"),Pl(i,s,n),bn(i,i,.5);const r=i[0],l=i[1];switch(o){case"center":ye(i,0,0);break;case"left":ye(i,-r,0);break;case"top":ye(i,0,l);break;case"right":ye(i,r,0);break;case"bottom":ye(i,0,-l);break;case"top-left":ye(i,-r,l);break;case"bottom-left":ye(i,-r,-l);break;case"top-right":ye(i,r,l);break;case"bottom-right":ye(i,r,-l)}return kn(e,t,i),e}}();function Lb(i,e,t){return Ye(i,e),i.rotation+=t,i}function Tg(i,e,t){return Ye(i,e),i.rotation=t,i}const Eg=function(){const i=he();return function(e,t,s,n,o){return Ye(e,t),isNaN(s)||s===0||(Ic(i,n,t,o),e.scale=t.scale*s,Cc(i,i,e,o),kn(e,e,ye(i,i[0]-n[0],n[1]-i[1]))),e}}();function $a(i,e,t){return Ye(i,e),i.scale=t,i}const Mc=function(){const i=he();return function(e,t,s,n,o,r){return Ye(e,t),isNaN(s)||s===0||(Ic(i,o,t,r),e.scale=t.scale*s,e.rotation+=n,Cc(i,i,e,r),kn(e,e,ye(i,i[0]-o[0],o[1]-i[1]))),e}}(),Fb=function(){const i=he(),e=he();return function(t,s,n,o,r,l,d){return bc(e,l,d),Vu(i,r,e),o?Mc(t,s,n,o,i,l):Eg(t,s,n,i,l)}}(),Ic=function(){const i=Qt();return function(e,t,s,n){return Ct(e,t,mg(i,s,n,1))}}(),Cc=function(){const i=Qt();return function(e,t,s,n){return Ct(e,t,lr(i,s,n,1))}}(),kn=function(){const i=he(),e=Qt();return function(t,s,n){Ye(t,s);const o=Wi(s),r=t.targetGeometry;return bu(e,rr(s)),Cl(e,e,zu(o,o)),Ct(i,n,e),r.x+=i[0],r.y+=i[1],t}}();let xg=class{constructor(e,t,s,n){const o=e.targetGeometry,r=t.targetGeometry;n?typeof n=="string"&&(n=Lu(n)||uo.ease):n=uo.ease,this.easing=n,this.duration=s,this.sCenterX=o.x,this.sCenterY=o.y,this.sScale=e.scale,this.sRotation=e.rotation,this.tCenterX=r.x,this.tCenterY=r.y,this.tScale=t.scale,this.tRotation=t.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(e,t){const s=this.easing(t);let n,o,r,l;t>=1?(n=this.tCenterX,o=this.tCenterY,r=this.tRotation,l=this.tScale):(n=this.sCenterX+s*this.dCenterX,o=this.sCenterY+s*this.dCenterY,r=this.sRotation+s*this.dRotation,l=this.sScale+s*this.dScale),e.targetGeometry.x=n,e.targetGeometry.y=o,e.scale=l,e.rotation=r}},wt=class extends V{constructor(e){super(e),this.duration=200,this.transition=null,this.easing=uo.ease,this.view=null,this.viewpoint=null,this.viewpoint=new We({targetGeometry:new X,scale:0,rotation:0}),this._updateTask=Bi({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask.remove(),this._updateTask=null}animate(e,t,s){this.stop();const n=this.viewpoint;Ye(n,t),this.transition=new xg(this.viewpoint,e.target,s&&s.duration||this.duration,s&&s.easing||this.easing);const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinous(e,t){this.stop(),this.updateFunction=t,this.viewpoint=e;const s=new ko({target:e.clone()}),n=()=>{this.animation===s&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return s.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=s,s}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){const t=this.animation;if(t&&t.state!==ko.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime);else{const s=(performance.now()-this._startTime)/this.transition.duration,n=s>=1;this.transition.applyRatio(this.viewpoint,s),n&&this.animation.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};a([c()],wt.prototype,"animation",void 0),a([c()],wt.prototype,"duration",void 0),a([c()],wt.prototype,"transition",void 0),a([c()],wt.prototype,"easing",void 0),a([c()],wt.prototype,"view",void 0),a([c()],wt.prototype,"viewpoint",void 0),wt=a([b("esri.views.2d.AnimationManager")],wt);const kg=wt;let Ag=class{constructor(e){this.view=e,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{this._updateRequested=!1;const{basemapView:t,graphicsView:s,labelManager:n,layerViews:o,state:{id:r}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),o.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),M(n)&&(n.lastUpdateId!==r&&(n.viewChange(),n.lastUpdateId=r),n.updateRequested&&n.processUpdate(this._updateParameters)),M(s)&&(s.lastUpdateId!==r&&(s.viewChange(),s.lastUpdateId=r),s.updateRequested&&s.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=v(()=>e.stationary,t=>{this.stationary=t,this.requestFrame()}),this._frameTaskHandle=Bi(this),this.requestUpdate()}stop(){this._frameTaskHandle&&(this._updateRequested=!1,this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){const t=this.view.state,s=e.lastUpdateId;s!=null&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),s!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this)}};function ae(){return Promise.all([I(()=>import("./webglDeps-2d5668fb.js"),["assets/webglDeps-2d5668fb.js","assets/VertexArrayObject-e1e46e3f.js","assets/Error-4ed679d7.js","assets/string-9c5e03f7.js","assets/typedArrayUtil-d02f10a8.js","assets/Texture-c2297638.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/context-util-abf86a85.js","assets/enums-64ab819c.js","assets/ProgramTemplate-1afb8353.js","assets/programUtils-fb70f3b3.js"]),I(()=>import("./mapViewDeps-6709a1e1.js"),["assets/mapViewDeps-6709a1e1.js","assets/Error-4ed679d7.js","assets/string-9c5e03f7.js","assets/typedArrayUtil-d02f10a8.js","assets/promiseUtils-930cba29.js","assets/reactiveUtils-b0e56010.js","assets/cast-6d78d3c7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/mat3f32-d3d088e8.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-418e9de0.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/common-701a4199.js","assets/Evented-b378ccab.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/mathUtils-daf59e84.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-b7b9e6bb.js","assets/BufferPool-b738111d.js","assets/WGLContainer-69c7e591.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-a3529416.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-e1e46e3f.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/jsonUtils-5115c7e5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/enums-bfc9e4e9.js","assets/programUtils-fb70f3b3.js","assets/RenderingContext-b8526b4a.js","assets/OrderIndependentTransparency-602f26c2.js","assets/floatRGBA-305df8f3.js","assets/ExpandedCIM-6cfcc2f7.js","assets/arcadeOnDemand-72a1843c.js","assets/geometry-70b2a4a5.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/rasterizingUtils-18039619.js","assets/pbf-e4fd0249.js","assets/Matcher-3b379faa.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/TileKey-ed432ae5.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/enumeration-497ef064.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/Clonable-58355d3c.js","assets/visualVariablesUtils-9310c846.js","assets/visualVariablesUtils-4833b8d3.js","assets/tileUtils-23b52606.js","assets/TileClipper-48ccb501.js","assets/assets-6ba3cd63.js","assets/Geometry-daada628.js","assets/defaultsJSON-b087dd4d.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/devEnvironmentUtils-5002a058.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/locale-30120714.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/persistableUrlUtils-d18becd9.js","assets/styleUtils-cde65ff5.js","assets/CircularArray-ace048ef.js","assets/imageUtils-c2d0d1ae.js","assets/HandleOwner-6ac6f00a.js","assets/FeatureSetReader-9e0a2b1d.js","assets/centroid-7800ee74.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/sizeVariableUtils-d4870b0d.js","assets/BaseGraphicContainer-dfe82663.js","assets/normalizeUtilsSync-1f26dd3f.js","assets/normalizeUtils-91a64c2b.js","assets/projectionSupport-38cc9dc5.js","assets/projection-6146477c.js","assets/SimpleObservable-e0897cc6.js","assets/zscale-72b4355d.js","assets/json-48e3ea08.js","assets/labelingInfo-69496ac8.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/fieldUtils-2efa8993.js","assets/Symbol-1bb07043.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/Collection-42fe629f.js","assets/collectionUtils-3d8a9611.js","assets/labelUtils-87bb22ff.js","assets/jsonUtils-c8fbfbd0.js","assets/FeatureContainer-e4e1ed67.js","assets/TileContainer-efb37002.js","assets/capabilities-5736b16f.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/diffUtils-713e5c9b.js","assets/createSymbolSchema-976acefa.js","assets/rendererUtils-a093890e.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/PopupTemplate-29fe62b5.js","assets/number-c7f1bfee.js","assets/Identifiable-57df9761.js","assets/UniqueValueRenderer-8e382829.js","assets/LegendOptions-e31ff575.js","assets/colorRamps-c00f504b.js","assets/Graphic-34c50417.js","assets/compilerUtils-eefea0ec.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/deprecate-46fadabd.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/util-94bdf933.js","assets/ComputedAttributeStorage-85833802.js","assets/FieldsIndex-0e507864.js","assets/vec3f32-4322908d.js","assets/GraphicContainer-ec6d8bc9.js","assets/asyncUtils-18831bb1.js","assets/requestImageUtils-2fafd053.js","assets/Basemap-fd6389f3.js","assets/loadAll-1ae88564.js","assets/PortalItem-bbd2de41.js","assets/messages-634811b5.js","assets/writeUtils-44b0e78b.js","assets/layerUtils-6996b9ea.js","assets/CollectionFlattener-b89887c0.js","assets/TablesMixin-019c9675.js","assets/Layer-f9f81f65.js","assets/Cyclical-1a93cb12.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/intl-a5c99ea3.js","assets/TileInfo-92f7dc61.js","assets/widget-4becb80f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-710cf21c.js","assets/query-4348ce6f.js","assets/pbfQueryUtils-91f50fb5.js","assets/queryZScale-1674984c.js","assets/FeatureSet-622e3076.js","assets/RelationshipQuery-b5b427dc.js","assets/utils-cb77f8a5.js","assets/ItemCache-b4db8f82.js","assets/TopFeaturesQuery-7da1d7c1.js","assets/FeatureLayer-95c99e68.js","assets/MultiOriginJSONSupport-1970ed0f.js","assets/FeatureLayerBase-6192846c.js","assets/HeightModelInfo-645087b5.js","assets/arcgisLayerUrl-02fe1a62.js","assets/editsZScale-e318eb4a.js","assets/APIKeyMixin-f90cfebd.js","assets/ArcGISService-f6f32fbc.js","assets/CustomParametersMixin-5e3018da.js","assets/EditBusLayer-1372e92b.js","assets/OrderedLayer-7b3473c8.js","assets/PortalLayer-5c12bdba.js","assets/RefreshableLayer-84ec1468.js","assets/ScaleRangeLayer-c6a35aba.js","assets/TemporalLayer-ac8e2c3d.js","assets/TimeInfo-a1791ae0.js","assets/FeatureTemplate-773a8865.js","assets/FeatureType-6c50f4e3.js","assets/fieldProperties-9268e64b.js","assets/versionUtils-5ccafbea.js","assets/styleUtils-45e2d86c.js","assets/popupUtils-40f744cb.js","assets/Scheduler-343fdba6.js","assets/GraphicsLayer-18770580.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/datetime-7cb5ae9e.js"])])}const Ji=()=>ae().then(()=>I(()=>import("./TileLayerView2D-a2cd784c.js"),["assets/TileLayerView2D-a2cd784c.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/reactiveUtils-b0e56010.js","assets/Extent-d5fff12d.js","assets/imageUtils-f5c68deb.js","assets/BitmapTileContainer-f80c60ba.js","assets/aaBoundingRect-ca34962d.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/mat3f32-d3d088e8.js","assets/Bitmap-b5446edf.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-b378ccab.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-b7b9e6bb.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/WGLContainer-69c7e591.js","assets/pixelUtils-a3529416.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-e1e46e3f.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/jsonUtils-5115c7e5.js","assets/Polyline-42dcc920.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/Collection-42fe629f.js","assets/SimpleObservable-e0897cc6.js","assets/collectionUtils-3d8a9611.js","assets/geometry-70b2a4a5.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/HandleOwner-6ac6f00a.js","assets/Identifiable-57df9761.js","assets/Promise-6bd0b483.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/enumeration-497ef064.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/Clonable-58355d3c.js","assets/TileStrategy-40f1ecb0.js","assets/RefreshableLayerView-6d197c7a.js","assets/drapedUtils-06632e8a.js","assets/unitUtils-b69647a1.js"])),Xi=()=>ae().then(()=>I(()=>import("./FeatureLayerView2D-68b28637.js"),["assets/FeatureLayerView2D-68b28637.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Graphic-34c50417.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/reactiveUtils-b0e56010.js","assets/utils-1bc9587b.js","assets/mat3f32-d3d088e8.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/TimeExtent-0fd238ea.js","assets/Query-066f2ccf.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/UniqueValueRenderer-8e382829.js","assets/LegendOptions-e31ff575.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-eefea0ec.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/deprecate-46fadabd.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureSet-622e3076.js","assets/LayerView-5e92a124.js","assets/HandleOwner-6ac6f00a.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/visualVariablesUtils-4833b8d3.js","assets/createSymbolSchema-976acefa.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-a093890e.js","assets/capabilities-5736b16f.js","assets/util-94bdf933.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/TileKey-ed432ae5.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/assets-6ba3cd63.js","assets/intl-a5c99ea3.js","assets/messages-634811b5.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-f83851e5.js","assets/RefreshableLayerView-6d197c7a.js"])),Sa={"base-dynamic":()=>ae().then(()=>I(()=>import("./BaseDynamicLayerView2D-c9455d79.js"),["assets/BaseDynamicLayerView2D-c9455d79.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/BitmapContainer-480e821d.js","assets/WGLContainer-69c7e591.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/common-701a4199.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-a3529416.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-b378ccab.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/mathUtils-daf59e84.js","assets/enums-ef042d89.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-b7b9e6bb.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-e1e46e3f.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/reactiveUtils-b0e56010.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/jsonUtils-5115c7e5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/Collection-42fe629f.js","assets/SimpleObservable-e0897cc6.js","assets/collectionUtils-3d8a9611.js","assets/geometry-70b2a4a5.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/HandleOwner-6ac6f00a.js","assets/Identifiable-57df9761.js","assets/Promise-6bd0b483.js","assets/ExportStrategy-aa28d495.js","assets/aaBoundingRect-ca34962d.js","assets/TileInfo-92f7dc61.js","assets/unitUtils-b69647a1.js","assets/Bitmap-b5446edf.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/TileKey-ed432ae5.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/enumeration-497ef064.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/Clonable-58355d3c.js","assets/RefreshableLayerView-6d197c7a.js"])),"base-tile":Ji,"bing-maps":Ji,csv:Xi,"geo-rss":()=>ae().then(()=>I(()=>import("./GeoRSSLayerView2D-6e5058de.js"),["assets/GeoRSSLayerView2D-6e5058de.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/Extent-d5fff12d.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/geometry-70b2a4a5.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/reactiveUtils-b0e56010.js","assets/jsonUtils-7ad404a7.js","assets/UniqueValueRenderer-8e382829.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/LegendOptions-e31ff575.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-34c50417.js","assets/jsonUtils-5115c7e5.js","assets/compilerUtils-eefea0ec.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js","assets/DictionaryLoader-46cd8e54.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/deprecate-46fadabd.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureSet-622e3076.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/LayerView-5e92a124.js","assets/utils-1bc9587b.js","assets/mat3f32-d3d088e8.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/HandleOwner-6ac6f00a.js","assets/GraphicContainer-ec6d8bc9.js","assets/BaseGraphicContainer-dfe82663.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-1f26dd3f.js","assets/normalizeUtils-91a64c2b.js","assets/projectionSupport-38cc9dc5.js","assets/projection-6146477c.js","assets/assets-6ba3cd63.js","assets/zscale-72b4355d.js","assets/json-48e3ea08.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/VertexArrayObject-e1e46e3f.js","assets/FeatureContainer-e4e1ed67.js","assets/mat3-45e3f2eb.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/WGLContainer-69c7e591.js","assets/pixelUtils-a3529416.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/Queue-8aae62d3.js","assets/visualVariablesUtils-9310c846.js","assets/visualVariablesUtils-4833b8d3.js","assets/capabilities-5736b16f.js","assets/Matcher-3b379faa.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/tileUtils-23b52606.js","assets/TileClipper-48ccb501.js","assets/Geometry-daada628.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/createSymbolSchema-976acefa.js","assets/rendererUtils-a093890e.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/util-94bdf933.js","assets/ComputedAttributeStorage-85833802.js","assets/FeatureSetReader-9e0a2b1d.js","assets/centroid-7800ee74.js","assets/FieldsIndex-0e507864.js","assets/vec3f32-4322908d.js"])),feature:Xi,geojson:Xi,graphics:()=>ae().then(()=>I(()=>import("./GraphicsLayerView2D-c9b05347.js"),["assets/GraphicsLayerView2D-c9b05347.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Graphic-34c50417.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/LayerView-5e92a124.js","assets/reactiveUtils-b0e56010.js","assets/utils-1bc9587b.js","assets/mat3f32-d3d088e8.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/HandleOwner-6ac6f00a.js","assets/GraphicContainer-ec6d8bc9.js","assets/BaseGraphicContainer-dfe82663.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-1f26dd3f.js","assets/normalizeUtils-91a64c2b.js","assets/projectionSupport-38cc9dc5.js","assets/projection-6146477c.js","assets/unitUtils-b69647a1.js","assets/assets-6ba3cd63.js","assets/zscale-72b4355d.js","assets/json-48e3ea08.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-c8fbfbd0.js","assets/VertexArrayObject-e1e46e3f.js","assets/FeatureContainer-e4e1ed67.js","assets/mat3-45e3f2eb.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/WGLContainer-69c7e591.js","assets/pixelUtils-a3529416.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/Queue-8aae62d3.js","assets/visualVariablesUtils-9310c846.js","assets/visualVariablesUtils-4833b8d3.js","assets/lengthUtils-0dde2114.js","assets/capabilities-5736b16f.js","assets/Matcher-3b379faa.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/tileUtils-23b52606.js","assets/TileClipper-48ccb501.js","assets/Geometry-daada628.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-cde65ff5.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/diffUtils-713e5c9b.js","assets/createSymbolSchema-976acefa.js","assets/rendererUtils-a093890e.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/UniqueValueRenderer-8e382829.js","assets/LegendOptions-e31ff575.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-eefea0ec.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/deprecate-46fadabd.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/util-94bdf933.js","assets/ComputedAttributeStorage-85833802.js","assets/FeatureSetReader-9e0a2b1d.js","assets/centroid-7800ee74.js","assets/FieldsIndex-0e507864.js","assets/vec3f32-4322908d.js"])),group:()=>ae().then(()=>I(()=>import("./GroupLayerView2D-fe9c8ae5.js"),["assets/GroupLayerView2D-fe9c8ae5.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/GroupContainer-13f6834c.js","assets/WGLContainer-69c7e591.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/common-701a4199.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-a3529416.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-b378ccab.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/mathUtils-daf59e84.js","assets/enums-ef042d89.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-b7b9e6bb.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-e1e46e3f.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/reactiveUtils-b0e56010.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/jsonUtils-5115c7e5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/Collection-42fe629f.js","assets/SimpleObservable-e0897cc6.js","assets/collectionUtils-3d8a9611.js","assets/geometry-70b2a4a5.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/HandleOwner-6ac6f00a.js","assets/Identifiable-57df9761.js","assets/Promise-6bd0b483.js"])),imagery:()=>ae().then(()=>I(()=>import("./ImageryLayerView2D-9a5fde90.js"),["assets/ImageryLayerView2D-9a5fde90.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Graphic-34c50417.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/reactiveUtils-b0e56010.js","assets/GraphicsLayer-18770580.js","assets/HandleOwner-6ac6f00a.js","assets/Layer-f9f81f65.js","assets/BlendLayer-7a735871.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/ScaleRangeLayer-c6a35aba.js","assets/ElevationInfo-618e96ba.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/RasterVFDisplayObject-da379a40.js","assets/VertexArrayObject-e1e46e3f.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-06f77c91.js","assets/pixelUtils-a3529416.js","assets/WGLContainer-69c7e591.js","assets/mat3f32-d3d088e8.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-1bc9587b.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/BaseGraphicContainer-dfe82663.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-1f26dd3f.js","assets/normalizeUtils-91a64c2b.js","assets/projectionSupport-38cc9dc5.js","assets/projection-6146477c.js","assets/assets-6ba3cd63.js","assets/zscale-72b4355d.js","assets/json-48e3ea08.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-c8fbfbd0.js","assets/FeatureContainer-e4e1ed67.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/Queue-8aae62d3.js","assets/visualVariablesUtils-9310c846.js","assets/visualVariablesUtils-4833b8d3.js","assets/capabilities-5736b16f.js","assets/Matcher-3b379faa.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/tileUtils-23b52606.js","assets/TileClipper-48ccb501.js","assets/Geometry-daada628.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-cde65ff5.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/diffUtils-713e5c9b.js","assets/createSymbolSchema-976acefa.js","assets/rendererUtils-a093890e.js","assets/FeatureReductionLayer-d24025a2.js","assets/UniqueValueRenderer-8e382829.js","assets/LegendOptions-e31ff575.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-eefea0ec.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/deprecate-46fadabd.js","assets/OperationalLayer-007b4c8b.js","assets/util-94bdf933.js","assets/ComputedAttributeStorage-85833802.js","assets/FeatureSetReader-9e0a2b1d.js","assets/centroid-7800ee74.js","assets/FieldsIndex-0e507864.js","assets/vec3f32-4322908d.js","assets/HighlightGraphicContainer-85b40eb1.js","assets/BitmapContainer-480e821d.js","assets/Bitmap-b5446edf.js","assets/ExportStrategy-aa28d495.js","assets/TileInfo-92f7dc61.js","assets/rasterProjectionHelper-050c29c5.js","assets/popupUtils-f83851e5.js","assets/RefreshableLayerView-6d197c7a.js"])),"imagery-tile":()=>ae().then(()=>I(()=>import("./ImageryTileLayerView2D-a8859b66.js"),["assets/ImageryTileLayerView2D-a8859b66.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Graphic-34c50417.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/reactiveUtils-b0e56010.js","assets/multidimensionalUtils-6e1dd9aa.js","assets/RasterVFDisplayObject-da379a40.js","assets/HandleOwner-6ac6f00a.js","assets/VertexArrayObject-e1e46e3f.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-06f77c91.js","assets/pixelUtils-a3529416.js","assets/WGLContainer-69c7e591.js","assets/mat3f32-d3d088e8.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/aaBoundingRect-ca34962d.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/TileInfo-92f7dc61.js","assets/unitUtils-b69647a1.js","assets/RawBlockCache-7d1f94ee.js","assets/rasterProjectionHelper-050c29c5.js","assets/projection-6146477c.js","assets/assets-6ba3cd63.js","assets/zscale-72b4355d.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/capabilities-5736b16f.js","assets/util-94bdf933.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/lengthUtils-0dde2114.js","assets/popupUtils-f83851e5.js","assets/RefreshableLayerView-6d197c7a.js","assets/Basemap-fd6389f3.js","assets/deprecate-46fadabd.js","assets/loadAll-1ae88564.js","assets/asyncUtils-18831bb1.js","assets/PortalItem-bbd2de41.js","assets/messages-634811b5.js","assets/writeUtils-44b0e78b.js","assets/layerUtils-6996b9ea.js","assets/compilerUtils-eefea0ec.js","assets/CollectionFlattener-b89887c0.js","assets/TablesMixin-019c9675.js","assets/Layer-f9f81f65.js","assets/Cyclical-1a93cb12.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/intl-a5c99ea3.js","assets/widget-4becb80f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-710cf21c.js","assets/normalizeUtils-91a64c2b.js","assets/query-4348ce6f.js","assets/pbfQueryUtils-91f50fb5.js","assets/pbf-e4fd0249.js","assets/queryZScale-1674984c.js","assets/FeatureSet-622e3076.js","assets/RelationshipQuery-b5b427dc.js","assets/LegendOptions-e31ff575.js","assets/utils-cb77f8a5.js","assets/ItemCache-b4db8f82.js","assets/MemCache-1e028041.js","assets/jsonUtils-7ad404a7.js","assets/UniqueValueRenderer-8e382829.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js","assets/DictionaryLoader-46cd8e54.js","assets/LRUCache-4d56ba4d.js","assets/TopFeaturesQuery-7da1d7c1.js","assets/FeatureLayer-95c99e68.js","assets/MultiOriginJSONSupport-1970ed0f.js","assets/LayerFloorInfo-0d02c503.js","assets/FeatureLayerBase-6192846c.js","assets/HeightModelInfo-645087b5.js","assets/arcgisLayerUrl-02fe1a62.js","assets/editsZScale-e318eb4a.js","assets/APIKeyMixin-f90cfebd.js","assets/ArcGISService-f6f32fbc.js","assets/BlendLayer-7a735871.js","assets/CustomParametersMixin-5e3018da.js","assets/EditBusLayer-1372e92b.js","assets/FeatureReductionLayer-d24025a2.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-7b3473c8.js","assets/PortalLayer-5c12bdba.js","assets/RefreshableLayer-84ec1468.js","assets/ScaleRangeLayer-c6a35aba.js","assets/TemporalLayer-ac8e2c3d.js","assets/TimeInfo-a1791ae0.js","assets/FeatureTemplate-773a8865.js","assets/FeatureType-6c50f4e3.js","assets/fieldProperties-9268e64b.js","assets/FieldsIndex-0e507864.js","assets/versionUtils-5ccafbea.js","assets/styleUtils-45e2d86c.js","assets/popupUtils-40f744cb.js","assets/mat2d-80bd93af.js","assets/Scheduler-343fdba6.js","assets/GraphicsLayer-18770580.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/datetime-7cb5ae9e.js"])),kml:()=>ae().then(()=>I(()=>import("./KMLLayerView2D-ea127b9a.js"),["assets/KMLLayerView2D-ea127b9a.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/reactiveUtils-b0e56010.js","assets/Extent-d5fff12d.js","assets/projection-6146477c.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/unitUtils-b69647a1.js","assets/jsonMap-5afaf2ff.js","assets/mat4-62d5e6a4.js","assets/Polyline-42dcc920.js","assets/assets-6ba3cd63.js","assets/zscale-72b4355d.js","assets/kmlUtils-0e02c712.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/fieldUtils-2efa8993.js","assets/arcadeOnDemand-72a1843c.js","assets/geometry-70b2a4a5.js","assets/typeUtils-b6c52390.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/aaBoundingBox-33fc923c.js","assets/jsonUtils-7ad404a7.js","assets/UniqueValueRenderer-8e382829.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/LegendOptions-e31ff575.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-34c50417.js","assets/jsonUtils-5115c7e5.js","assets/compilerUtils-eefea0ec.js","assets/lengthUtils-0dde2114.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js","assets/DictionaryLoader-46cd8e54.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/deprecate-46fadabd.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureSet-622e3076.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/normalizeUtils-91a64c2b.js","assets/GraphicsLayer-18770580.js","assets/HandleOwner-6ac6f00a.js","assets/Layer-f9f81f65.js","assets/BlendLayer-7a735871.js","assets/parser-f68dd732.js","assets/ScaleRangeLayer-c6a35aba.js","assets/ElevationInfo-618e96ba.js","assets/Bitmap-b5446edf.js","assets/mat3-45e3f2eb.js","assets/mat3f32-d3d088e8.js","assets/vec2f32-461e65a9.js","assets/utils-1bc9587b.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/BitmapContainer-480e821d.js","assets/WGLContainer-69c7e591.js","assets/pixelUtils-a3529416.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-e1e46e3f.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/GraphicContainer-ec6d8bc9.js","assets/BaseGraphicContainer-dfe82663.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-1f26dd3f.js","assets/projectionSupport-38cc9dc5.js","assets/json-48e3ea08.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureContainer-e4e1ed67.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/Queue-8aae62d3.js","assets/visualVariablesUtils-9310c846.js","assets/visualVariablesUtils-4833b8d3.js","assets/capabilities-5736b16f.js","assets/Matcher-3b379faa.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/tileUtils-23b52606.js","assets/TileClipper-48ccb501.js","assets/Geometry-daada628.js","assets/devEnvironmentUtils-5002a058.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/createSymbolSchema-976acefa.js","assets/rendererUtils-a093890e.js","assets/FeatureReductionLayer-d24025a2.js","assets/OperationalLayer-007b4c8b.js","assets/util-94bdf933.js","assets/ComputedAttributeStorage-85833802.js","assets/FeatureSetReader-9e0a2b1d.js","assets/centroid-7800ee74.js","assets/FieldsIndex-0e507864.js","assets/vec3f32-4322908d.js","assets/rasterProjectionHelper-050c29c5.js","assets/RenderingContext-b8526b4a.js","assets/programUtils-fb70f3b3.js","assets/OrderIndependentTransparency-602f26c2.js"])),"map-image":()=>ae().then(()=>I(()=>import("./MapImageLayerView2D-7cd88592.js"),["assets/MapImageLayerView2D-7cd88592.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Graphic-34c50417.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/reactiveUtils-b0e56010.js","assets/BitmapContainer-480e821d.js","assets/WGLContainer-69c7e591.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-a3529416.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-e1e46e3f.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/HandleOwner-6ac6f00a.js","assets/BaseGraphicContainer-dfe82663.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-1f26dd3f.js","assets/normalizeUtils-91a64c2b.js","assets/projectionSupport-38cc9dc5.js","assets/projection-6146477c.js","assets/unitUtils-b69647a1.js","assets/assets-6ba3cd63.js","assets/zscale-72b4355d.js","assets/json-48e3ea08.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-c8fbfbd0.js","assets/FeatureContainer-e4e1ed67.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/Queue-8aae62d3.js","assets/visualVariablesUtils-9310c846.js","assets/visualVariablesUtils-4833b8d3.js","assets/lengthUtils-0dde2114.js","assets/capabilities-5736b16f.js","assets/Matcher-3b379faa.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/tileUtils-23b52606.js","assets/TileClipper-48ccb501.js","assets/Geometry-daada628.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-cde65ff5.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/diffUtils-713e5c9b.js","assets/createSymbolSchema-976acefa.js","assets/rendererUtils-a093890e.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/UniqueValueRenderer-8e382829.js","assets/LegendOptions-e31ff575.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-eefea0ec.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/deprecate-46fadabd.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/util-94bdf933.js","assets/ComputedAttributeStorage-85833802.js","assets/FeatureSetReader-9e0a2b1d.js","assets/centroid-7800ee74.js","assets/FieldsIndex-0e507864.js","assets/vec3f32-4322908d.js","assets/HighlightGraphicContainer-85b40eb1.js","assets/ExportStrategy-aa28d495.js","assets/TileInfo-92f7dc61.js","assets/Bitmap-b5446edf.js","assets/scaleUtils-a6834d30.js","assets/ExportImageParameters-b9e1bec6.js","assets/floorFilterUtils-080a7cd2.js","assets/sublayerUtils-5b8ae1f1.js","assets/drapedUtils-06632e8a.js","assets/GraphicsLayer-18770580.js","assets/Layer-f9f81f65.js","assets/ScaleRangeLayer-c6a35aba.js","assets/popupUtils-f83851e5.js","assets/RefreshableLayerView-6d197c7a.js"])),"map-notes":()=>ae().then(()=>I(()=>import("./MapNotesLayerView2D-80e6b6f0.js"),["assets/MapNotesLayerView2D-80e6b6f0.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Graphic-34c50417.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/reactiveUtils-b0e56010.js","assets/utils-1bc9587b.js","assets/mat3f32-d3d088e8.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/GroupContainer-13f6834c.js","assets/WGLContainer-69c7e591.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-a3529416.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-e1e46e3f.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/HandleOwner-6ac6f00a.js","assets/GraphicContainer-ec6d8bc9.js","assets/BaseGraphicContainer-dfe82663.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-1f26dd3f.js","assets/normalizeUtils-91a64c2b.js","assets/projectionSupport-38cc9dc5.js","assets/projection-6146477c.js","assets/unitUtils-b69647a1.js","assets/assets-6ba3cd63.js","assets/zscale-72b4355d.js","assets/json-48e3ea08.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-c8fbfbd0.js","assets/FeatureContainer-e4e1ed67.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/Queue-8aae62d3.js","assets/visualVariablesUtils-9310c846.js","assets/visualVariablesUtils-4833b8d3.js","assets/lengthUtils-0dde2114.js","assets/capabilities-5736b16f.js","assets/Matcher-3b379faa.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/tileUtils-23b52606.js","assets/TileClipper-48ccb501.js","assets/Geometry-daada628.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-cde65ff5.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/diffUtils-713e5c9b.js","assets/createSymbolSchema-976acefa.js","assets/rendererUtils-a093890e.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/UniqueValueRenderer-8e382829.js","assets/LegendOptions-e31ff575.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-eefea0ec.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/deprecate-46fadabd.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/util-94bdf933.js","assets/ComputedAttributeStorage-85833802.js","assets/FeatureSetReader-9e0a2b1d.js","assets/centroid-7800ee74.js","assets/FieldsIndex-0e507864.js","assets/vec3f32-4322908d.js"])),media:()=>ae().then(()=>I(()=>import("./MediaLayerView2D-eaaaa328.js"),["assets/MediaLayerView2D-eaaaa328.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/reactiveUtils-b0e56010.js","assets/aaBoundingRect-ca34962d.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/projection-6146477c.js","assets/preload-helper-101896b7.js","assets/unitUtils-b69647a1.js","assets/mat4-62d5e6a4.js","assets/assets-6ba3cd63.js","assets/request-e4299080.js","assets/zscale-72b4355d.js","assets/normalizeUtilsSync-1f26dd3f.js","assets/jsonUtils-5115c7e5.js","assets/normalizeUtils-91a64c2b.js","assets/TileStrategy-40f1ecb0.js","assets/vec2-f978aef8.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/TileKey-ed432ae5.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/enumeration-497ef064.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/Clonable-58355d3c.js","assets/mat3-45e3f2eb.js","assets/mat3f64-b33e332c.js","assets/vec2f64-e0301652.js","assets/utils-1bc9587b.js","assets/mat3f32-d3d088e8.js","assets/parser-f68dd732.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-b7b9e6bb.js","assets/VertexArrayObject-e1e46e3f.js","assets/vec2f32-461e65a9.js","assets/vec3f32-4322908d.js","assets/WGLContainer-69c7e591.js","assets/pixelUtils-a3529416.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/collectionUtils-3d8a9611.js","assets/HandleOwner-6ac6f00a.js","assets/Identifiable-57df9761.js","assets/Promise-6bd0b483.js","assets/Basemap-fd6389f3.js","assets/deprecate-46fadabd.js","assets/Loadable-b0d5bb7e.js","assets/loadAll-1ae88564.js","assets/asyncUtils-18831bb1.js","assets/Portal-95b0f852.js","assets/locale-30120714.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/PortalItem-bbd2de41.js","assets/messages-634811b5.js","assets/writeUtils-44b0e78b.js","assets/layerUtils-6996b9ea.js","assets/compilerUtils-eefea0ec.js","assets/opacityUtils-8b7acc4e.js","assets/CollectionFlattener-b89887c0.js","assets/TablesMixin-019c9675.js","assets/Layer-f9f81f65.js","assets/Graphic-34c50417.js","assets/PopupTemplate-29fe62b5.js","assets/fieldUtils-2efa8993.js","assets/arcadeOnDemand-72a1843c.js","assets/number-c7f1bfee.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/aaBoundingBox-33fc923c.js","assets/persistableUrlUtils-d18becd9.js","assets/Cyclical-1a93cb12.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/intl-a5c99ea3.js","assets/TileInfo-92f7dc61.js","assets/widget-4becb80f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-710cf21c.js","assets/query-4348ce6f.js","assets/pbfQueryUtils-91f50fb5.js","assets/pbf-e4fd0249.js","assets/queryZScale-1674984c.js","assets/FeatureSet-622e3076.js","assets/RelationshipQuery-b5b427dc.js","assets/LegendOptions-e31ff575.js","assets/utils-cb77f8a5.js","assets/ItemCache-b4db8f82.js","assets/MemCache-1e028041.js","assets/jsonUtils-7ad404a7.js","assets/UniqueValueRenderer-8e382829.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/lengthUtils-0dde2114.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js","assets/DictionaryLoader-46cd8e54.js","assets/LRUCache-4d56ba4d.js","assets/TopFeaturesQuery-7da1d7c1.js","assets/FeatureLayer-95c99e68.js","assets/MultiOriginJSONSupport-1970ed0f.js","assets/LayerFloorInfo-0d02c503.js","assets/FeatureLayerBase-6192846c.js","assets/HeightModelInfo-645087b5.js","assets/arcgisLayerUrl-02fe1a62.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/editsZScale-e318eb4a.js","assets/APIKeyMixin-f90cfebd.js","assets/ArcGISService-f6f32fbc.js","assets/BlendLayer-7a735871.js","assets/CustomParametersMixin-5e3018da.js","assets/EditBusLayer-1372e92b.js","assets/FeatureReductionLayer-d24025a2.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-7b3473c8.js","assets/PortalLayer-5c12bdba.js","assets/RefreshableLayer-84ec1468.js","assets/ScaleRangeLayer-c6a35aba.js","assets/TemporalLayer-ac8e2c3d.js","assets/TimeInfo-a1791ae0.js","assets/FeatureTemplate-773a8865.js","assets/FeatureType-6c50f4e3.js","assets/fieldProperties-9268e64b.js","assets/FieldsIndex-0e507864.js","assets/versionUtils-5ccafbea.js","assets/styleUtils-45e2d86c.js","assets/popupUtils-40f744cb.js","assets/mat2d-80bd93af.js","assets/Scheduler-343fdba6.js","assets/GraphicsLayer-18770580.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/capabilities-5736b16f.js","assets/datetime-7cb5ae9e.js"])),"ogc-feature":()=>ae().then(()=>I(()=>import("./OGCFeatureLayerView2D-4b8c774d.js"),["assets/OGCFeatureLayerView2D-4b8c774d.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/FeatureLayerView2D-68b28637.js","assets/Graphic-34c50417.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/reactiveUtils-b0e56010.js","assets/utils-1bc9587b.js","assets/mat3f32-d3d088e8.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/TimeExtent-0fd238ea.js","assets/Query-066f2ccf.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/UniqueValueRenderer-8e382829.js","assets/LegendOptions-e31ff575.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-eefea0ec.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/deprecate-46fadabd.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureSet-622e3076.js","assets/LayerView-5e92a124.js","assets/HandleOwner-6ac6f00a.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/visualVariablesUtils-4833b8d3.js","assets/createSymbolSchema-976acefa.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-a093890e.js","assets/capabilities-5736b16f.js","assets/util-94bdf933.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/TileKey-ed432ae5.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/assets-6ba3cd63.js","assets/intl-a5c99ea3.js","assets/messages-634811b5.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-f83851e5.js","assets/RefreshableLayerView-6d197c7a.js"])),"open-street-map":Ji,"oriented-imagery":Xi,route:()=>ae().then(()=>I(()=>import("./RouteLayerView2D-640f0075.js"),["assets/RouteLayerView2D-640f0075.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/CollectionFlattener-b89887c0.js","assets/reactiveUtils-b0e56010.js","assets/Stop-49c6a946.js","assets/Graphic-34c50417.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/LayerView-5e92a124.js","assets/utils-1bc9587b.js","assets/mat3f32-d3d088e8.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/HandleOwner-6ac6f00a.js","assets/GraphicContainer-ec6d8bc9.js","assets/BaseGraphicContainer-dfe82663.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/normalizeUtilsSync-1f26dd3f.js","assets/normalizeUtils-91a64c2b.js","assets/projectionSupport-38cc9dc5.js","assets/projection-6146477c.js","assets/unitUtils-b69647a1.js","assets/assets-6ba3cd63.js","assets/zscale-72b4355d.js","assets/json-48e3ea08.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/jsonUtils-c8fbfbd0.js","assets/VertexArrayObject-e1e46e3f.js","assets/FeatureContainer-e4e1ed67.js","assets/mat3-45e3f2eb.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/WGLContainer-69c7e591.js","assets/pixelUtils-a3529416.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/Queue-8aae62d3.js","assets/visualVariablesUtils-9310c846.js","assets/visualVariablesUtils-4833b8d3.js","assets/lengthUtils-0dde2114.js","assets/capabilities-5736b16f.js","assets/Matcher-3b379faa.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/tileUtils-23b52606.js","assets/TileClipper-48ccb501.js","assets/Geometry-daada628.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/devEnvironmentUtils-5002a058.js","assets/styleUtils-cde65ff5.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/diffUtils-713e5c9b.js","assets/createSymbolSchema-976acefa.js","assets/rendererUtils-a093890e.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/UniqueValueRenderer-8e382829.js","assets/LegendOptions-e31ff575.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-eefea0ec.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/deprecate-46fadabd.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/util-94bdf933.js","assets/ComputedAttributeStorage-85833802.js","assets/FeatureSetReader-9e0a2b1d.js","assets/centroid-7800ee74.js","assets/FieldsIndex-0e507864.js","assets/vec3f32-4322908d.js"])),stream:()=>ae().then(()=>I(()=>import("./StreamLayerView2D-1083bb07.js"),["assets/StreamLayerView2D-1083bb07.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/reactiveUtils-b0e56010.js","assets/FeatureSet-622e3076.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/Graphic-34c50417.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/FeatureLayerView2D-68b28637.js","assets/utils-1bc9587b.js","assets/mat3f32-d3d088e8.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/TimeExtent-0fd238ea.js","assets/Query-066f2ccf.js","assets/UniqueValueRenderer-8e382829.js","assets/LegendOptions-e31ff575.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/compilerUtils-eefea0ec.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/deprecate-46fadabd.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/LayerView-5e92a124.js","assets/HandleOwner-6ac6f00a.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/visualVariablesUtils-4833b8d3.js","assets/createSymbolSchema-976acefa.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-a093890e.js","assets/capabilities-5736b16f.js","assets/util-94bdf933.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/TileKey-ed432ae5.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/assets-6ba3cd63.js","assets/intl-a5c99ea3.js","assets/messages-634811b5.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-f83851e5.js","assets/RefreshableLayerView-6d197c7a.js"])),"subtype-group":()=>ae().then(()=>I(()=>import("./SubtypeGroupLayerView2D-65ba0e8f.js"),["assets/SubtypeGroupLayerView2D-65ba0e8f.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/reactiveUtils-b0e56010.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/parser-f68dd732.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/common-701a4199.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/TimeExtent-0fd238ea.js","assets/Query-066f2ccf.js","assets/enumeration-497ef064.js","assets/jsonUtils-5115c7e5.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/Clonable-58355d3c.js","assets/PopupTemplate-29fe62b5.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/UniqueValueRenderer-8e382829.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/mathUtils-daf59e84.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/LegendOptions-e31ff575.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/Graphic-34c50417.js","assets/compilerUtils-eefea0ec.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/deprecate-46fadabd.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/FeatureLayerView2D-68b28637.js","assets/utils-1bc9587b.js","assets/mat3f32-d3d088e8.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/FeatureSet-622e3076.js","assets/LayerView-5e92a124.js","assets/HandleOwner-6ac6f00a.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/visualVariablesUtils-4833b8d3.js","assets/createSymbolSchema-976acefa.js","assets/ExpandedCIM-6cfcc2f7.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/vec2-f978aef8.js","assets/vec2f32-461e65a9.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/floatRGBA-305df8f3.js","assets/rendererUtils-a093890e.js","assets/capabilities-5736b16f.js","assets/util-94bdf933.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/TileKey-ed432ae5.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/assets-6ba3cd63.js","assets/intl-a5c99ea3.js","assets/messages-634811b5.js","assets/floorFilterUtils-080a7cd2.js","assets/popupUtils-f83851e5.js","assets/RefreshableLayerView-6d197c7a.js"])),tile:Ji,"vector-tile":()=>ae().then(()=>I(()=>import("./VectorTileLayerView2D-14eee708.js"),["assets/VectorTileLayerView2D-14eee708.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Graphic-34c50417.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/reactiveUtils-b0e56010.js","assets/diffUtils-713e5c9b.js","assets/aaBoundingRect-ca34962d.js","assets/enums-bfc9e4e9.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/Queue-8aae62d3.js","assets/assets-6ba3cd63.js","assets/intl-a5c99ea3.js","assets/messages-634811b5.js","assets/Rect-ea14f53a.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/pbf-e4fd0249.js","assets/rasterizingUtils-18039619.js","assets/floatRGBA-305df8f3.js","assets/TileKey-ed432ae5.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/TileStore-a368d16c.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/mat3-45e3f2eb.js","assets/mat3f32-d3d088e8.js","assets/VertexArrayObject-e1e46e3f.js","assets/config-1337d16e.js","assets/TileContainer-efb37002.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/WGLContainer-69c7e591.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-a3529416.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/StyleRepository-f1c54372.js","assets/colorUtils-0c057879.js","assets/unitBezier-881ac1eb.js","assets/GeometryUtils-eebff0a0.js","assets/Geometry-daada628.js","assets/LayerView-5e92a124.js","assets/HandleOwner-6ac6f00a.js","assets/TileInfo-92f7dc61.js","assets/unitUtils-b69647a1.js","assets/TileStrategy-40f1ecb0.js"])),wcs:()=>ae().then(()=>I(()=>import("./ImageryTileLayerView2D-a8859b66.js"),["assets/ImageryTileLayerView2D-a8859b66.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/Graphic-34c50417.js","assets/geometry-70b2a4a5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/PopupTemplate-29fe62b5.js","assets/Clonable-58355d3c.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/fieldUtils-2efa8993.js","assets/preload-helper-101896b7.js","assets/arcadeOnDemand-72a1843c.js","assets/enumeration-497ef064.js","assets/number-c7f1bfee.js","assets/locale-30120714.js","assets/Identifiable-57df9761.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/request-e4299080.js","assets/persistableUrlUtils-d18becd9.js","assets/collectionUtils-3d8a9611.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/jsonUtils-5115c7e5.js","assets/reactiveUtils-b0e56010.js","assets/multidimensionalUtils-6e1dd9aa.js","assets/RasterVFDisplayObject-da379a40.js","assets/HandleOwner-6ac6f00a.js","assets/VertexArrayObject-e1e46e3f.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/enums-64ab819c.js","assets/VertexElementDescriptor-2925c6af.js","assets/dataUtils-06f77c91.js","assets/pixelUtils-a3529416.js","assets/WGLContainer-69c7e591.js","assets/mat3f32-d3d088e8.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/mat4-62d5e6a4.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/vec2f64-e0301652.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/aaBoundingRect-ca34962d.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/TileInfo-92f7dc61.js","assets/unitUtils-b69647a1.js","assets/RawBlockCache-7d1f94ee.js","assets/rasterProjectionHelper-050c29c5.js","assets/projection-6146477c.js","assets/assets-6ba3cd63.js","assets/zscale-72b4355d.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/capabilities-5736b16f.js","assets/util-94bdf933.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/lengthUtils-0dde2114.js","assets/popupUtils-f83851e5.js","assets/RefreshableLayerView-6d197c7a.js","assets/Basemap-fd6389f3.js","assets/deprecate-46fadabd.js","assets/loadAll-1ae88564.js","assets/asyncUtils-18831bb1.js","assets/PortalItem-bbd2de41.js","assets/messages-634811b5.js","assets/writeUtils-44b0e78b.js","assets/layerUtils-6996b9ea.js","assets/compilerUtils-eefea0ec.js","assets/CollectionFlattener-b89887c0.js","assets/TablesMixin-019c9675.js","assets/Layer-f9f81f65.js","assets/Cyclical-1a93cb12.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/intl-a5c99ea3.js","assets/widget-4becb80f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-710cf21c.js","assets/normalizeUtils-91a64c2b.js","assets/query-4348ce6f.js","assets/pbfQueryUtils-91f50fb5.js","assets/pbf-e4fd0249.js","assets/queryZScale-1674984c.js","assets/FeatureSet-622e3076.js","assets/RelationshipQuery-b5b427dc.js","assets/LegendOptions-e31ff575.js","assets/utils-cb77f8a5.js","assets/ItemCache-b4db8f82.js","assets/MemCache-1e028041.js","assets/jsonUtils-7ad404a7.js","assets/UniqueValueRenderer-8e382829.js","assets/diffUtils-713e5c9b.js","assets/colorRamps-c00f504b.js","assets/sizeVariableUtils-d4870b0d.js","assets/jsonUtils-c8fbfbd0.js","assets/styleUtils-cde65ff5.js","assets/DictionaryLoader-46cd8e54.js","assets/LRUCache-4d56ba4d.js","assets/TopFeaturesQuery-7da1d7c1.js","assets/FeatureLayer-95c99e68.js","assets/MultiOriginJSONSupport-1970ed0f.js","assets/LayerFloorInfo-0d02c503.js","assets/FeatureLayerBase-6192846c.js","assets/HeightModelInfo-645087b5.js","assets/arcgisLayerUrl-02fe1a62.js","assets/editsZScale-e318eb4a.js","assets/APIKeyMixin-f90cfebd.js","assets/ArcGISService-f6f32fbc.js","assets/BlendLayer-7a735871.js","assets/CustomParametersMixin-5e3018da.js","assets/EditBusLayer-1372e92b.js","assets/FeatureReductionLayer-d24025a2.js","assets/labelingInfo-69496ac8.js","assets/labelUtils-87bb22ff.js","assets/defaultsJSON-b087dd4d.js","assets/OrderedLayer-7b3473c8.js","assets/PortalLayer-5c12bdba.js","assets/RefreshableLayer-84ec1468.js","assets/ScaleRangeLayer-c6a35aba.js","assets/TemporalLayer-ac8e2c3d.js","assets/TimeInfo-a1791ae0.js","assets/FeatureTemplate-773a8865.js","assets/FeatureType-6c50f4e3.js","assets/fieldProperties-9268e64b.js","assets/FieldsIndex-0e507864.js","assets/versionUtils-5ccafbea.js","assets/styleUtils-45e2d86c.js","assets/popupUtils-40f744cb.js","assets/mat2d-80bd93af.js","assets/Scheduler-343fdba6.js","assets/GraphicsLayer-18770580.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/datetime-7cb5ae9e.js"])),"web-tile":Ji,wfs:Xi,wms:()=>ae().then(()=>I(()=>import("./WMSLayerView2D-f60fc369.js"),["assets/WMSLayerView2D-f60fc369.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/reactiveUtils-b0e56010.js","assets/Extent-d5fff12d.js","assets/BitmapContainer-480e821d.js","assets/WGLContainer-69c7e591.js","assets/mat3f32-d3d088e8.js","assets/enums-64ab819c.js","assets/mat3-45e3f2eb.js","assets/common-701a4199.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-a3529416.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-b378ccab.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/mathUtils-daf59e84.js","assets/enums-ef042d89.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-b7b9e6bb.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-e1e46e3f.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/jsonUtils-5115c7e5.js","assets/Polyline-42dcc920.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/Collection-42fe629f.js","assets/SimpleObservable-e0897cc6.js","assets/collectionUtils-3d8a9611.js","assets/geometry-70b2a4a5.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/HandleOwner-6ac6f00a.js","assets/Identifiable-57df9761.js","assets/Promise-6bd0b483.js","assets/ExportStrategy-aa28d495.js","assets/aaBoundingRect-ca34962d.js","assets/TileInfo-92f7dc61.js","assets/unitUtils-b69647a1.js","assets/Bitmap-b5446edf.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/TileKey-ed432ae5.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/enumeration-497ef064.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/Clonable-58355d3c.js","assets/RefreshableLayerView-6d197c7a.js","assets/OperationalLayer-007b4c8b.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/persistableUrlUtils-d18becd9.js","assets/ElevationInfo-618e96ba.js","assets/fieldUtils-2efa8993.js","assets/arcadeOnDemand-72a1843c.js","assets/lengthUtils-0dde2114.js","assets/opacityUtils-8b7acc4e.js","assets/ExportWMSImageParameters-df879937.js"])),wmts:()=>ae().then(()=>I(()=>import("./WMTSLayerView2D-ac689bff.js"),["assets/WMTSLayerView2D-ac689bff.js","assets/cast-6d78d3c7.js","assets/typedArrayUtil-d02f10a8.js","assets/string-9c5e03f7.js","assets/Error-4ed679d7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/promiseUtils-930cba29.js","assets/reactiveUtils-b0e56010.js","assets/Extent-d5fff12d.js","assets/imageUtils-f5c68deb.js","assets/BitmapTileContainer-f80c60ba.js","assets/aaBoundingRect-ca34962d.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/mat3f32-d3d088e8.js","assets/Bitmap-b5446edf.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/Evented-b378ccab.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-b7b9e6bb.js","assets/TileContainer-efb37002.js","assets/TileKey-ed432ae5.js","assets/WGLContainer-69c7e591.js","assets/pixelUtils-a3529416.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-e1e46e3f.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/jsonUtils-5115c7e5.js","assets/Polyline-42dcc920.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/LayerView-5e92a124.js","assets/Collection-42fe629f.js","assets/SimpleObservable-e0897cc6.js","assets/collectionUtils-3d8a9611.js","assets/geometry-70b2a4a5.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/HandleOwner-6ac6f00a.js","assets/Identifiable-57df9761.js","assets/Promise-6bd0b483.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/enumeration-497ef064.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/Clonable-58355d3c.js","assets/TileStrategy-40f1ecb0.js","assets/RefreshableLayerView-6d197c7a.js"])),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function Pg(i){const e=i.declaredClass?i.declaredClass.slice(i.declaredClass.lastIndexOf(".")+1):"Unknown",t=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new k(`${t}:view-not-supported`,`${e} is not supported in 2D`)}const Ra={hasLayerViewModule:i=>M(Sa[i.type]),importLayerView:i=>{const e=Sa[i.type];if(F(e))throw Pg(i);return e(i)}};function $g(i,e){const{spatialReference:t}=e,s=[e.x,e.y];let n=Number.POSITIVE_INFINITY,o=0,r=0;const l=[0,0],d=i.type==="extent"?[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]:i.rings;for(const u of d)for(let h=0;h<u.length-1;h++){pu(l,s,u,h);const p=Nu(s,l);p<n&&(n=p,o=l[0],r=l[1])}return{coordinate:new X({x:o,y:r,spatialReference:t}),distance:n}}var Po;let gi=Po=class extends Ho(V){constructor(i){super(i),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(F(this.geometry)||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Cs(this.geometry,this.spatialReference)}catch(i){return N.getLogger(this.declaredClass).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:i}),null}return this.geometry}constrain(i,e){if(F(this.normalizedGeometry))return i;const t=i.targetGeometry;if(this.normalizedGeometry.type==="extent"?al(this.normalizedGeometry,t):yd(this.normalizedGeometry,t))return i;const{coordinate:s}=$g(this.normalizedGeometry,t);return s&&(i.targetGeometry=s),i}clone(){var i,e;return new Po({geometry:(i=this.geometry)==null?void 0:i.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};a([c({constructOnly:!0})],gi.prototype,"geometry",void 0),a([c({readOnly:!0})],gi.prototype,"normalizedGeometry",null),a([c({constructOnly:!0})],gi.prototype,"spatialReference",void 0),gi=Po=a([b("esri.views.2d.constraints.GeometryConstraint")],gi);var $o;let hs=$o=class extends Ho(V){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(i,e){return this.enabled&&e&&(this.rotationEnabled||(i.rotation=e.rotation)),i}clone(){return new $o({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};a([c()],hs.prototype,"enabled",void 0),a([c()],hs.prototype,"rotationEnabled",void 0),hs=$o=a([b("esri.views.2d.constraints.RotationConstraint")],hs);const Tc=hs;var So;let Pe=So=class extends Ho(V){constructor(i){super(i),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let i,{lods:e,minScale:t,maxScale:s,minZoom:n,maxZoom:o}=this,r=-1,l=-1,d=!1,u=!1;if(t!==0&&s!==0&&t<s&&([t,s]=[s,t]),!e||!e.length)return this._set("effectiveMinScale",t),void this._set("effectiveMaxScale",s);e=e.map(h=>h.clone()),e.sort((h,p)=>p.scale-h.scale),e.forEach((h,p)=>h.level=p);for(const h of e)!d&&t>0&&t>=h.scale&&(r=h.level,d=!0),!u&&s>0&&s>=h.scale&&(l=i?i.level:-1,u=!0),i=h;n===-1&&(n=t===0?0:r),o===-1&&(o=s===0?e.length-1:l),n=Math.max(n,0),n=Math.min(n,e.length-1),o=Math.max(o,0),o=Math.min(o,e.length-1),n>o&&([n,o]=[o,n]),t=e[n].scale,s=e[o].scale,e.splice(0,n),e.splice(o-n+1,e.length),e.forEach((h,p)=>{this._lodByScale[h.scale]=h,this._scales[p]=h.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",o),this._set("effectiveMinScale",t),this._set("effectiveMaxScale",s)}constrain(i,e){if(e&&i.scale===e.scale)return i;const t=this.effectiveMinScale,s=this.effectiveMaxScale,n=i.targetGeometry,o=e&&e.targetGeometry,r=s!==0&&i.scale<s,l=t!==0&&i.scale>t;if(r||l){const d=l?t:s;if(e&&o){const u=(d-e.scale)/(i.scale-e.scale);n.x=o.x+(n.x-o.x)*u,n.y=o.y+(n.y-o.y)*u}i.scale=d}return this.snapToZoom&&this.effectiveLODs&&(i.scale=this._getClosestScale(i.scale)),i}fit(i){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(i,null);const e=this.scaleToZoom(i.scale),t=Math.abs(e-Math.floor(e));return i.scale=this.zoomToScale(t>.99?Math.round(e):Math.floor(e)),i}zoomToScale(i){if(!this.effectiveLODs)return 0;i-=this.effectiveMinZoom,i=Math.max(0,i);const e=this._scales;if(i<=0)return e[0];if(i>=e.length)return e[e.length-1];const t=Math.round(i-.5),s=Math.round(i);return e[s]+(s-i)*(e[t]-e[s])}scaleToZoom(i){if(!this.effectiveLODs)return-1;const e=this._scales;let t,s;if(i>=e[0])return this.effectiveMinZoom;if(i<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(t=e[n],s=e[n+1],s===i)return n+this.effectiveMinZoom+1;if(t>i&&s<i)return n+this.effectiveMinZoom+1-(i-s)/(t-s)}return-1}snapToClosestScale(i){if(!this.effectiveLODs)return i;const e=this.scaleToZoom(i);return this.zoomToScale(Math.round(e))}snapToNextScale(i,e=.5){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t+1)}snapToPreviousScale(i,e=2){if(!this.effectiveLODs)return i*e;const t=Math.round(this.scaleToZoom(i));return this.zoomToScale(t-1)}clone(){return new So({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(i){return this._lodByScale[i]||(i=this._scales.reduce((e,t)=>Math.abs(t-i)<=Math.abs(e-i)?t:e,this._scales[0])),this._lodByScale[i].scale}};a([c({readOnly:!0})],Pe.prototype,"effectiveLODs",void 0),a([c({readOnly:!0})],Pe.prototype,"effectiveMinZoom",void 0),a([c({readOnly:!0})],Pe.prototype,"effectiveMaxZoom",void 0),a([c({readOnly:!0})],Pe.prototype,"effectiveMinScale",void 0),a([c({readOnly:!0})],Pe.prototype,"effectiveMaxScale",void 0),a([c()],Pe.prototype,"lods",void 0),a([c()],Pe.prototype,"minZoom",void 0),a([c()],Pe.prototype,"maxZoom",void 0),a([c()],Pe.prototype,"minScale",void 0),a([c()],Pe.prototype,"maxScale",void 0),a([c()],Pe.prototype,"snapToZoom",void 0),Pe=So=a([b("esri.views.2d.constraints.ZoomConstraint")],Pe);const Ec=Pe,Sg={base:null,key:"type",typeMap:{extent:Gi,polygon:mu}};let se=class extends V{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,t,s;return`${(e=this._zoom)==null?void 0:e.uid}/${(t=this._rotation)==null?void 0:t.uid}/${(s=this._geometry)==null?void 0:s.uid}`}get _defaultLODs(){var s,n,o;const e=(n=(s=this.view)==null?void 0:s.defaultsFromMap)==null?void 0:n.tileInfo,t=(o=this.view)==null?void 0:o.spatialReference;return e&&t&&e.spatialReference.equals(t)?e.lods:null}get _geometry(){var e;return new gi({geometry:this.geometry,spatialReference:(e=this.view)==null?void 0:e.spatialReference})}get _rotation(){return new Tc({rotationEnabled:this.rotationEnabled})}get _zoom(){const e=this._get("_zoom"),t=this.lods||this._defaultLODs,s=this.minZoom,n=this.maxZoom,o=this.minScale,r=this.maxScale,l=this.snapToZoom;return e&&e.lods===t&&e.minZoom===s&&e.maxZoom===n&&e.minScale===o&&e.maxScale===r&&e.snapToZoom===l?e:new Ec({lods:t,minZoom:s,maxZoom:n,minScale:o,maxScale:r,snapToZoom:l})}canZoomInTo(e){const t=this.effectiveMaxScale;return t===0||e>=t}canZoomOutTo(e){const t=this.effectiveMinScale;return t===0||e<=t}constrain(e,t){return this._zoom.constrain(e,t),this._rotation.constrain(e,t),this._geometry.constrain(e,t),e}constrainByGeometry(e){return this._geometry.constrain(e)}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};a([c({readOnly:!0})],se.prototype,"effectiveLODs",null),a([c({readOnly:!0})],se.prototype,"effectiveMinScale",null),a([c({readOnly:!0})],se.prototype,"effectiveMaxScale",null),a([c({readOnly:!0})],se.prototype,"effectiveMinZoom",null),a([c({readOnly:!0})],se.prototype,"effectiveMaxZoom",null),a([c({types:Sg,value:null})],se.prototype,"geometry",null),a([c({type:[Vd]})],se.prototype,"lods",void 0),a([c()],se.prototype,"minScale",void 0),a([c()],se.prototype,"maxScale",void 0),a([c()],se.prototype,"minZoom",void 0),a([c()],se.prototype,"maxZoom",void 0),a([c()],se.prototype,"rotationEnabled",void 0),a([c()],se.prototype,"snapToZoom",void 0),a([c()],se.prototype,"view",void 0),a([c({readOnly:!0})],se.prototype,"version",null),a([c()],se.prototype,"_defaultLODs",null),a([c({type:gi})],se.prototype,"_geometry",null),a([c({type:Tc})],se.prototype,"_rotation",null),a([c({readOnly:!0,type:Ec})],se.prototype,"_zoom",null),se=a([b("esri.views.2d.MapViewConstraints")],se);const xc=se;function Rg(i){return i instanceof Float32Array&&i.length>=2}function Lg(i){return Array.isArray(i)&&i.length>=2}function Jn(i){return Rg(i)||Lg(i)}var Ro;const mt=[0,0];let Ut=Ro=class extends Ke{constructor(i){super(i),this._viewpoint2D={center:he(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new Gi,this.id=0,this.inverseTransform=Qt(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Qt(),this.transformNoRotation=Qt(),this.displayMat3=Ln(),this.displayViewMat3=Ln(),this.viewMat3=Ln(),this.viewMat2d=Iu(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(i){this._set("pixelRatio",i),this._update()}set size(i){this._set("size",i),this._update()}set viewpoint(i){if(i){const e=this._viewpoint2D,t=i.targetGeometry;e.center[0]=t.x,e.center[1]=t.y,e.rotation=i.rotation,e.scale=i.scale,e.spatialReference=t.spatialReference}this._update()}copy(i){const e=this.size,t=this.viewpoint;return t&&e?(this.viewpoint=Ye(t,i.viewpoint),this._set("size",an(e,i.size))):(this.viewpoint=i.viewpoint.clone(),this._set("size",[i.size[0],i.size[1]])),this._set("pixelRatio",i.pixelRatio),this}clone(){return new Ro({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(i,e,t){return Jn(e)?Ct(i,e,this.inverseTransform):(mt[0]=e,mt[1]=t,Ct(i,mt,this.inverseTransform))}toScreen(i,e,t){return Jn(e)?Ct(i,e,this.transform):(mt[0]=e,mt[1]=t,Ct(i,mt,this.transform))}toScreenNoRotation(i,e,t){return Jn(e)?Ct(i,e,this.transformNoRotation):(mt[0]=e,mt[1]=t,Ct(i,mt,this.transformNoRotation))}getScreenTransform(i,e){const{center:t}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size");return ar(i,t,n,e,0,s),i}_update(){const{center:i,spatialReference:e,scale:t,rotation:s}=this._viewpoint2D,n=this._get("pixelRatio")||1,o=this._get("size"),r=new We({targetGeometry:new X(i[0],i[1],e),scale:t,rotation:s});if(this._set("viewpoint",r),!o||!e||!t)return;this.resolution=Wi(r),this.rotation=s,this.scale=t,this.spatialReference=e,an(this.center,i);const l=o[0]!==0?2/o[0]:0,d=o[1]!==0?-2/o[1]:0;Bu(this.displayMat3,l,0,0,0,d,0,-1,1,1);const u=Uu(this.viewMat3),h=$r(o[0]/2,o[1]/2),p=$r(-o[0]/2,-o[1]/2),g=Al(s);Pr(u,u,h),Hu(u,u,g),Pr(u,u,p),Gu(this.displayViewMat3,this.displayMat3,u);const f=Tl(this.viewMat2d,h);return Go(f,f,g),rn(f,f,p),hg(this.extent,r,o),lr(this.transform,r,o,n),El(this.inverseTransform,this.transform),vg(this.transformNoRotation,r,o,n),this.worldScreenWidth=bg(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};a([c({readOnly:!0})],Ut.prototype,"id",void 0),a([c({value:1,json:{write:!0}})],Ut.prototype,"pixelRatio",null),a([c({json:{write:!0}})],Ut.prototype,"size",null),a([c()],Ut.prototype,"spatialReference",void 0),a([c({type:We,json:{write:!0}})],Ut.prototype,"viewpoint",null),Ut=Ro=a([b("esri.views.2d.ViewState")],Ut);const La=Ut;var Lo,Fo;let Tt=Lo=class extends V{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new Lo({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};a([c()],Tt.prototype,"left",void 0),a([c()],Tt.prototype,"top",void 0),a([c()],Tt.prototype,"right",void 0),a([c()],Tt.prototype,"bottom",void 0),Tt=Lo=a([b("esri.views.2d.PaddedViewState.Padding")],Tt);let $i=Fo=class extends La{constructor(...i){super(...i),this.paddedViewState=new La,this._updateContent=(()=>{const e=he();return()=>{const t=this._get("size"),s=this._get("padding");if(!t||!s)return;const n=this.paddedViewState;ye(e,s.left+s.right,s.top+s.bottom),ho(e,t,e),an(n.size,e);const o=n.viewpoint;o&&(this.viewpoint=o)}})(),this.addHandles(v(()=>[this.size,this.padding],()=>this._updateContent(),ys)),this.padding=new Tt,this.size=[0,0]}set padding(i){this._set("padding",i||new Tt)}set viewpoint(i){if(i){const e=i.clone();this.paddedViewState.viewpoint=i,Ig(e,i,this._get("size"),this._get("padding"));const t=this._viewpoint2D,s=e.targetGeometry;t.center[0]=s.x,t.center[1]=s.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=s.spatialReference,this._update()}}clone(){return new Fo({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};a([c()],$i.prototype,"paddedViewState",void 0),a([c({type:Tt})],$i.prototype,"padding",null),a([c()],$i.prototype,"viewpoint",null),$i=Fo=a([b("esri.views.2d.PaddedViewState")],$i);const Fg=$i;function cr(i,e){switch(e){case"primary":return i.pointerType==="touch"||i.button===0;case"secondary":return i.pointerType!=="touch"&&i.button===2;case"tertiary":return i.pointerType!=="touch"&&i.button===1}}let Fa=class extends me{constructor(e,t){super(!0),this._view=e,this.registerIncoming("double-click",t,s=>this._handleDoubleClick(s,t))}_handleDoubleClick(e,t){cr(e.data,"primary")&&(e.stopPropagation(),t?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},Og=class extends me{constructor(e,t,s){super(!0),this.view=e,this.pointerType=t,this.registerIncoming("double-tap-drag",s,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(e){const{data:t}=e,{pointerType:s}=t;if(s!==this.pointerType)return;e.stopPropagation();const{action:n,delta:o}=t,{view:r}=this,{mapViewNavigation:l}=r;switch(n){case"begin":{const{scale:d}=r;this._startScale=d,this._currentScale=d,this._previousDelta=o,l.begin();break}case"update":{if(this._previousDelta.y===o.y)return;this._previousDelta=o;const d=1.015**o.y,u=this._startScale*d,h=u/this._currentScale;l.setViewpointImmediate(h),this._currentScale=u;break}case"end":{const{constraints:d}=r,{effectiveLODs:u,snapToZoom:h}=d;if(!h||!u)return void l.end();const p=d.snapScale(this._currentScale),g=(o.y>0?Math.max(p,d.snapToPreviousScale(this._startScale)):Math.min(p,d.snapToNextScale(this._startScale)))/this._currentScale;l.zoom(g);break}}}},An=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const t=e.data,s=t.pointers.size;switch(t.action){case"start":this._currentCount=s,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=s,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=s,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var t,s;this._startEvent=e,(s=(t=this._callbacks).condition)!=null&&s.call(t,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var t,s;(s=(t=this._callbacks).condition)!=null&&s.call(t,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var t,s;(s=(t=this._callbacks).condition)!=null&&s.call(t,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},Dg=class extends me{constructor(e,t,s){super(!0),this.view=e,this.pointerAction=t,this.registerIncoming("drag",s,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new An({start:(t,s)=>{this.view.mapViewNavigation.pan.begin(this.view,s.data),s.stopPropagation()},update:(t,s)=>{this.view.mapViewNavigation.pan.update(this.view,s.data),s.stopPropagation()},end:(t,s)=>{this.view.mapViewNavigation.pan.end(this.view,s.data),s.stopPropagation()},condition:(t,s)=>t===1&&cr(s.data,this.pointerAction)})}_handleDrag(e){const t=this.view.mapViewNavigation;t.pinch.zoomMomentum||t.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},Vg=class extends me{constructor(e,t,s){super(!0),this._view=e,this.pointerAction=t;const n=this._view.mapViewNavigation;this._dragEventSeparator=new An({start:(o,r)=>{n.rotate.begin(this._view,r.data),r.stopPropagation()},update:(o,r)=>{n.rotate.update(this._view,r.data),r.stopPropagation()},end:(o,r)=>{n.rotate.end(),r.stopPropagation()},condition:(o,r)=>o===1&&cr(r.data,this.pointerAction)}),this.registerIncoming("drag",s,o=>this._dragEventSeparator.handle(o))}};function Ge(i){let e=i*i;return i<0&&(e*=-1),e}function Ng(i){return i.translation[0]=0,i.translation[1]=0,i.translation[2]=0,i.heading=0,i.tilt=0,i}function zg(i,e,t){const s=t,n=i.state,o=i.device,r=e.tiltDirection==="forward-down"?1:-1,l=1;return o.deviceType==="standard"?(s.translation[0]=Ge(n.axes[0]),s.translation[1]=Ge(n.axes[1]),s.translation[2]=Ge(n.buttons[7])-Ge(n.buttons[6]),s.heading=Ge(n.axes[2]),s.tilt=Ge(n.axes[3])):o.deviceType==="spacemouse"&&(s.translation[0]=1.2*Ge(n.axes[0]),s.translation[1]=1.2*Ge(n.axes[1]),s.translation[2]=2*-Ge(n.axes[2]),s.heading=1.2*Ge(n.axes[5]),s.tilt=1.2*Ge(n.axes[3])),s.tilt*=r,Rd(s.translation,s.translation,l),s}function Bg(i){return i.translation[0]===0&&i.translation[1]===0&&i.translation[2]===0&&i.heading===0&&i.tilt===0&&i.zoom===0}let Ug=class extends me{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new at,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",t=>this._handleGamePadEvent(t)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([v(()=>{var t;return(t=this._view.navigation.gamepad)==null?void 0:t.enabled},t=>{t?(this._handle.resume(),this._frameTask||(this._frameTask=Bi({update:s=>this._frameUpdate(s.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},U)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){const t=this._view.navigation.gamepad.device;t&&e.data.device!==t||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,Ng(this._transformation)):(this._currentDevice=e.data.device,zg(e.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(e){const t=this._transformation;if(Bg(t))return;const s=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,o=Gg*n*e;kn(s,s,[t.translation[0]*o,-t.translation[1]*o]);const r=1+t.translation[2]*qg*e,l=this._view.constraints.rotationEnabled?-t.heading*Hg*e:0,d=this._view.size,u=[d[0]/2,d[1]];Mc(s,s,r,l,u,d);const h=this._view.constraints.constrain(s,this._view.viewpoint);this._view.viewpoint=h}};const Hg=.06,Gg=.7,qg=6e-4;let jg=class extends me{constructor(e,t,s){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyMap={[t.left]:"left",[t.right]:"right",[t.up]:"up",[t.down]:"down"},this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",s,n=>this._handleKeyUp(n)),this.registerIncoming("blur",s,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const s=this._keyMap[e.data.key];if(this._pressed=s!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),s){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}},Wg=class extends me{constructor(e,t,s){super(!0),this.view=e,this.keys=t,this._pressed=!1,this._keyToDirection={[t.clockwiseOption1]:"clockwise",[t.clockwiseOption2]:"clockwise",[t.counterClockwiseOption1]:"counterClockwise",[t.counterClockwiseOption2]:"counterClockwise",[t.resetOption1]:"reset",[t.resetOption2]:"reset"},this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",s,n=>this._handleKeyUp(n)),this.registerIncoming("blur",s,()=>this._handleBlur())}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,t){const s=e.modifiers;if(s.size>0&&!s.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[e.data.key];if(this._pressed=n!=null,this._pressed){if(t)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var Ni;(function(i){i[i.IN=0]="IN",i[i.OUT=1]="OUT"})(Ni||(Ni={}));let Zg=class extends me{constructor(e,t,s){super(!0),this.view=e,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),t.zoomIn.forEach(n=>this._keysToZoomAction[n]=Ni.IN),t.zoomOut.forEach(n=>this._keysToZoomAction[n]=Ni.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const t=e.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:s}=e.data;if(!(s in this._keysToZoomAction))return;const n=this._keysToZoomAction[s],{mapViewNavigation:o}=this.view;let r=null;switch(n){case Ni.IN:r=o.zoomIn();break;case Ni.OUT:r=o.zoomOut();break;default:return}o.begin(),r.then(()=>o.end()),e.stopPropagation()}};const Kg=.6;let Yg=class extends me{constructor(e,t){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,s=>this._handleMouseWheel(s))}_handleMouseWheel(e){if(!this._view.navigation.mouseWheelZoomEnabled||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const t=this._view.mapViewNavigation,{x:s,y:n,deltaY:o}=e.data,r=1/Kg**(1/60*o),l=t.zoom(r,[s,n]);l&&(this._canZoom=!1,l.catch(()=>{}).then(()=>{this._canZoom=!0,t.end()}))}},Qg=class extends me{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const t=this.view.mapViewNavigation;this._dragEventSeparator=new An({start:(s,n)=>{t.pinch.begin(this.view,n.data),n.stopPropagation()},update:(s,n)=>{t.pinch.update(this.view,n.data),n.stopPropagation()},end:(s,n)=>{t.pinch.end(this.view),n.stopPropagation()},condition:s=>s>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function Oa(i){const e=i.native;return e?{buttons:e.buttons.map(t=>t.pressed?t.value?t.value:1:0),axes:e.axes.map(t=>ef(t,i.axisThreshold))}:{buttons:[],axes:[]}}function Jg(i,e){if(i.axes.length!==e.axes.length||i.buttons.length!==e.buttons.length)return!1;for(let t=0;t<i.axes.length;t++)if(i.axes[t]!==e.axes[t])return!1;for(let t=0;t<i.buttons.length;t++)if(i.buttons[t]!==e.buttons[t])return!1;return!0}function Xg(i){for(let e=0;e<i.axes.length;e++)if(i.axes[e]!==0)return!1;for(let e=0;e<i.buttons.length;e++)if(i.buttons[e]!==0)return!1;return!0}function ef(i,e){const t=Math.abs(i);return t<e?0:Math.sign(i)*(t-e)/(1-e)}let tf=class{constructor(e,t){this._element=e,this._input=t,this._hasEventListeners=!1,this._onConnectGamepad=o=>{this._connectGamepad(o.gamepad)},this._onDisconnectGamepad=o=>{const r=o.gamepad,l=r.index,d=this._inputDevices[l];d&&(this._emitGamepadEvent(r,Oa(d),!1),this._inputDevices.splice(l,1),this._latestUpdate.splice(l,1),this._input.gamepad.devices.remove(d),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const s="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=s&&n,this.supported&&(this._forEachGamepad(o=>this._connectGamepad(o)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const t=new nr(e);t.deviceType!=="unknown"&&(this._inputDevices[e.index]=t,this._input.gamepad.devices.add(t)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=Bi({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),t=this._element.contains(document.activeElement),s=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!t;this._forEachGamepad(n=>{const o=this._inputDevices[n.index];if(!o)return;const r=this._latestUpdate[n.index],l=Oa(o),d=s||Xg(l);r&&(r.timestamp===n.timestamp||!r.active&&d||Jg(r.state,l))||this._emitGamepadEvent(n,l,!d)})}_forEachGamepad(e){const t=window.navigator.getGamepads();for(let s=0;s<t.length;s++){const n=t[s];this._validate(n)&&e(n)}}_emitGamepadEvent(e,t,s){const n=this._latestUpdate[e.index],o=n&&n.active;if(!o&&!s)return;const r=!o&&s?"start":o&&s?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:s},this._callback&&this._callback({device:this._inputDevices[e.index],state:t,action:r})}_validate(e){if(!e||!e.connected)return!1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return!1;return!0}};const Da=Se("trident"),Va=Se("edge"),sf=Se("chrome"),nf=Se("ff"),of=Se("safari"),Ti={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};let dr=class{constructor(e,t){this._input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new tf(e,this._input),this._gamepadSource.onEvent=s=>this._callback("gamepad",s)}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach(e=>{this._releasePointerCaptureSafe(e)}),this._gamepadSource=Ee(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const s=this._active[t];this._element.removeEventListener(Xn[t],s),delete this._active[t]}e&&e.forEach(t=>{if(!this._active[t]&&Xn[t]){const s=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(Xn[t],s),this._active[t]=s}}),this._gamepadSource.hasEventListeners=e&&e.has("gamepad")}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?Ti.touchNone:Ti.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?Ti.touchPan:Ti.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(Ti.touchNone),this._element.classList.remove(Ti.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,t){const s=dc(this._element,e);return dr.test.disableSubpixelCoordinates&&(s.x=Math.round(s.x),s.y=Math.round(s.y)),t.x=s.x,t.y=s.y,t}_handleKey(e,t){const s=mm(t);s&&e==="key-up"&&this._keyDownState.delete(s);const n={native:t,key:s,repeat:s&&this._keyDownState.has(s)};s&&e==="key-down"&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,t){const s=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,s)}_handlePointerPreventDefault(e,t){const s=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,s)}_handleMouseWheel(e,t){let s=t.deltaY;switch(t.deltaMode){case 0:(Da||Va)&&(s=s/document.documentElement.clientHeight*600);break;case 1:s*=30;break;case 2:s*=900}Da||Va?s*=.7:sf||of?s*=.6:nf&&(s*=1.375);const n=100,o=Math.abs(s);o>n&&(s=s/o*200/(1+Math.exp(-.02*(o-n))));const r=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:s});this._callback(e,r)}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t)}_handleDefault(e,t){const s={native:t};t.preventDefault(),this._callback(e,s)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};dr.test={disableSubpixelCoordinates:!1};const Xn={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let rf=class extends me{constructor(){super(!0),this.registerIncoming("context-menu",e=>{e.data.native.preventDefault()})}};function ur(i,e){return Math.abs(e.x-i.x)+Math.abs(e.y-i.y)}function af(i,e){const t=e.x-i.x,s=e.y-i.y;return Math.sqrt(t*t+s*s)}function lf(i,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:fe()},i.length===0)return e;if(i.length===1)return e.center.x=i[0].x,e.center.y=i[0].y,e;if(i.length===2){const[$,O]=i,[R,x]=[O.x-$.x,O.y-$.y];return e.radius=Math.sqrt(R*R+x*x)/2,e.center.x=($.x+O.x)/2,e.center.y=($.y+O.y)/2,e}let t=0,s=0;for(let $=0;$<i.length;$++)t+=i[$].x,s+=i[$].y;t/=i.length,s/=i.length;const n=i.map($=>$.x-t),o=i.map($=>$.y-s);let r=0,l=0,d=0,u=0,h=0,p=0,g=0;for(let $=0;$<n.length;$++){const O=n[$],R=o[$],x=O*O,H=R*R;r+=x,l+=H,d+=O*R,u+=x*O,h+=H*R,p+=O*H,g+=R*x}const f=.5*(u+p),_=.5*(h+g),T=r*l-d*d,w=(f*l-_*d)/T,E=(r*_-d*f)/T,P=fe(w+t,E+s);return{radius:Math.sqrt(w*w+E*E+(r+l)/i.length),center:P}}function vi(i){const{native:e}=i,{pointerId:t,button:s,pointerType:n}=e;return n==="mouse"?`${t}:${s}`:`${n}`}const He={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};let cf=class extends me{constructor(e=He.maximumDoubleClickDelay,t=He.maximumDoubleClickDistance,s=He.maximumDoubleTouchDelay,n=He.maximumDoubleTouchDistance,o=gn){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=o,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=ei(e.doubleClickTimer))}get hasPendingInputs(){return fn(this._pointerState,e=>e.doubleClickTimer!=null)}_clearDoubleClickTimer(e,t){const s=this._pointerState.get(e);s&&(s.doubleClickTimer=ei(s.doubleClickTimer),t&&this._click.emit(s.event.data,void 0,s.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);t.pointerDownCount===1&&this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_getPointerId(e){const{pointerId:t,pointerType:s,button:n}=e.native;return s==="mouse"?`${t}:${n}`:`${s}`}_handleImmediateClick(e){const t=e.data,{pointerType:s}=t.native,n=this._getPointerId(t);if(!this._pointerState.has(n))return void this._startClick(e);const o=this._pointerState.get(n),{data:r,modifiers:l}=o.event,d=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;ur(r,t)>d?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),o.pointerDownCount===2&&this._doubleClick.emit(r,void 0,l))}_handlePointerDown(e){const t=vi(e.data),s=this._pointerState.get(t);s&&(s.pointerDownCount+=1)}_startClick(e){const{data:t}=e,{native:{pointerType:s}}=t,n=vi(t),o=s==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),o),l=1;this._pointerState.set(n,{event:e,doubleClickTimer:r,pointerDownCount:l}),this.refreshHasPendingInputs()}},df=class extends me{constructor(e=He.maximumDoubleClickDelay,t=He.maximumDoubleClickDistance,s=He.maximumDoubleTouchDelay,n=He.maximumDoubleTouchDistance,o=gn){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=o,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=fe(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new An({start:(r,l)=>this._dragStart(r,l),update:(r,l)=>this._dragUpdate(l),end:(r,l)=>this._dragEnd(l)}),this.registerIncoming("drag",r=>this._dragEventSeparator.handle(r)),this.registerIncoming("pointer-down",r=>this._handlePointerDown(r)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=ei(e.doubleTapTimeout)})}get hasPendingInputs(){return fn(this._pointerState,e=>e.doubleTapTimeout!=null)}_clearPointerDown(e){const t=this._pointerState.get(e);t&&(t.doubleTapTimeout=ei(t.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_createDoubleTapDragData(e,t,s){const{button:n,buttons:o,pointer:r,pointers:l,pointerType:d,timestamp:u}=s;return{action:e,delta:t,button:n,buttons:o,pointer:r,pointers:l,pointerType:d,timestamp:u}}_dragStart(e,t){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:s,modifiers:n}=t,{center:o}=s;this._dragStartCenter=o;const r=this._createDoubleTapDragData("begin",fe(0,0),s);this._doubleTapDrag.emit(r,void 0,n),t.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:s}=e,{center:n}=t,o=fe(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("update",o,t);this._doubleTapDrag.emit(r,void 0,s),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:t,modifiers:s}=e,{center:n}=t,o=fe(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("end",o,t);this._doubleTapDrag.emit(r,void 0,s),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:t}=e,s=vi(t),n=this._pointerState.get(s),{pointerType:o}=t.native;if(n){const r=o==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(s),ur(n.event.data,t)>r?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:t}=e,{pointerType:s}=t.native,n=vi(t),o=s==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,r=this._clock.setTimeout(()=>this._clearPointerDown(n),o);this._pointerState.set(n,{event:e,doubleTapTimeout:r}),this.refreshHasPendingInputs()}},uf=class extends me{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,t,s,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:t.buttons,timestamp:n,pointers:hf(this._activePointerMap),pointer:t,angle:s.angle,radius:s.radius,center:s.center}}_addPointer(e){const t=e.native.pointerId,s=Fs(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(t,n);const o=Ys(n,kc(this._activePointerMap));n.initialAngle=o,n.lastAngle=o,this._updatePointerAngles(s)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const t=e.native.pointerId,s=this._activePointerMap.get(t);s?s.event=e:this._addPointer(e)}_removePointer(e){const t=Fs(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(t)}_updatePointerAngles(e){const t=Fs(this._activePointerMap);this._activePointerMap.forEach(s=>{s.initialAngle=Ys(s,t)-e,s.lastAngle=Ys(s,t)-e})}_emitEvent(e,t,s){const n=Fs(this._activePointerMap);this._drag.emit(this._createPayload(e,t,n,s),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const t=e.data.native.pointerId,s=Pn(e.timestamp);this._activePointerMap.get(t)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,s),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(t)):(this._removePointer(t),this._emitEvent("removed",e.data,Pn(e.timestamp))))}_handlePointerDrag(e){const t=e.data,s=t.currentEvent,n=Pn(e.timestamp);switch(t.action){case"start":case"update":this._isDragging?this._activePointerMap.has(s.native.pointerId)?(this._updatePointer(s),!this._isCurrentDragSuppressed&&this._emitEvent("update",s,n)):(this._addPointer(s),this._emitEvent("added",s,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(s),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",s,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function kc(i){const e=[];return i.forEach(t=>{e.push(fe(t.event.x,t.event.y))}),lf(e)}function Fs(i){const e=kc(i);let t=0;return i.forEach(s=>{let n=Ys(s,e),o=n-s.lastAngle;for(;o>Math.PI;)o-=2*Math.PI;for(;o<-Math.PI;)o+=2*Math.PI;n=s.lastAngle+o,s.lastAngle=n;const r=n-s.initialAngle;t+=r}),t/=i.size||1,{angle:t,radius:e.radius,center:e.center}}function hf(i){const e=new Map;return i.forEach((t,s)=>e.set(s,t.event)),e}function Ys(i,e){const t=i.event,s=t.x-e.center.x,n=t.y-e.center.y;return Math.atan2(n,s)}var Na;(function(i){i[i.Left=0]="Left",i[i.Middle=1]="Middle",i[i.Right=2]="Right",i[i.Back=3]="Back",i[i.Forward=4]="Forward",i[i.Undefined=-1]="Undefined"})(Na||(Na={}));let pf=class extends me{constructor(e=He.maximumDoubleClickDelay,t=He.maximumDoubleClickDistance,s=He.maximumDoubleTouchDelay,n=He.maximumDoubleTouchDistance,o=gn){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=t,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=o,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const t=e.data,s=vi(t);if(!this._pointerState.has(s)){const n={downButton:t.native.button,immediateDoubleClick:null};this._pointerState.set(s,n),this.startCapturingPointer(t.native)}}_handlePointerUp(e){const t=e.data,s=vi(t),n=this._pointerState.get(s);if(n&&n.downButton===t.native.button){const o=n.immediateDoubleClick;if(o){o.timeoutHandle.remove();const r=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;ur(o,e.data)>r?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,o.modifiers),this._removeState(t))}else this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,t){const s=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;t.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),s)}}_removeState(e){const t=vi(e);this._pointerState.delete(t),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}};const es={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};let mf=class extends me{constructor(e=es.maximumClickDelay,t=es.movementUntilMouseDrag,s=es.movementUntilPenDrag,n=es.movementUntilTouchDrag,o=es.holdDelay,r=gn){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=t,this._movementUntilPenDrag=s,this._movementUntilTouchDrag=n,this._holdDelay=o,this._clock=r,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",l=>{this._handlePointerLoss(l,"pointer-up")}),this.registerIncoming("pointer-capture-lost",l=>{this._handlePointerLoss(l,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",l=>{this._handlePointerLoss(l,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=ei(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const t=e.data,s=t.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const r=this._pointerState.get(s);if(r){if(!r.isDragging){const l=r.previousEvent;this._pointerHold.emit(l,void 0,e.modifiers),r.holdEmitted=!0}r.holdTimeout=null}},this._holdDelay));const o={startEvent:t,previousEvent:t,startTimestamp:e.timestamp,isDragging:!1,downButton:t.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(s,o),this.startCapturingPointer(t.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_createPointerDragData(e,t,s){return{action:e,startEvent:t.startEvent,previousEvent:t.previousEvent,currentEvent:s}}_handlePointerMove(e){const t=e.data,s=t.native.pointerId,n=this._pointerState.get(s);n&&(n.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",n,t),void 0,n.modifiers):af(t,n.startEvent)>this._getDragThreshold(t.native.pointerType)&&this._startDragging(e),n.previousEvent=t)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const t=e.data,s=t.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,s===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,t)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),e.timestamp))})}_handlePointerLoss(e,t){const s=e.data,n=s.native.pointerId,o=this._pointerState.get(n);o&&(o.holdTimeout!=null&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",o,t==="pointer-up"?s:o.previousEvent),void 0,o.modifiers):t==="pointer-up"&&o.downButton===s.native.button&&e.timestamp-o.startTimestamp<=this._maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(s),this._pointerState.delete(n),this.stopCapturingPointer(s.native),this._pointerState.size===0&&this._moveHandle.pause())}};const Os={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let ci=class extends V{constructor(){super(...arguments),this._handles=new at}initialize(){const e=()=>{var t;return(t=this.view)==null?void 0:t.ready};this._handles.add([At(()=>!e(),()=>this._disconnect()),At(e,()=>this._connect())])}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=Ee(this._inputManager)}_connect(){const e=this.view.surface,t=new dr(e,this.view.input),s=[new pf,new mf,new cf,new uf(this.view.navigation),new df],n=new et({eventSource:t,recognizers:s});n.installHandlers("prevent-context-menu",[new rf],Yt.INTERNAL),n.installHandlers("navigation",[new Qg(this.view),new Ug(this.view),new Yg(this.view),new Fa(this.view),new Fa(this.view,[Os.counter]),new Dg(this.view,"primary"),new jg(this.view,Os.pan),new Zg(this.view,Os.zoom),new Wg(this.view,Os.rotate),new Vg(this.view,"secondary"),new Og(this.view,"touch")],Yt.INTERNAL),this.view.viewEvents.connect(n),this._source=t,this._inputManager=n,v(()=>{var o,r;return(r=(o=this.view)==null?void 0:o.navigation)==null?void 0:r.browserTouchPanEnabled},o=>{this._source&&(this._source.browserTouchPanningEnabled=!o)},U)}get test(){return{inputManager:this._inputManager}}};a([c()],ci.prototype,"view",void 0),a([c()],ci.prototype,"latestPointerType",null),a([c()],ci.prototype,"latestPointerLocation",null),a([c()],ci.prototype,"multiTouchActive",null),ci=a([b("esri.views.2d.input.MapViewInputManager")],ci);const gf=ci;let ff=0,Ht=class extends V{constructor(){super(...arguments),this.color=new Jt([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}get version(){return ff++}};a([c({readOnly:!0})],Ht.prototype,"version",null),a([c({type:Jt})],Ht.prototype,"color",void 0),a([c({type:Jt})],Ht.prototype,"haloColor",void 0),a([c()],Ht.prototype,"haloOpacity",void 0),a([c()],Ht.prototype,"fillOpacity",void 0),Ht=a([b("esri.views.2d.support.HighlightOptions")],Ht);const Ac=Ht,_f=i=>i.includes("Brush");let Pc=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),_f(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function yf(i,e,t,s,n,o,r,l){let d;i.ignorePadding&&(s={left:0,right:0,top:0,bottom:0}),i.width!=null&&i.height!=null?d=[i.width,i.height]:i.width==null&&i.height!=null?d=[i.height,i.height]:i.width!=null&&i.height==null?d=[i.width,i.width]:i.width==null&&i.height==null&&(d=null);const u=t[0]-(s.left+s.right),h=t[1]-(s.top+s.bottom);let p,g,f=i.area||{x:0,y:0,width:u,height:h};if(d){const _=u/h,T=d[0]/d[1];if(T>_){const w=f.width/T;f={x:f.x,y:Math.round(f.y+(f.height-w)/2),width:f.width,height:Math.round(w)}}else{const w=f.height*T;f={x:Math.round(f.x+(f.width-w)/2),y:f.y,width:Math.round(w),height:f.height}}}else d=[f.width,f.height];return d[0]>f.width?(p=Math.min(d[0]/f.width,e),g=d[0]/f.width/p):(p=1,g=d[0]/f.width),{resolutionScale:p,cropArea:{x:Math.round((f.x+s.left)*p),y:Math.round((f.y+s.top)*p),width:Math.round(f.width*p),height:Math.round(f.height*p)},outputScale:g,format:n,quality:o,children:r,rotation:l}}function vf(i,e,t){const{ctx:s,canvas:n}=$c(i,t),o=s.getImageData(0,0,i.width,i.height),r=Mf(n,e);return Sc(n),{dataUrl:r,data:o}}function wf(i,e){const{ctx:t,canvas:s}=$c(i,e),n=t.getImageData(0,0,i.width,i.height);return Sc(s),n}function $c(i,e){const t=bf();e.premultipliedAlpha&&xf(i),t.width=i.width,t.height=i.height;const s=t.getContext("2d");return s.putImageData(i,0,0),e.flipY&&Ef(s),{ctx:s,canvas:t}}function Sc(i){i.width=0,i.height=0}function bf(){return F(eo)&&(eo=document.createElement("canvas")),eo}let eo=null;function Mf(i,e){const t=kf[e.format],s=e.quality/100;return i.toDataURL(t,s)}function If(i,e){const t=Tf(i),s=Pf[t];return{format:t,quality:Hi(e??s,0,100)}}function Cf(i,e){return e/Math.max(i[0],i[1])}function l0(i,e,t,s=0,n=0,o=i.width-s,r=i.height-n,l=!1){const{data:d}=i,{width:u,height:h,data:p}=e,g=o/u,f=r/h,_=Math.ceil(g/2),T=Math.ceil(f/2),w=i.width;for(let E=0;E<h;E++)for(let P=0;P<u;P++){const $=4*(P+(l?h-E-1:E)*u);let O=0,R=0,x=0,H=0,G=0,z=0;const Z=(E+.5)*f;for(let ne=Math.floor(E*f);ne<(E+1)*f;ne++){const Re=Math.abs(Z-(ne+.5))/T,oe=(P+.5)*g,Me=Re*Re;for(let ve=Math.floor(P*g);ve<(P+1)*g;ve++){const ct=Math.abs(oe-(ve+.5))/_,dt=Math.sqrt(Me+ct*ct);if(dt>=1)continue;let Ne=2*dt*dt*dt-3*dt*dt+1;const ze=4*(s+ve+(n+ne)*w);z+=Ne*d[ze+3],R+=Ne,!t&&d[ze+3]<255&&(Ne=Ne*d[ze+3]/255),x+=Ne*d[ze],H+=Ne*d[ze+1],G+=Ne*d[ze+2],O+=Ne}}p[$]=x/O,p[$+1]=H/O,p[$+2]=G/O,p[$+3]=z/R}return e}function Tf(i){switch(i){case"png":case"jpg":case"jpeg":return i;default:return Af}}function Ef(i){i.save(),i.globalCompositeOperation="copy",i.scale(1,-1),i.translate(0,-i.canvas.height),i.drawImage(i.canvas,0,0),i.restore()}function xf(i){const e=i.data,t=e.length;for(let s=0;s<t;s+=4){const n=e[s+3];if(n!==255&&n>0){const o=255/n;e[s+0]=e[s+0]*o,e[s+1]=e[s+1]*o,e[s+2]=e[s+2]*o}}}const kf={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},za=98,Af="png",Pf={png:100,jpg:za,jpeg:za};function $f(i){const e=Wu(i);if(!e.available)return new k("webgl:required","WebGL is required but not supported.");if(i==="3d"&&e.majorPerformanceCaveat)return new k("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.");if(!e.supportsHighPrecisionFragment)return new k("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported.");if(!e.supportsVertexShaderSamplers)return new k("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported.");if(e.type===Zu.WEBGL1){if(!e.supportsElementIndexUint)return new k("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported.");if(!e.supportsStandardDerivatives)return new k("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported.");if(!e.supportsInstancedArrays)return new k("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported.")}return null}function Sf(i){return i&&"nodeType"in i}function Rf(i){return i&&typeof i.render=="function"}const Ba={component:"esri-component"};let di=class extends V{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(e){const t=this._get("node");e!==t&&(e&&e.classList.add(Ba.component),t&&t.classList.remove(Ba.component),this._set("node",e))}castNode(e){return e?typeof e=="string"||Sf(e)?(this._set("widget",null),hl(e)):(Rf(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};a([c({dependsOn:[]})],di.prototype,"id",null),a([c()],di.prototype,"node",null),a([be("node")],di.prototype,"castNode",null),a([c({readOnly:!0})],di.prototype,"widget",void 0),di=a([b("esri.views.ui.Component")],di);const Qs=di,Lf={left:0,top:0,bottom:0,right:0},Rc={bottom:30,top:15,right:15,left:15},to="manual",Ie={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function Ff(i){return i&&!i._started&&typeof i.postMixInProperties=="function"&&typeof i.buildRendering=="function"&&typeof i.postCreate=="function"&&typeof i.startup=="function"}function io(i){const e=i,t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?i:null}function so(i,{top:e,bottom:t,left:s,right:n}){i.style.top=e,i.style.bottom=t,i.style.left=s,i.style.right=n}let bt=class extends qi.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new at,this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&so(t,this._toPxPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const t=this._innerContainer;t&&so(t,this._toPxPosition(this.padding))},this._initContainers()}initialize(){this._handles.add([v(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,U),v(()=>this.padding,this._applyUIPadding,U)])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(e){const t=this._get("container");e!==t&&(e&&(e.classList.add(Ie.ui),dp(e),this._attachContainers(e)),t&&(t.classList.remove(Ie.ui),so(t,{top:"",bottom:"",left:"",right:""}),pl(t)),this._set("container",e))}get height(){const e=this.get("view.height")||0;if(e===0)return e;const t=this._getViewPadding(),s=t.top+t.bottom;return Math.max(e-s,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...Rc,...e}}get width(){const e=this.get("view.width")||0;if(e===0)return e;const t=this._getViewPadding(),s=t.left+t.right;return Math.max(e-s,0)}add(e,t){let s,n;if(Array.isArray(e))return void e.forEach(r=>this.add(r,t));const o=io(e);o&&({index:s,position:t,component:e,key:n}=o),t&&typeof t=="object"&&({index:s,key:n,position:t}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,s,n)}remove(e,t){if(!e)return;if(Array.isArray(e))return e.map(n=>this.remove(n,t));const s=this._find(e);if(s){const n=this._componentToKey;if(n.has(e)&&n.get(e)!==t)return;const o=this._components.indexOf(s);return s.node.parentNode&&s.node.parentNode.removeChild(s.node),this._componentToKey.delete(e),this._components.splice(o,1)[0]}}empty(e){return Array.isArray(e)?e.map(t=>this.empty(t)).reduce((t,s)=>t.concat(s)):(e=e||to)===to?Array.prototype.slice.call(this._manualContainer.children).filter(t=>!t.classList.contains(Ie.corner)).map(t=>this.remove(t)):this._isValidPosition(e)?Array.prototype.slice.call(this._cornerNameToContainerLookup[e].children).map(this.remove,this):null}move(e,t){if(Array.isArray(e)&&e.forEach(r=>this.move(r,t)),!e)return;let s;const n=io(e)||io(t);if(n&&(s=n.index,t=n.position,e=n.component||e),t&&!this._isValidPosition(t))return;const o=this.remove(e);o&&this.add(o,{position:t,index:s})}find(e){if(!e)return null;const t=this._findById(e);return t&&(t.widget||t.node)}getPosition(e){for(const t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,s,n){e instanceof Qs||(e=new Qs({node:e})),this._place({component:e,position:t,index:s}),this._components.push(e),n&&this._componentToKey.set(e,n)}_find(e){return e?e instanceof Qs?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){return this.get("view.padding")||Lf}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Ie.innerContainer),e.classList.add(Ie.cornerContainer);const t=document.createElement("div");t.classList.add(Ie.innerContainer),t.classList.add(Ie.manualContainer);const s=document.createElement("div");s.classList.add(Ie.topLeft),s.classList.add(Ie.corner),e.appendChild(s);const n=document.createElement("div");n.classList.add(Ie.topRight),n.classList.add(Ie.corner),e.appendChild(n);const o=document.createElement("div");o.classList.add(Ie.bottomLeft),o.classList.add(Ie.corner),e.appendChild(o);const r=document.createElement("div");r.classList.add(Ie.bottomRight),r.classList.add(Ie.corner),e.appendChild(r),this._innerContainer=e,this._manualContainer=t;const l=rt();this._cornerNameToContainerLookup={"top-left":s,"top-right":n,"bottom-left":o,"bottom-right":r,"top-leading":l?n:s,"top-trailing":l?s:n,"bottom-leading":l?r:o,"bottom-trailing":l?o:r},this._positionNameToContainerLookup={manual:t,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const t=e.component,s=e.position||to,n=e.index,o=this._positionNameToContainerLookup[s],r=n>-1;if(Ff(t.widget)&&t.widget.startup(),!r)return void o.appendChild(t.node);const l=Array.prototype.slice.call(o.children);if(n===0)return void(o.firstChild?br(t.node,o.firstChild):o.appendChild(t.node));n>=l.length?o.appendChild(t.node):br(t.node,l[n])}_toPxPosition(e){return{top:this._toPxUnit(e.top),left:this._toPxUnit(e.left),right:this._toPxUnit(e.right),bottom:this._toPxUnit(e.bottom)}}_toPxUnit(e){return e===0?"0":e+"px"}_findByComponent(e){let t,s=null;return this._components.some(n=>(t=n===e,t&&(s=n),t)),s}_findById(e){let t,s=null;return this._components.some(n=>(t=n.id===e,t&&(s=n),t)),s}_findByNode(e){let t,s=null;return this._components.some(n=>(t=n.node===e,t&&(s=n),t)),s}};a([c()],bt.prototype,"container",null),a([c()],bt.prototype,"height",null),a([c({value:Rc})],bt.prototype,"padding",null),a([be("padding")],bt.prototype,"castPadding",null),a([c()],bt.prototype,"view",void 0),a([c()],bt.prototype,"width",null),bt=a([b("esri.views.ui.UI")],bt);const Of=bt;function Ua(i,e){return i&&"copyright"in i&&(!e||typeof i.originOf=="function"&&i.originOf("copyright")==="user")}function Df(i,e){return i.length!==e.length||i.some((t,s)=>t.text!==e[s].text)}function Ds(i,e,t){!t||!e||i.find(s=>s.layerView===e&&s.text===t)||i.push({text:t,layerView:e})}function Vf(i){return i.type==="bing-maps"}const $t=[];let Si=class extends gl{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new ee,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const s=this.get("view.allLayerViews");s&&this.handles.add(s.map(n=>v(()=>{var o;return[n.suspended,(o=n.layer)==null?void 0:o.attributionVisible]},()=>this._updateAttributionItems())),"suspension"),t&&t.removed&&t.removed.forEach(n=>{this._pendingAttributions.delete(n),this._fetchedAttributionData.delete(n)}),this._updateAttributionItems()},this.handles.add([Ze(()=>{var t;return(t=this.view)==null?void 0:t.allLayerViews},"change",t=>this._allLayerViewsChange(t),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),At(()=>{var t;return((t=this.view)==null?void 0:t.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.get("view.allLayerViews");$t.length=0,e?(e.forEach(t=>{var o;if(t.suspended||!((o=t.layer)!=null&&o.attributionVisible))return;const s=t.layer;if(Ua(s,"user"))return void Ds($t,t,s.copyright);if(s.hasAttributionData){if(this._fetchedAttributionData.has(t)){const r=this._fetchedAttributionData.get(t);return void(r?Ds($t,t,this._getDynamicAttribution(r,this.view,s)):Ua(s)&&Ds($t,t,s.copyright))}return void this._fetchAttributionData(t)}const n=s.get("portalItem.accessInformation");Ds($t,t,n||s.copyright)}),Df(this.items,$t)&&(this.items.removeAll(),this.items.addMany($t)),$t.length=0,this.notifyChange("state")):this._clear()}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const t=await ku(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const s=t.ok?this._createContributionIndex(t.value,Vf(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,s)}this._updateAttributionItems()}_createContributionIndex(e,t){const s=e.contributors,n={};if(!s)return n;for(let o=0;o<s.length;o++){const r=s[o],l=r.coverageAreas;if(!l)return;for(const d of l){const u=d.bbox,h=d.zoomMin-(t&&d.zoomMin?1:0),p=d.zoomMax-(t&&d.zoomMax?1:0),g={xmin:u[1],ymin:u[0],xmax:u[3],ymax:u[2],spatialReference:Is.WGS84},f={extent:No(g),attribution:r.attribution||"",score:d.score!=null?d.score:100,id:o};for(let _=h;_<=p;_++)n[_]=n[_]||[],n[_].push(f)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(e,t,s){const{extent:n,scale:o}=t;let r=s.tileInfo.scaleToZoom(o);if(r=Math.min(e.maxKey,Math.round(r)),!n||r==null||r<=-1)return"";const l=e[r],d=vd(n.center.clone().normalize(),t.spatialReference),u={};return l?l.filter(h=>{const p=!u[h.id]&&d&&al(h.extent,d);return p&&(u[h.id]=!0),p}).sort((h,p)=>p.score-h.score||h.objectId-p.objectId).map(h=>h.attribution).join(", "):""}};a([c({readOnly:!0,type:ee})],Si.prototype,"items",void 0),a([c({readOnly:!0})],Si.prototype,"state",null),a([c()],Si.prototype,"view",void 0),Si=a([b("esri.widgets.Attribution.AttributionViewModel")],Si);const Lc=Si,St={base:"esri-attribution esri-widget",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let Te=class extends pe{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(s=>s.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.iconClass=St.widgetIcon,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Lc}initialize(){this.addHandles(Ze(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,t)=>(e.includes(t.text)||e.push(t.text),e),[]).join(this.itemDelimiter)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[St.open]:this._isOpen};return m("div",{bind:this,class:this.classes(St.base,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return m("div",{class:St.poweredBy},"Powered by"," ",m("a",{class:St.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,s=t?"0":"",{attributionText:n}=this,o={[St.sourcesOpen]:e,[St.interactive]:t};return m("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(St.sources,o),innerHTML:n,tabindex:s})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let t=!1;const{clientHeight:s,clientWidth:n,scrollWidth:o}=e,r=o>n,l=this._attributionTextOverflowed!==r;if(this._attributionTextOverflowed=r,l&&(t=!0),this._isOpen){const d=s<this._prevSourceNodeHeight;this._prevSourceNodeHeight=s,d&&(this._isOpen=!1,t=!0)}t&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};a([c()],Te.prototype,"_isOpen",void 0),a([c()],Te.prototype,"_isInteractive",null),a([c()],Te.prototype,"_attributionTextOverflowed",void 0),a([c()],Te.prototype,"_prevSourceNodeHeight",void 0),a([c({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],Te.prototype,"attributionText",null),a([c()],Te.prototype,"iconClass",void 0),a([c()],Te.prototype,"itemDelimiter",void 0),a([c()],Te.prototype,"label",null),a([c(),re("esri/widgets/Attribution/t9n/Attribution")],Te.prototype,"messages",void 0),a([c()],Te.prototype,"view",null),a([c({type:Lc})],Te.prototype,"viewModel",void 0),a([$e()],Te.prototype,"_toggleState",null),Te=a([b("esri.widgets.Attribution")],Te);const Nf=Te,zf="esri.widgets.CompassViewModel";let ui=class extends xn(V){constructor(e){super(e),this._handles=new at,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(v(()=>this.view,this._updateRotationWatcher,U))}destroy(){this._handles=ei(this._handles),this.view=null}get canShowNorth(){const e=this.get("view.spatialReference");return!(!e||!e.isWebMercator&&!e.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const e={};this.view.type==="2d"?e.rotation=0:e.heading=0,this.callGoTo({target:e})}_updateForRotation(e){e!=null&&(this.orientation={z:e})}_updateForCamera(e){if(!e)return;const t=-e.heading;this.orientation={x:0,y:0,z:t}}_updateRotationWatcher(e){this._handles.removeAll(),e&&this._handles.add(e.type==="2d"?v(()=>e==null?void 0:e.rotation,this._updateForRotation,U):v(()=>e==null?void 0:e.camera,this._updateForCamera,U))}};a([c({readOnly:!0})],ui.prototype,"canShowNorth",null),a([c()],ui.prototype,"orientation",void 0),a([c({readOnly:!0})],ui.prototype,"state",null),a([c()],ui.prototype,"view",void 0),ui=a([b(zf)],ui);const Fc=ui,Rt={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let it=class extends pe{constructor(e,t){super(e,t),this.iconClass=Rt.widgetIcon,this.messages=null,this.viewModel=new Fc}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:t}=this.viewModel,s=t==="disabled",n=(t==="rotation"?"rotation":"compass")=="compass",o=s?-1:0,r={[Rt.disabled]:s,[Rt.interactive]:!s},l={[Rt.northIcon]:n,[Rt.rotationIcon]:!n},{messages:d}=this;return m("div",{bind:this,class:this.classes(Rt.base,r),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:o,"aria-label":d.reset,title:d.reset},m("span",{"aria-hidden":"true",class:this.classes(Rt.icon,l),styles:this._toRotationTransform(e)}),m("span",{class:Rt.text},d.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(e){return{transform:`rotateZ(${e.z}deg)`}}};a([c()],it.prototype,"goToOverride",null),a([c()],it.prototype,"iconClass",void 0),a([c()],it.prototype,"label",null),a([c(),re("esri/widgets/Compass/t9n/Compass")],it.prototype,"messages",void 0),a([c()],it.prototype,"view",null),a([c({type:Fc})],it.prototype,"viewModel",void 0),a([$e()],it.prototype,"_reset",null),it=a([b("esri.widgets.Compass")],it);const Bf=it;let Ri=class extends V{constructor(i){super(i),this.navigationMode="pan",this.view=null}initialize(){this.own(At(()=>{var i;return(i=this.view)==null?void 0:i.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){return this.get("view.ready")&&this.view.type==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction=this.navigationMode==="pan"?"pan":"rotate"}};a([c({readOnly:!0})],Ri.prototype,"state",null),a([c()],Ri.prototype,"navigationMode",void 0),a([c()],Ri.prototype,"view",void 0),Ri=a([b("esri.widgets.NavigationToggleViewModel")],Ri);const Oc=Ri,Be={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let st=class extends pe{constructor(e,t){super(e,t),this.iconClass=Be.widgetIcon,this.messages=null,this.viewModel=new Oc}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}toggle(){return this.viewModel.toggle()}render(){const e=this.get("viewModel.state")==="disabled",t=this.get("viewModel.navigationMode")==="pan",s={[Be.disabled]:e,[Be.isLayoutHorizontal]:this.layout==="horizontal"},n={[Be.activeButton]:t},o={[Be.activeButton]:!t},r=e?-1:0,l=this.messages.toggle;return m("div",{bind:this,class:this.classes(Be.base,s),onclick:this._toggle,onkeydown:this._toggle,tabIndex:r,"aria-label":l,title:l},m("div",{class:this.classes(Be.button,Be.panButton,n)},m("span",{class:Be.panIcon})),m("div",{class:this.classes(Be.button,Be.rotateButton,o)},m("span",{class:Be.rotationIcon})))}_toggle(){this.toggle()}};a([c()],st.prototype,"iconClass",void 0),a([c()],st.prototype,"label",null),a([c({value:"vertical"})],st.prototype,"layout",null),a([c(),re("esri/widgets/NavigationToggle/t9n/NavigationToggle")],st.prototype,"messages",void 0),a([c()],st.prototype,"view",null),a([c({type:Oc})],st.prototype,"viewModel",void 0),a([$e()],st.prototype,"_toggle",null),st=a([b("esri.widgets.NavigationToggle")],st);const Uf=st,ts={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let Gt=class extends pe{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title=""}render(){const e=this.enabled?0:-1,t={[ts.disabled]:!this.enabled,[ts.interactive]:this.enabled},s={[this.iconClass]:!!this.iconClass};return m("div",{bind:this,class:this.classes(ts.button,t),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:e,title:this.title},m("span",{"aria-hidden":"true",role:"presentation",class:this.classes(ts.icon,s)}),m("span",{class:ts.iconText},this.title))}_triggerAction(){this.action.call(this)}};a([c()],Gt.prototype,"action",void 0),a([c()],Gt.prototype,"enabled",void 0),a([c()],Gt.prototype,"iconClass",void 0),a([c()],Gt.prototype,"title",void 0),a([$e()],Gt.prototype,"_triggerAction",null),Gt=a([b("esri.widgets.IconButton")],Gt);const Ha=Gt;let Li=class extends V{get canZoomIn(){if(!this.get("view.ready"))return!1;const i=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMaxScale");return e===0||i>e}get canZoomOut(){if(!this.get("view.ready"))return!1;const i=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMinScale");return e===0||i<e}};a([c({readOnly:!0})],Li.prototype,"canZoomIn",null),a([c({readOnly:!0})],Li.prototype,"canZoomOut",null),a([c()],Li.prototype,"view",void 0),Li=a([b("esri.widgets.Zoom.ZoomConditions2D")],Li);const Hf=Li;let Fi=class extends V{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};a([c({readOnly:!0})],Fi.prototype,"canZoomIn",null),a([c({readOnly:!0})],Fi.prototype,"canZoomOut",null),a([c()],Fi.prototype,"view",void 0),Fi=a([b("esri.widgets.Zoom.ZoomConditions3D")],Fi);const Gf=Fi;let qt=class extends V{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return M(this._zoomConditions)&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return M(this._zoomConditions)&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Hf({view:e}):e.type==="3d"&&(this._zoomConditions=new Gf({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){if(!this.canZoomIn)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomIn():ps(e.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const e=this.view;e.type==="2d"?e.mapViewNavigation.zoomOut():ps(e.goTo({zoomFactor:.5}))}};a([c()],qt.prototype,"_zoomConditions",void 0),a([c()],qt.prototype,"canZoomIn",null),a([c()],qt.prototype,"canZoomOut",null),a([c({readOnly:!0})],qt.prototype,"state",null),a([c()],qt.prototype,"view",null),qt=a([b("esri.widgets.Zoom.ZoomViewModel")],qt);const Dc=qt,is={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let Mt=class extends pe{constructor(e,t){super(e,t),this.iconClass=is.widgetIcon,this.messages=null,this.viewModel=new Dc}initialize(){this._zoomInButton=new Ha({action:this.zoomIn.bind(this),iconClass:is.zoomInIcon}),this._zoomOutButton=new Ha({action:this.zoomOut.bind(this),iconClass:is.zoomOutIcon})}destroy(){this._zoomInButton=Ee(this._zoomInButton),this._zoomOutButton=Ee(this._zoomOutButton)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e=this.viewModel,t={[is.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:s,canZoomOut:n}=e;this._zoomInButton.enabled=s,this._zoomOutButton.enabled=n;const{zoomIn:o,zoomOut:r}=this.messages;return this._zoomInButton.title=o,this._zoomOutButton.title=r,m("div",{class:this.classes(is.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};a([c()],Mt.prototype,"iconClass",void 0),a([c()],Mt.prototype,"label",null),a([c({value:"vertical"})],Mt.prototype,"layout",null),a([c(),re("esri/widgets/Zoom/t9n/Zoom")],Mt.prototype,"messages",void 0),a([c()],Mt.prototype,"view",null),a([c({type:Dc})],Mt.prototype,"viewModel",void 0),Mt=a([b("esri.widgets.Zoom")],Mt);const qf=Mt;function jf(i){return i&&i.view!==void 0}let Js=class extends Of{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[]}initialize(){this._handles.add([v(()=>this.components,this._componentsWatcher.bind(this),U),v(()=>this.view,this._updateViewAwareWidgets.bind(this),U)])}_add(e,t,s,n){if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;e=this._createComponent(e)}super._add(e,t,s,n)}_removeComponents(e){e.forEach(t=>{const s=this._find(t);s&&(this.remove(s),s.destroy())})}_updateViewAwareWidgets(e){this.components.forEach(t=>{const s=this._find(t),n=s&&s.widget;jf(n)&&(n.view=e)})}_componentsWatcher(e,t){this._removeComponents(t),this._addComponents(e),this._adjustPadding(e)}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t}}_addComponents(e){this.constructed&&e.forEach(t=>this.add(this._createComponent(t),this._defaultPositionLookup[t]))}_createComponent(e){const t=this._createWidget(e);if(t)return new Qs({id:e,node:t})}_createWidget(e){return e==="attribution"?this._createAttribution():e==="compass"?this._createCompass():e==="navigation-toggle"?this._createNavigationToggle():e==="zoom"?this._createZoom():void 0}_createAttribution(){return new Nf({view:this.view})}_createCompass(){return new Bf({view:this.view})}_createNavigationToggle(){return new Uf({view:this.view})}_createZoom(){return new qf({view:this.view})}};a([c()],Js.prototype,"components",void 0),Js=a([b("esri.views.ui.DefaultUI")],Js);const Wf=Js;let Xs=class extends Wf{constructor(i){super(i),this.components=["attribution","zoom"]}};a([c()],Xs.prototype,"components",void 0),Xs=a([b("esri.views.ui.2d.DefaultUI2D")],Xs);const Vc=Xs;var Oo;let en=Oo=class extends Ke{constructor(i){super(i),this.color=new Jt([0,0,0,1])}clone(){return new Oo(oo({color:this.color}))}};a([c({type:Jt,json:{write:!0}})],en.prototype,"color",void 0),en=Oo=a([b("esri.webmap.background.ColorBackground")],en);const Zf=en;let Nc,zc,Bc,Uc,Hc,Gc;async function Kf(){const[,{GraphicsView2D:i,GraphicContainer:e,LabelManager:t,MapViewNavigation:s,MagnifierView2D:n,Stage:o}]=await Promise.all([I(()=>import("./webglDeps-2d5668fb.js"),["assets/webglDeps-2d5668fb.js","assets/VertexArrayObject-e1e46e3f.js","assets/Error-4ed679d7.js","assets/string-9c5e03f7.js","assets/typedArrayUtil-d02f10a8.js","assets/Texture-c2297638.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/context-util-abf86a85.js","assets/enums-64ab819c.js","assets/ProgramTemplate-1afb8353.js","assets/programUtils-fb70f3b3.js"]),I(()=>import("./mapViewDeps-6709a1e1.js"),["assets/mapViewDeps-6709a1e1.js","assets/Error-4ed679d7.js","assets/string-9c5e03f7.js","assets/typedArrayUtil-d02f10a8.js","assets/promiseUtils-930cba29.js","assets/reactiveUtils-b0e56010.js","assets/cast-6d78d3c7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/mat3f32-d3d088e8.js","assets/request-e4299080.js","assets/preload-helper-101896b7.js","assets/_commonjsHelpers-a430e9ea.js","assets/imageutils-418e9de0.js","assets/utils-1bc9587b.js","assets/parser-f68dd732.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/mat4-62d5e6a4.js","assets/common-701a4199.js","assets/Evented-b378ccab.js","assets/enums-4ca4641f.js","assets/MaterialKey-cec287ae.js","assets/Utils-b6ef920f.js","assets/mathUtils-daf59e84.js","assets/enums-ef042d89.js","assets/enums-64ab819c.js","assets/Texture-c2297638.js","assets/context-util-abf86a85.js","assets/VertexElementDescriptor-2925c6af.js","assets/heatmapUtils-90a13d85.js","assets/vec4f64-018b3fa6.js","assets/Color-b7b9e6bb.js","assets/BufferPool-b738111d.js","assets/WGLContainer-69c7e591.js","assets/mat3-45e3f2eb.js","assets/vec2f32-461e65a9.js","assets/pixelUtils-a3529416.js","assets/vec2f64-e0301652.js","assets/VertexArrayObject-e1e46e3f.js","assets/ProgramTemplate-1afb8353.js","assets/StyleDefinition-ae208a94.js","assets/config-1337d16e.js","assets/GeometryUtils-c093d234.js","assets/earcut-58237617.js","assets/vec2-f978aef8.js","assets/featureConversionUtils-d9ec654e.js","assets/jsonUtils-5115c7e5.js","assets/Extent-d5fff12d.js","assets/Polyline-42dcc920.js","assets/OptimizedFeature-1bba65b5.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/enums-bfc9e4e9.js","assets/programUtils-fb70f3b3.js","assets/RenderingContext-b8526b4a.js","assets/OrderIndependentTransparency-602f26c2.js","assets/floatRGBA-305df8f3.js","assets/ExpandedCIM-6cfcc2f7.js","assets/arcadeOnDemand-72a1843c.js","assets/geometry-70b2a4a5.js","assets/typeUtils-b6c52390.js","assets/jsonMap-5afaf2ff.js","assets/BidiEngine-836b7ef6.js","assets/aaBoundingRect-ca34962d.js","assets/mat2d-80bd93af.js","assets/Rect-ea14f53a.js","assets/quantizationUtils-8770173e.js","assets/GeometryUtils-eebff0a0.js","assets/rasterizingUtils-18039619.js","assets/pbf-e4fd0249.js","assets/Matcher-3b379faa.js","assets/TileStrategy-40f1ecb0.js","assets/TileStore-a368d16c.js","assets/Queue-8aae62d3.js","assets/TileKey-ed432ae5.js","assets/rbush-8e36784a.js","assets/quickselect-322ec8e1.js","assets/Query-066f2ccf.js","assets/TimeExtent-0fd238ea.js","assets/enumeration-497ef064.js","assets/Field-bb784640.js","assets/fieldType-9bddd3d4.js","assets/Clonable-58355d3c.js","assets/visualVariablesUtils-9310c846.js","assets/visualVariablesUtils-4833b8d3.js","assets/tileUtils-23b52606.js","assets/TileClipper-48ccb501.js","assets/assets-6ba3cd63.js","assets/Geometry-daada628.js","assets/defaultsJSON-b087dd4d.js","assets/LRUCache-4d56ba4d.js","assets/MemCache-1e028041.js","assets/devEnvironmentUtils-5002a058.js","assets/Portal-95b0f852.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/locale-30120714.js","assets/PortalGroup-813428fa.js","assets/PortalUser-4126c27a.js","assets/persistableUrlUtils-d18becd9.js","assets/styleUtils-cde65ff5.js","assets/CircularArray-ace048ef.js","assets/imageUtils-c2d0d1ae.js","assets/HandleOwner-6ac6f00a.js","assets/FeatureSetReader-9e0a2b1d.js","assets/centroid-7800ee74.js","assets/lengthUtils-0dde2114.js","assets/unitUtils-b69647a1.js","assets/sizeVariableUtils-d4870b0d.js","assets/BaseGraphicContainer-dfe82663.js","assets/normalizeUtilsSync-1f26dd3f.js","assets/normalizeUtils-91a64c2b.js","assets/projectionSupport-38cc9dc5.js","assets/projection-6146477c.js","assets/SimpleObservable-e0897cc6.js","assets/zscale-72b4355d.js","assets/json-48e3ea08.js","assets/labelingInfo-69496ac8.js","assets/symbols-12804594.js","assets/CIMSymbol-33ea3902.js","assets/fieldUtils-2efa8993.js","assets/Symbol-1bb07043.js","assets/opacityUtils-8b7acc4e.js","assets/aaBoundingBox-33fc923c.js","assets/Collection-42fe629f.js","assets/collectionUtils-3d8a9611.js","assets/labelUtils-87bb22ff.js","assets/jsonUtils-c8fbfbd0.js","assets/FeatureContainer-e4e1ed67.js","assets/TileContainer-efb37002.js","assets/capabilities-5736b16f.js","assets/schemaUtils-37c9a4a8.js","assets/LayerFloorInfo-0d02c503.js","assets/diffUtils-713e5c9b.js","assets/createSymbolSchema-976acefa.js","assets/rendererUtils-a093890e.js","assets/FeatureReductionLayer-d24025a2.js","assets/BlendLayer-7a735871.js","assets/PopupTemplate-29fe62b5.js","assets/number-c7f1bfee.js","assets/Identifiable-57df9761.js","assets/UniqueValueRenderer-8e382829.js","assets/LegendOptions-e31ff575.js","assets/colorRamps-c00f504b.js","assets/Graphic-34c50417.js","assets/compilerUtils-eefea0ec.js","assets/jsonUtils-7ad404a7.js","assets/DictionaryLoader-46cd8e54.js","assets/deprecate-46fadabd.js","assets/OperationalLayer-007b4c8b.js","assets/ElevationInfo-618e96ba.js","assets/util-94bdf933.js","assets/ComputedAttributeStorage-85833802.js","assets/FieldsIndex-0e507864.js","assets/vec3f32-4322908d.js","assets/GraphicContainer-ec6d8bc9.js","assets/asyncUtils-18831bb1.js","assets/requestImageUtils-2fafd053.js","assets/Basemap-fd6389f3.js","assets/loadAll-1ae88564.js","assets/PortalItem-bbd2de41.js","assets/messages-634811b5.js","assets/writeUtils-44b0e78b.js","assets/layerUtils-6996b9ea.js","assets/CollectionFlattener-b89887c0.js","assets/TablesMixin-019c9675.js","assets/Layer-f9f81f65.js","assets/Cyclical-1a93cb12.js","assets/workers-e5f6a313.js","assets/Connection-f53be4bf.js","assets/intl-a5c99ea3.js","assets/TileInfo-92f7dc61.js","assets/widget-4becb80f.js","assets/uuid-73213768.js","assets/byteSizeEstimations-90c5a50d.js","assets/executeQueryJSON-710cf21c.js","assets/query-4348ce6f.js","assets/pbfQueryUtils-91f50fb5.js","assets/queryZScale-1674984c.js","assets/FeatureSet-622e3076.js","assets/RelationshipQuery-b5b427dc.js","assets/utils-cb77f8a5.js","assets/ItemCache-b4db8f82.js","assets/TopFeaturesQuery-7da1d7c1.js","assets/FeatureLayer-95c99e68.js","assets/MultiOriginJSONSupport-1970ed0f.js","assets/FeatureLayerBase-6192846c.js","assets/HeightModelInfo-645087b5.js","assets/arcgisLayerUrl-02fe1a62.js","assets/editsZScale-e318eb4a.js","assets/APIKeyMixin-f90cfebd.js","assets/ArcGISService-f6f32fbc.js","assets/CustomParametersMixin-5e3018da.js","assets/EditBusLayer-1372e92b.js","assets/OrderedLayer-7b3473c8.js","assets/PortalLayer-5c12bdba.js","assets/RefreshableLayer-84ec1468.js","assets/ScaleRangeLayer-c6a35aba.js","assets/TemporalLayer-ac8e2c3d.js","assets/TimeInfo-a1791ae0.js","assets/FeatureTemplate-773a8865.js","assets/FeatureType-6c50f4e3.js","assets/fieldProperties-9268e64b.js","assets/versionUtils-5ccafbea.js","assets/styleUtils-45e2d86c.js","assets/popupUtils-40f744cb.js","assets/Scheduler-343fdba6.js","assets/GraphicsLayer-18770580.js","assets/ViewingMode-fb6259a5.js","assets/unitBezier-881ac1eb.js","assets/datetime-7cb5ae9e.js"])]);zc=i,Bc=e,Uc=t,Hc=s,Gc=n,Nc=o}const Ga=160;function Yf(i){return i&&i.declaredClass==="esri.Viewpoint"}let L=class extends vh(Vm(Nm(ng))){constructor(i){super(i),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new sn({getCollections:()=>{var e,t;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,this.layerViews,(t=this.basemapView)==null?void 0:t.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.rendering=!1,this.supersampleScreenshotsEnabled=!1,this.supportsGround=!1,this._stationaryTimer=null,this.frameTask=new Ag(this),this._pePromise=null,this.floors=new ee,this.highlightOptions=new Ac,this.inputManager=new gf({view:this}),this.map=null,this.resizeAlign="center",this.spatialReferenceLocked=!1,this.timeline=new Pc,this.type="2d",this.ui=new Vc,this._pixelFormat={flipY:!0,premultipliedAlpha:!0},this.constraints=new xc,this.padding={top:0,right:0,bottom:0,left:0},this.handles.add([v(()=>this.viewpoint,()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(Ga)},ys),this.on("resize",e=>this._resizeHandler(e)),v(()=>{var e;return(e=this.animationManager)==null?void 0:e.animation},e=>{this.animation=e})]),Fd()}destroy(){this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null,this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new qu(this.featuresTilingScheme)}get initialExtentRequired(){var r;const{scale:i,constraints:e,center:t,viewpoint:s,extent:n}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((r=this.map.initialViewProperties)!=null&&r.viewpoint))&&!n&&(e!=null&&e.effectiveLODs||(o=-1),(!t||i===0&&o===-1)&&(!s||!M(s.targetGeometry)||s.targetGeometry.type!=="extent"&&!s.scale))}get resourceManager(){return this._stage.resourceManager}get textureManager(){return this._stage.painter.textureManager}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get _projectionEngineLoaded(){return!!vs()||(this._pePromise||(this._pePromise=vn().finally(()=>{this._pePromise=null})),!1)}get typeSpecificPreconditionsReady(){const i=this._getDefaultViewpoint();if(!i)return!1;const e=this.spatialReference,t=Ve(i.targetGeometry);return!!yn(t.spatialReference,e)||this._projectionEngineLoaded}set animation(i){const e=this._get("animation");if(i===e)return;if(e&&e.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i),this.frameTask.animationInProgress=!0;const t=()=>{var s;i===this._get("animation")&&(this._set("animation",null),(s=this.frameTask)==null||s.requestFrame()),this.frameTask&&(this.frameTask.animationInProgress=!1)};i.when(t,t)}get background(){return Jf(this.map)?this.map.initialViewProperties.background:null}set background(i){this._override("background",i)}get center(){if(!this.ready)return this._get("center");const{center:i,spatialReference:e}=this.state.paddedViewState;return new X({x:i[0],y:i[1],spatialReference:e})}set center(i){if(i==null)return;if(!this.ready)return this._set("center",i),void this.notifyChange("initialExtentRequired");let e;try{e=this._project(i,this.spatialReference)}catch(s){return void N.getLogger(this.declaredClass).error(new k("mapview:invalid-center","could not project the value in the view's spatial reference",{input:i,error:s}))}const t=this.viewpoint;Ao(t,t,e),this.viewpoint=t}set constraints(i){const e=this._get("constraints");e&&(this.handles.remove("map-view-constraints"),e.destroy()),this._set("constraints",i),i&&(i.view=this,this.ready&&(this.state.viewpoint=i.fit(this.state.paddedViewState.viewpoint)),this.handles.add(v(()=>i.version,()=>{this.ready&&this.state&&(this.state.viewpoint=i.fit(this.state.paddedViewState.viewpoint))},ys),"map-view-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(i){if(i==null)return;if(!i.width||!i.height)return void N.getLogger(this.declaredClass).error(new k("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",i),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");let e;try{e=this._project(i,this.spatialReference)}catch(s){return void N.getLogger(this.declaredClass).error(new k("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:s}))}const t=this.viewpoint;pg(t,t,e,this.size,{constraints:this.constraints}),this.viewpoint=t}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(i){this.ready?(this.state.padding=i,this._set("padding",this.state.padding)):this._set("padding",i)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(i){if(isNaN(i))return;if(!this.ready)return void this._set("rotation",i);const e=this.viewpoint;Tg(e,e,i),this.viewpoint=e}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(i){if(!i||isNaN(i))return;if(!this.ready){this._set("scale",i),this._set("zoom",-1);const t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}const e=this.viewpoint;$a(e,e,i),this.viewpoint=e}get stationary(){return!(this.animation||this.navigating||this.resizing||this._stationaryTimer)}get updating(){var e,t,s;const i=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(n=>!n.destroyed&&!("layerViews"in n)&&n.updating===!0));if(Se("esri-2d-log-updating")){const n=this.allLayerViews.reduce((o,r)=>({...o,[r.layer.id]:!r.destroyed&&!("layerViews"in r)&&r.updating}),{});console.log(`Updating MapView: ${i}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(e=this.layerViewManager)==null?void 0:e.updating}
-> labelManager.updating: ${(t=this.labelManager)==null?void 0:t.updating}
-> graphicsView.updating: ${(s=this.graphicsView)==null?void 0:s.updating}
-> allLayerViews: ${JSON.stringify(n)}
`)}return i}get viewpoint(){if(!this.ready)return this._get("viewpoint");const i=this.state.paddedViewState;return i&&i.viewpoint.clone()}set viewpoint(i){if(i==null)return;if(!this.ready)return this._set("viewpoint",i),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");let e,t;try{e=this._project(i,this.spatialReference),!i.scale||isNaN(i.scale)?t=new k("mapview:invalid-viewpoint",`invalid scale value of ${i.scale}`):F(i.targetGeometry)&&(t=new k("mapview:invalid-viewpoint","geometry not defined"))}catch(n){t=new k("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:n})}if(t)return void N.getLogger(this.declaredClass).error(t);this._scaleBeforeChangingSpatialReference=null;const s=new We({targetGeometry:new X,scale:0,rotation:0});Ye(s,e),this.constraints.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this.frameTask.requestFrame(),this._set("viewpoint",s)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(i){if(i==null)return;if(!this.ready){this._set("zoom",i),this._set("scale",0);const t=this._get("extent");return t&&(this._set("extent",null),this._set("center",t.center)),void this.notifyChange("initialExtentRequired")}if(!this.constraints.effectiveLODs)return void this._set("zoom",-1);const e=this.viewpoint;$a(e,e,this.constraints.zoomToScale(i)),this.viewpoint=e,this._set("zoom",this.constraints.scaleToZoom(this.scale))}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}goTo(i,e){if(i)return this.animation&&(this.animation=null),this._createAnimation(),zo(()=>this.ready,e).then(()=>{const t={animate:!0,...e},s=dg(i,this);return this.animation.update(s),this._gotoTask={},t.animate?this._gotoAnimated(s,t):this._gotoImmediate(s,t)});N.getLogger(this.declaredClass).error("#goTo()","target cannot be null or undefined")}async hitTest(i,e){const t=Ea(i)?Ta(this,i):i;if(!this.ready||isNaN(t.x)||isNaN(t.y))return{screenPoint:t,results:[]};let s=new Set,n=!1,o=null,r=null;e!=null&&e.include?ja(e.include,qa(this,h=>s.add(h),h=>{o||(o=new Set),o.add(h)},h=>s.add(h),()=>n=!0)):(n=!0,s=new Set(this.allLayerViews)),e!=null&&e.exclude&&ja(e.exclude,qa(this,h=>s.delete(h),h=>{r||(r=new Set),r.add(h)}));const l=this.allLayerViews.filter(h=>!h.suspended&&s.has(h)).reverse(),d=this.toMap(t);let u=[...n?this.graphicsView.hitTest(d).map(h=>({type:"graphic",graphic:h,layer:null,mapPoint:d})):[],...await Promise.all(l.map(h=>h.hitTest(d,t)).toArray())].filter(M).flat().filter(M);return o&&(u=u.filter(h=>!("graphic"in h)||!h.graphic||o.has(Do(h.graphic)))),r&&(u=u.filter(h=>!("graphic"in h)||!h.graphic||r.has(Do(h.graphic)))),{screenPoint:t,results:u}}async takeScreenshot(i){const e=this._createScreenshotPlan(i),t=await this._stage.takeScreenshot(e);return vf(t,{format:e.format,quality:e.quality,rotation:0,disableDecorations:!1},this._pixelFormat)}async _takeScreenshot(i){const e=this._createScreenshotPlan(i),t=await this._stage.takeScreenshot(e);return wf(t,this._pixelFormat)}_createScreenshotPlan(i){i=i||{};const e=this.supersampleScreenshotsEnabled?Math.min(4,Cf(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let t;i.layers?(t=[],i.layers.forEach(o=>{const r=this.allLayerViews.find(l=>l.layer.id===o.id);r&&"container"in r&&r.container&&t.push(r.container)})):t=this._stage.children;const{format:s,quality:n}=If(i.format,i.quality);return yf(i,e,this.size,this.padding,s,n,t,i.rotation)}get test(){return{takeScreenshot:i=>this._takeScreenshot(i)}}toMap(i){if(!this.ready)return null;const e=Ea(i)?Ta(this,i):i,t=[0,0],[s,n]=this.state.toMap(t,[e.x,e.y]),o=this.spatialReference;return new X({x:s,y:n,spatialReference:o})}toScreen(i){if(!this.ready)return null;const e=this._project(i,this.spatialReference),t=[e.x,e.y];return this.state.toScreen(t,t),fe(t[0],t[1])}on(i,e,t,s){return this.inputManager&&this.viewEvents.on(i,e,t,s)||super.on(i,e)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}whenLayerView(i){return super.whenLayerView(i)}graphicChanged(i){this.graphicsView&&this.graphicsView.graphicUpdateHandler(i)}whenReady(){return new Promise(i=>{this.ready?i(this):this._resolveWhenReady.push(i)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var i,e,t;return this.map&&"initialViewProperties"in this.map&&((e=(i=this.map)==null?void 0:i.initialViewProperties)==null?void 0:e.spatialReference)||((t=this.defaultsFromMap)==null?void 0:t.spatialReference)||null}hasLayerViewModule(i){return Ra.hasLayerViewModule(i)}importLayerView(i){return Ra.importLayerView(i)}pixelSizeAt(){return this.ready?this.state.resolution:(N.getLogger(this.declaredClass).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}popupHitTest(i){return this.hitTest(i).then(e=>({...e,mapPoint:this.toMap(i)}))}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}validate(){let i=$f(this.type);return Se("safari")&&Se("safari")<9&&(i=new k("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Se("safari")})),M(i)?(N.getLogger(this.declaredClass).warn("#validate()",i.message),Promise.reject(i)):Kf()}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new ko),this.animation}_cancellableGoTo(i,e,t){const s=()=>i===this._gotoTask,n=t.then(()=>{s()&&(this.animation=null)}).catch(r=>{throw s()&&(this.animation=null,e.done||(e.stop(),this.frameTask.animationInProgress=!1)),r}),o=new Promise(r=>r(n));return e.when().catch(()=>{s()&&o.cancel&&o.cancel()}),o}_gotoImmediate(i,e){const t=this._gotoTask,s=this.animation,n=i.then(o=>{if(Kt(e),t!==this._gotoTask)throw new k("view:goto-interrupted","Goto was interrupted");this.viewpoint=s.target=o,s.finish()});return this._cancellableGoTo(t,s,n)}_flipStationary(i){return this._stationaryTimer!==null||(this._stationaryTimer=setTimeout(()=>{this._stationaryTimer=null;const e=performance.now()-this._lastStationaryEventTimestamp;e<Ga&&(this._stationaryTimer=this._flipStationary(e))},i)),this._stationaryTimer}_getDefaultViewpoint(){var w,E,P,$;const{constraints:i,initialExtent:e,map:t,padding:s,size:n}=this;if(!i)return null;const o=t&&"initialViewProperties"in t&&t.initialViewProperties,r={zoom:this._get("zoom"),scale:this._get("scale"),center:this._get("center"),extent:this._get("extent"),rotation:this._get("rotation"),viewpoint:this._get("viewpoint"),spatialReference:this._userSpatialReference};i.effectiveLODs?r.zoom!==-1&&(r.scale=i.zoomToScale(r.zoom)):r.zoom=-1;let l=null,d=null,u=0;const h=r.viewpoint&&r.viewpoint.rotation,p=r.viewpoint&&r.viewpoint.targetGeometry;M(p)&&(p.type==="extent"?l=p:p.type==="point"&&(d=p,u=r.viewpoint.scale));const g=r.extent||l||((E=Ve((w=o==null?void 0:o.viewpoint)==null?void 0:w.targetGeometry))==null?void 0:E.extent)||e,f=r.center||d||(g==null?void 0:g.center),_=r.scale||u||((P=o==null?void 0:o.viewpoint)==null?void 0:P.scale)||g&&_s(g,[n[0]-s.left-s.right,n[1]-s.top-s.bottom]),T=r.rotation||h||(($=o==null?void 0:o.viewpoint)==null?void 0:$.rotation)||0;return f&&_?new We({targetGeometry:f,scale:_,rotation:T}):null}_gotoAnimated(i,e){const t=this._gotoTask,s=this.animation,n=i.then(o=>{if(Kt(e),t!==this._gotoTask)throw new k("view:goto-interrupted","Goto was interrupted");return s.update(o),this.animationManager.animate(s,this.viewpoint,e),s.when().then(()=>{},()=>{})});return this._cancellableGoTo(t,s,n)}_project(i,e){var n;const t=i&&i.targetGeometry||i;if(!e)return i;if(!t)return null;if(e.imageCoordinateSystem||(n=t.spatialReference)!=null&&n.imageCoordinateSystem||_n(e,t.spatialReference))return i;const s=Cs(t,e);if(!s)throw new k("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:t,spatialReference:e});return Yf(i)?(i.targetGeometry=s,i):s}_resizeHandler(i){if(!this.ready)return;const e=this.state;let t=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();e.size=[i.width,i.height],Cg(t,t,s,this.state.paddedViewState.size,this.resizeAlign),t=this.constraints.constrain(t,null),this.state.viewpoint=t}_startup(){var l,d;this.timeline.begin("MapView Startup");const i=this._getDefaultViewpoint(),e=i.targetGeometry;try{this._project(i,this.spatialReference)}catch(u){N.getLogger(this.declaredClass).warn(new mr("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:e.toJSON(),spatialReference:this.spatialReference,error:u})),i.targetGeometry=((l=this.defaultsFromMap.extent)==null?void 0:l.center)||new X({x:0,y:0,spatialReference:this.spatialReference})}(d=this.constraints)==null||d.fit(i),this._set("state",new Fg({padding:this._get("padding"),size:this.size,viewpoint:i})),this.graphics.owner=this;const t=new Nc(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this._stage=t,this._magnifierView=new Gc,this._magnifierView.magnifier=this.magnifier;const s=new Uc({view:this});this._set("labelManager",s);const n=new kg({view:this});this._set("animationManager",n);const o=new Hc({view:this,animationManager:n});this._set("mapViewNavigation",o),this._setupSpatialReferenceDependentProperties(),this.handles.add([this.rootLayerViews.on("change",()=>this._updateStageChildren()),t.on("post-render",()=>this._set("rendering",t.renderRequested)),t.on("will-render",()=>this._set("rendering",t.renderRequested)),t.on("webgl-error",u=>this.fatalError=u.error),v(()=>this.stationary,u=>t.stationary=u,oi),v(()=>this.background,u=>{t.background=u,this._magnifierView.background=u},oi),v(()=>this.magnifier,u=>this._magnifierView.magnifier=u,oi),v(()=>this.renderingOptions,u=>t.renderingOptions=u,oi),v(()=>this.highlightOptions,u=>t.highlightOptions=u,oi),v(()=>this.state.id,()=>t.state=this.state,oi)],"map-view"),this._updateStageChildren();const r=this._resolveWhenReady;this._resolveWhenReady=[],r.forEach(u=>u(this)),this.timeline.end("MapView Startup"),this.frameTask&&this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.handles.remove("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask&&this.frameTask.stop(),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null),this._set("ready",!1);const{center:[i,e],spatialReference:t,rotation:s,scale:n}=this.state.paddedViewState,o=new X({x:i,y:e,spatialReference:t});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("spatialReference",t),this._set("state",null),this.animation=null}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach(e=>{this._stage.addChild(e.container)});const i=this.graphicsView;this._stage.addChild(i.container),this._stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const i=new ju(Nd.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",i);const e=new zc({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Bc(i)});this.frameTask.graphicsView=e,this._set("graphicsView",e)}_destroySpatialReferenceDependentProperties(){const i=this.graphicsView;this._set("graphicsView",null),this.frameTask.graphicsView=null,i.destroy(),this._set("featuresTilingScheme",null)}_spatialReferenceChanged(i){if(!this.ready)return;this.frameTask.stop();for(const l of this.allLayerViews)l.processDetach();this._destroySpatialReferenceDependentProperties();const e=this.state.paddedViewState.clone();if(F(this._scaleBeforeChangingSpatialReference))this._scaleBeforeChangingSpatialReference=e.scale;else{const l=e.viewpoint.clone();l.scale=this._scaleBeforeChangingSpatialReference,e.viewpoint=l}const t=e.clone(),[s,n]=e.center;let o=null;try{o=this._project(new X({x:s,y:n,spatialReference:e.spatialReference}),i)}catch(l){vs()||N.getLogger(this.declaredClass).warn(new mr("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o.toJSON(),spatialReference:i,error:l}))}o||(o=new X({x:0,y:0,spatialReference:i}));const r=Ao(new We({targetGeometry:new X,scale:0,rotation:0}),e.viewpoint,o);t.viewpoint=r;try{const d=[e.size[0]/2,e.size[1]/2],u=[d[0]+20,d[1]],h=e.toMap([0,0],u),{x:p,y:g}=this._project(new X({x:h[0],y:h[1],spatialReference:e.spatialReference}),i);h[0]=p,h[1]=g,t.toScreen(h,h);const f=Mg(d,h,u),_=Math.hypot(h[0]-d[0],h[1]-d[1])/20;!Number.isFinite(_)||Math.abs(_)>4?(r.rotation=0,r.targetGeometry=new X({x:0,y:0,spatialReference:i})):(r.scale*=_,r.scale>Se("mapview-srswitch-adjust-rotation-scale-threshold")?r.rotation=0:r.rotation+=Number.isFinite(f)?f:0)}catch{}this._get("constraints").constrain(r,null),this._get("state").viewpoint=r,this._stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const l of this.allLayerViews)l.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}};L.type="2d",a([c({readOnly:!0})],L.prototype,"animationManager",void 0),a([c({constructOnly:!0})],L.prototype,"deactivatedWebGLExtensions",void 0),a([c({constructOnly:!0})],L.prototype,"debugWebGLExtensions",void 0),a([c({readOnly:!0})],L.prototype,"featuresTilingScheme",void 0),a([c({readOnly:!0})],L.prototype,"fullOpacity",void 0),a([c({readOnly:!0})],L.prototype,"graphicsTileStore",null),a([c()],L.prototype,"graphicsView",void 0),a([c({readOnly:!0})],L.prototype,"state",void 0),a([c()],L.prototype,"initialExtentRequired",null),a([c()],L.prototype,"labelManager",void 0),a([c({readOnly:!0})],L.prototype,"resourceManager",null),a([c({readOnly:!0})],L.prototype,"textureManager",null),a([c({readOnly:!0})],L.prototype,"mapViewNavigation",void 0),a([c({constructOnly:!0})],L.prototype,"renderCanvas",void 0),a([c()],L.prototype,"renderingOptions",void 0),a([c({readOnly:!0})],L.prototype,"rendering",void 0),a([c({constructOnly:!0})],L.prototype,"supersampleScreenshotsEnabled",void 0),a([c({readOnly:!0})],L.prototype,"supportsGround",void 0),a([c()],L.prototype,"_stationaryTimer",void 0),a([c()],L.prototype,"_defaultsFromMapSettings",null),a([c()],L.prototype,"_pePromise",void 0),a([c({readOnly:!0})],L.prototype,"typeSpecificPreconditionsReady",null),a([c()],L.prototype,"animation",null),a([c({type:Zf})],L.prototype,"background",null),a([c({value:null,type:X,dependsOn:["state.id","ready"]})],L.prototype,"center",null),a([c({type:xc})],L.prototype,"constraints",null),a([c({value:null,type:Gi,dependsOn:["state.id","ready"]})],L.prototype,"extent",null),a([c()],L.prototype,"floors",void 0),a([c({type:Ac})],L.prototype,"highlightOptions",void 0),a([c({readOnly:!0})],L.prototype,"inputManager",void 0),a([c()],L.prototype,"map",void 0),a([c({value:{top:0,right:0,bottom:0,left:0},cast:i=>({top:0,right:0,bottom:0,left:0,...i})})],L.prototype,"padding",null),a([c()],L.prototype,"resizeAlign",void 0),a([c({readOnly:!0,dependsOn:["state.id"]})],L.prototype,"resolution",null),a([c({value:0,type:Number,dependsOn:["state.id","ready"]})],L.prototype,"rotation",null),a([c({value:0,type:Number,dependsOn:["state.id","ready"]})],L.prototype,"scale",null),a([c({constructOnly:!0})],L.prototype,"spatialReferenceLocked",void 0),a([c()],L.prototype,"stationary",null),a([c({type:Pc,readOnly:!0})],L.prototype,"timeline",void 0),a([c({readOnly:!0})],L.prototype,"type",void 0),a([c({readOnly:!0})],L.prototype,"updating",null),a([c({value:null,type:We,dependsOn:["state.id","ready"]})],L.prototype,"viewpoint",null),a([c({value:-1,dependsOn:["state.id","ready"]})],L.prototype,"zoom",null),a([c({readOnly:!0})],L.prototype,"navigating",null),a([c({type:Vc})],L.prototype,"ui",void 0),L=a([b("esri.views.MapView")],L);const Qf=L;function Do(i){var t,s;const e=i.getObjectId();return e?`${((t=i.layer)==null?void 0:t.uid)??((s=i.sourceLayer)==null?void 0:s.uid)??"MapView"}/${e}`:`"MapView/${i.uid}`}function qa(i,e,t,s,n){return o=>{if(o instanceof lt){if(o.layer===i)n==null||n();else{const r=i.allLayerViews.find(l=>l.layer===o.layer);r&&(s==null||s(r))}t(Do(o))}else{const r=i.allLayerViews.find(l=>l.layer===o);r&&e(r)}}}function ja(i,e){if(i)if(gr(i))for(const t of i)if(gr(t))for(const s of t)e(s);else e(t);else e(i)}function Jf(i){return(i==null?void 0:i.declaredClass)==="esri.WebMap"}let It=class extends xn(qi.EventedAccessor){constructor(e){super(e),this._initialViewpoint=null,this._goingHomeController=null,this.go=this.go.bind(this)}destroy(){this._cancelGo(),this.view=null}get state(){return this.get("view.ready")?this._goingHomeController?"going-home":"ready":"disabled"}set view(e){this._initialViewpoint=null,this._set("view",e),e&&e.when().then(()=>{this.view===e&&(this._initialViewpoint=e.viewpoint.clone(),this.notifyChange("viewpoint"))})}get viewpoint(){return this._get("viewpoint")||this._initialViewpoint}set viewpoint(e){this._set("viewpoint",e)}async go(){if(!this.get("view.ready"))throw new k("home:disabled-state","Cannot go when disabled.");this._cancelGo(),this.emit("go");const e=new AbortController;this._goingHomeController=e;try{await this.view.when(),await this.callGoTo({target:this.viewpoint,options:{signal:e.signal}})}catch{}this._goingHomeController=null}cancelGo(){this._cancelGo()}_cancelGo(){const{_goingHomeController:e}=this;e&&e.abort(),this._goingHomeController=null}};a([c()],It.prototype,"_goingHomeController",void 0),a([c({readOnly:!0})],It.prototype,"state",null),a([c()],It.prototype,"view",null),a([c({type:We})],It.prototype,"viewpoint",null),a([c()],It.prototype,"go",null),a([c()],It.prototype,"cancelGo",null),It=a([b("esri.widgets.Home.HomeViewModel")],It);const qc=It,Ei={base:"esri-home esri-widget--button esri-widget",esriIcon:"esri-icon",loadingIcon:"esri-icon-loading-indicator",rotatingIcon:"esri-rotating",widgetIcon:"esri-icon-home",disabled:"esri-disabled"};let De=class extends pe{constructor(e,t){super(e,t),this.iconClass=Ei.widgetIcon,this.messages=null,this.messagesCommon=null,this.viewModel=new qc}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get viewpoint(){return this.viewModel.viewpoint}set viewpoint(e){this.viewModel.viewpoint=e}cancelGo(){this.viewModel.cancelGo()}go(){return this.viewModel.go()}render(){var o;const e=(o=this.viewModel)==null?void 0:o.state,{messagesCommon:t,messages:s}=this,n={[Ei.disabled]:e==="disabled"};return m("div",{bind:this,class:this.classes(Ei.base,n),role:"button",tabIndex:0,onclick:this._go,onkeydown:this._go,"aria-label":s.widgetLabel,title:e==="going-home"?t.cancel:s.title},this.renderIcon())}renderIcon(){var s;const e=(s=this.viewModel)==null?void 0:s.state,t={[Ei.esriIcon]:!0,[this.iconClass]:e!=="going-home",[Ei.loadingIcon]:e==="going-home",[Ei.rotatingIcon]:e==="going-home"};return m("span",{"aria-hidden":"true",class:this.classes(t)})}_go(){const{viewModel:e}=this;e.state==="going-home"?e.cancelGo():e.go()}};a([c()],De.prototype,"goToOverride",null),a([c()],De.prototype,"iconClass",void 0),a([c()],De.prototype,"label",null),a([c(),re("esri/widgets/Home/t9n/Home")],De.prototype,"messages",void 0),a([c(),re("esri/t9n/common")],De.prototype,"messagesCommon",void 0),a([c()],De.prototype,"uiStrings",void 0),a([c()],De.prototype,"view",null),a([c({type:qc}),Xo("go")],De.prototype,"viewModel",void 0),a([c()],De.prototype,"viewpoint",null),a([$e()],De.prototype,"_go",null),De=a([b("esri.widgets.Home")],De);const Xf=De;function jc(i){if(!i)return null;if(wd(i)&&i.wkid){const e=Od[i.wkid];if(e)return e}if(i.wkt){const e=e_(i.wkt);if(e)return e}return null}function e_(i){const e=Dd.exec(i);if(!e||e.length!==2)return null;const t=e[1].split(",");if(!t||t.length<3)return null;const s=parseFloat(t[1]),n=parseFloat(t[2]);return isNaN(s)||isNaN(n)?null:{a:s,f:n===0?0:1/n}}function t_(i){const e=jc(i??Is.WGS84);if(i_(e))return e;const t=e.a*(1-e.f);return Object.assign(e,{b:t,eSq:1-(t/e.a)**2,radius:(2*e.a+t)/3,densificationRatio:1e4/((2*e.a+t)/3)})}function i_(i){return i!=null&&"b"in i&&"eSq"in i&&"radius"in i}function Wc(i){return jc(i)!==null}function s_(i,e="meters"){if(!i)throw new k("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(i.some(s=>!Wc(s.spatialReference)))throw new k("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const t=[];for(let s=0;s<i.length;s++){const n=i[s],{spatialReference:o}=n,r=n.type==="polyline"?n.paths:n.rings;let l=0;for(let d=0;d<r.length;d++){const u=r[d];let h=0;for(let p=1;p<u.length;p++){const g=u[p-1][0],f=u[p][0],_=u[p-1][1],T=u[p][1];if(_!==T||g!==f){const w=new n_;o_(w,[g,_],[f,T],o),h+=w.distance}}l+=h}l=qd(l,"meters",e),t.push(l)}return t}class n_{constructor(e=0,t,s){this.distance=e,this.azimuth=t,this.reverseAzimuth=s}}function o_(i,e,t,s){const n=e[0]*ii,o=e[1]*ii,r=t[0]*ii,l=t[1]*ii,{a:d,b:u,f:h,radius:p}=t_(s),g=r-n,f=Math.atan((1-h)*Math.tan(o)),_=Math.atan((1-h)*Math.tan(l)),T=Math.sin(f),w=Math.cos(f),E=Math.sin(_),P=Math.cos(_);let $,O,R,x,H,G,z,Z,ne,Re,oe=1e3,Me=g;do{if(z=Math.sin(Me),Z=Math.cos(Me),R=Math.sqrt(P*z*(P*z)+(w*E-T*P*Z)*(w*E-T*P*Z)),R===0)return i.distance=0,i.azimuth=void 0,i.reverseAzimuth=void 0,i;H=T*E+w*P*Z,G=Math.atan2(R,H),ne=w*P*z/R,O=1-ne*ne,x=H-2*T*E/O,isNaN(x)&&(x=0),Re=h/16*O*(4+h*(4-3*O)),$=Me,Me=g+(1-Re)*h*ne*(G+Re*R*(x+Re*H*(2*x*x-1)))}while(Math.abs(Me-$)>1e-12&&--oe>0);if(oe===0){const Qc=p,Jc=Math.acos(Math.sin(o)*Math.sin(l)+Math.cos(o)*Math.cos(l)*Math.cos(r-n))*Qc,hr=r-n,Xc=Math.sin(hr)*Math.cos(l),ed=Math.cos(o)*Math.sin(l)-Math.sin(o)*Math.cos(l)*Math.cos(hr),td=Math.atan2(Xc,ed);return i.azimuth=td/ii,i.distance=Jc,i.reverseAzimuth=void 0,i}const ve=O*(d*d-u*u)/(u*u),ct=ve/1024*(256+ve*(ve*(74-47*ve)-128)),dt=u*(1+ve/16384*(4096+ve*(ve*(320-175*ve)-768)))*(G-ct*R*(x+ct/4*(H*(2*x*x-1)-ct/6*x*(4*R*R-3)*(4*x*x-3)))),Ne=Math.atan2(P*Math.sin(Me),w*E-T*P*Math.cos(Me)),ze=Math.atan2(w*Math.sin(Me),w*E*Math.cos(Me)-T*P);return i.azimuth=Ne/ii,i.distance=dt,i.reverseAzimuth=ze/ii,i}function r_(i){const{wkid:e}=i;if(Ns[e]!=null)return Ns.values[Ns[e]];const{wkt:t}=i,s=t.lastIndexOf(",")+1,n=t.lastIndexOf("]]");return parseFloat(t.substring(s,n))}function Wa(i,e){return i&&i.includes(e)}function Za(i,e){const{x:t,y:s}=i==="decimal-degrees"?bd(e,!0):e;return[t,s]}function Ka({state:{paddedViewState:i},spatialReference:e,width:t}){return e.isWrappable&&i.worldScreenWidth<t}let Oi=class extends V{constructor(e){super(e),this.scaleComputedFrom=fe(),this.view=null}get state(){return this.get("view.ready")&&this.get("view.type")==="2d"?"ready":"disabled"}getScaleBarProperties(e,t){if(this.state==="disabled"||isNaN(e)||!t)return null;const s=this._getDistanceInKm(this.view,this.scaleComputedFrom);if(F(s))return null;if(t==="metric")return this._getScaleBarProps(e,s,"metric");const n=s/1.609;return this._getScaleBarProps(e,n,"non-metric")}_getLocationUnit(){const e=this.get("view.spatialReference"),{isWebMercator:t,wkid:s,wkt:n}=e;return t||Wa(n,"WGS_1984_Web_Mercator")?"decimal-degrees":Ns[s]!=null||Wa(n,"PROJCS")?"linear-unit":"unknown"}_getDistanceInKm(e,t){const{state:s,spatialReference:n}=e,o=this._getLocationUnit();if(o==="linear-unit")return s.extent.width*r_(n)/1e3;const[r,l]=this._getScaleMeasuringPoints(e,t),d=o==="decimal-degrees"||n.isGeographic&&!Wc(n)?Is.WGS84:n,u=new Uo({paths:[[Za(o,r),Za(o,l)]],spatialReference:d}),h=gu(u,10);let p;try{[p]=s_([h],"kilometers")}catch{return null}return p}_getScaleMeasuringPoints(e,t){const{width:s,height:n,position:o,spatialReference:r}=e;if(Ka(e)){const{valid:h}=rl(r);return[new X(h[0],0,r),new X(h[1],0,r)]}let l=t.y-o[1];l>n?l=n:l<0&&(l=0);const d=fe(0,l),u=fe(s,l);return[e.toMap(d),e.toMap(u)]}_getScaleBarProps(e,t,s){const{view:n}=this;let o=e*t/(Ka(n)?n.state.paddedViewState.worldScreenWidth:n.width),r=s==="metric"?"km":"mi";o<.1&&(r==="mi"?(o*=5280,r="ft"):r==="km"&&(o*=1e3,r="m"));let l=0;for(;o>=1;)o/=10,l++;const d=this._getConstraints(o);if(!d)return null;const{min:u,max:h}=d,p=h/o>=o/u?u:h;return{length:e*(p/o),value:10**l*p,unit:r}}_getConstraints(e){return e>.5?{min:.5,max:1}:e>.3?{min:.3,max:.5}:e>.2?{min:.2,max:.3}:e>.15?{min:.15,max:.2}:e>=.1?{min:.15,max:.1}:void 0}};a([c()],Oi.prototype,"scaleComputedFrom",void 0),a([c({readOnly:!0})],Oi.prototype,"state",null),a([c()],Oi.prototype,"view",void 0),Oi=a([b("esri.widgets.Scalebar.ScaleBarViewModel")],Oi);const a_=Oi,ie={base:"esri-scale-bar esri-widget",labelContainer:"esri-scale-bar__label-container",rulerLabelContainer:"esri-scale-bar__label-container--ruler",lineLabelContainer:"esri-scale-bar__label-container--line",topLabelContainer:"esri-scale-bar__label-container--top",bottomLabelContainer:"esri-scale-bar__label-container--bottom",label:"esri-scale-bar__label",line:"esri-scale-bar__line",topLine:"esri-scale-bar__line--top",bottomLine:"esri-scale-bar__line--bottom",ruler:"esri-scale-bar__ruler",rulerBlock:"esri-scale-bar__ruler-block",barContainer:"esri-scale-bar__bar-container",rulerBarContainer:"esri-scale-bar__bar-container--ruler",lineBarContainer:"esri-scale-bar__bar-container--line",disabled:"esri-disabled"};function Vs(i){return 2*i}let je=class extends pe{constructor(i,e){super(i,e),this.messages=null,this.unit="non-metric",this.viewModel=new a_}initialize(){this.addHandles([v(()=>{const{view:i}=this;return[i==null?void 0:i.stationary,i==null?void 0:i.center,i==null?void 0:i.scale,i==null?void 0:i.zoom]},([i])=>{i&&this.scheduleRender()})])}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}set style(i){const e=this.unit==="dual"?"line":i;this._set("style",e)}castStyle(i){return i==="line"?i:"ruler"}castUnit(i){return i==="metric"||i==="dual"?i:"non-metric"}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}render(){const i=this.get("viewModel.state")==="disabled",e={[ie.disabled]:i};let t,s;if(!i){const{unit:n,style:o}=this,r=n==="metric"||n==="dual",l=50;if(n==="non-metric"||n==="dual"){const d=this.viewModel.getScaleBarProperties(l,"non-metric");d&&(s=o==="ruler"?this._renderRuler(d):this._renderLine(d,"bottom"))}if(r){const d=this.viewModel.getScaleBarProperties(l,"metric");d&&(t=o==="ruler"?this._renderRuler(d):this._renderLine(d,"top"))}}return m("div",{afterCreate:this._handleRootCreateOrUpdate,afterUpdate:this._handleRootCreateOrUpdate,bind:this,class:this.classes(ie.base,e)},t,s)}_renderRuler(i){const e=Vs(Math.round(i.length)),{messages:t}=this,s=t[i.unit]||t.unknownUnit,n=`${Vs(i.value)} ${s}`;return m("div",{class:this.classes(ie.barContainer,ie.rulerBarContainer),key:"esri-scale-bar__ruler"},m("div",{class:ie.ruler,styles:{width:`${e}px`}},m("div",{class:ie.rulerBlock}),m("div",{class:ie.rulerBlock}),m("div",{class:ie.rulerBlock}),m("div",{class:ie.rulerBlock})),m("div",{class:this.classes(ie.labelContainer,ie.rulerLabelContainer)},m("div",{class:ie.label},"0"),m("div",{class:ie.label},n)))}_renderLine(i,e){const{messages:t}=this,s=t[i.unit]||t.unknownUnit,n=`${Vs(i.value)} ${s}`,o={[ie.topLabelContainer]:e==="top",[ie.bottomLabelContainer]:e==="bottom"},r=m("div",{class:this.classes(ie.labelContainer,ie.lineLabelContainer,o),key:"esri-scale-bar__label"},m("div",{class:ie.label},n)),l={[ie.topLine]:e==="top",[ie.bottomLine]:e==="bottom"},d=Vs(Math.round(i.length)),u=m("div",{class:this.classes(ie.line,l),key:"esri-scale-bar__line",styles:{width:`${d}px`}});return m("div",{class:this.classes(ie.barContainer,ie.lineBarContainer),key:"esri-scale-bar__line-container"},[u,r])}_handleRootCreateOrUpdate(i){const e=this.viewModel;if(!e)return;const t=i.getBoundingClientRect(),s=t.left+window.pageXOffset,n=t.top+window.pageYOffset,o=fe(s,n);(o.x!==e.scaleComputedFrom.x||o.y!==e.scaleComputedFrom.y)&&(e.scaleComputedFrom=o)}};a([c()],je.prototype,"label",null),a([c(),re("esri/widgets/ScaleBar/t9n/ScaleBar")],je.prototype,"messages",void 0),a([c()],je.prototype,"style",null),a([be("style")],je.prototype,"castStyle",null),a([c()],je.prototype,"unit",void 0),a([be("unit")],je.prototype,"castUnit",null),a([c()],je.prototype,"view",null),a([c()],je.prototype,"viewModel",void 0),je=a([b("esri.widgets.ScaleBar")],je);const l_=je;new wi({MGRS:"mgrs",USNG:"usng",UTM:"utm",GeoRef:"geo-ref",GARS:"gars",DMS:"dms",DDM:"ddm",DD:"dd"});new wi({109006:"centimeters",9102:"decimal-degrees",109005:"decimeters",9002:"feet",109009:"inches",9036:"kilometers",9001:"meters",9035:"miles",109007:"millimeters",109012:"nautical-miles",9096:"yards"});let si=class extends Ke{constructor(e){super(e),this.deviationUnit=null,this.geometries=null,this.maxDeviation=null}};a([c({type:String,json:{write:!0}})],si.prototype,"deviationUnit",void 0),a([c({json:{read:{reader:i=>i?i.map(e=>kt(e)).filter(M):null},write:{writer:(i,e)=>{e.geometries=(i==null?void 0:i.map(t=>t.toJSON()))??null}}}})],si.prototype,"geometries",void 0),a([c({type:Number,json:{write:!0}})],si.prototype,"maxDeviation",void 0),si=a([b("esri.rest.support.GeneralizeParameters")],si),si.from=ti(si);new wi({preserveShape:"preserve-shape"});let Lt=class extends Ke{constructor(e){super(e),this.calculationType=null,this.geodesic=null,this.lengthUnit=null,this.polylines=null}};a([c({type:String,json:{write:!0}})],Lt.prototype,"calculationType",void 0),a([c({type:Boolean,json:{write:!0}})],Lt.prototype,"geodesic",void 0),a([c({json:{write:!0}})],Lt.prototype,"lengthUnit",void 0),a([c({type:[Uo],json:{read:{reader:i=>i?i.map(e=>kt(e)):null},write:{writer:(i,e)=>{e.polylines=i.map(t=>t.toJSON())}}}})],Lt.prototype,"polylines",void 0),Lt=a([b("esri.rest.support.LengthsParameters")],Lt),Lt.from=ti(Lt);new wi({esriGeometryOffsetBevelled:"bevelled",esriGeometryOffsetMitered:"mitered",esriGeometryOffsetRounded:"rounded"});new wi({9001:"meters",9002:"feet",9036:"kilometers",9093:"miles",109012:"nautical-miles",109001:"yards"});let gt=class extends Ke{constructor(e){super(e),this.bevelRatio=null,this.geometries=null,this.offsetDistance=null,this.offsetHow=null,this.offsetUnit=null}};a([c({type:Number,json:{write:!0}})],gt.prototype,"bevelRatio",void 0),a([c({json:{read:{reader:i=>i?i.map(e=>kt(e)).filter(M):null},write:{writer:(i,e)=>{e.geometries=(i==null?void 0:i.map(t=>t.toJSON()))??null}}}})],gt.prototype,"geometries",void 0),a([c({type:Number,json:{write:!0}})],gt.prototype,"offsetDistance",void 0),a([c({type:String,json:{write:!0}})],gt.prototype,"offsetHow",void 0),a([c({type:String,json:{write:!0}})],gt.prototype,"offsetUnit",void 0),gt=a([b("esri.rest.support.OffsetParameters")],gt),gt.from=ti(gt);let hi=class extends Ke{constructor(e){super(e),this.geometries=null,this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(n=>n.toJSON()),t=this.geometries[0],s={};return s.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),s.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),s.geometries=JSON.stringify({geometryType:dl(t),geometries:e}),this.transformation&&(s.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),this.transformForward!=null&&(s.transformForward=this.transformForward),s}};a([c()],hi.prototype,"geometries",void 0),a([c({json:{read:{source:"outSR"}}})],hi.prototype,"outSpatialReference",void 0),a([c()],hi.prototype,"transformation",void 0),a([c()],hi.prototype,"transformForward",void 0),hi=a([b("esri.rest.support.ProjectParameters")],hi);const Zc=hi,c_=ti(Zc);async function d_(i,e,t){e=c_(e);const s=fu(i),n={...s.query,f:"json",...e.toJSON()},o=e.outSpatialReference,r=dl(e.geometries[0]),l=_u(n,t);return ll(s.path+"/project",l).then(({data:{geometries:d}})=>yu(d,r,o))}new wi({esriGeometryRelationCross:"cross",esriGeometryRelationDisjoint:"disjoint",esriGeometryRelationIn:"in",esriGeometryRelationInteriorIntersection:"interior-intersection",esriGeometryRelationIntersection:"intersection",esriGeometryRelationLineCoincidence:"line-coincidence",esriGeometryRelationLineTouch:"line-touch",esriGeometryRelationOverlap:"overlap",esriGeometryRelationPointTouch:"point-touch",esriGeometryRelationTouch:"touch",esriGeometryRelationWithin:"within",esriGeometryRelationRelation:"relation"});let Ft=class extends Ke{constructor(e){super(e),this.geometries1=null,this.geometries2=null,this.relation=null,this.relationParameter=null}};a([c({json:{read:{reader:i=>i?i.map(e=>kt(e)).filter(M):null},write:{writer:(i,e)=>{e.geometries1=(i==null?void 0:i.map(t=>t.toJSON()))??null}}}})],Ft.prototype,"geometries1",void 0),a([c({json:{read:{reader:i=>i?i.map(e=>kt(e)).filter(M):null},write:{writer:(i,e)=>{e.geometries2=(i==null?void 0:i.map(t=>t.toJSON()))??null}}}})],Ft.prototype,"geometries2",void 0),a([c({type:String,json:{write:!0}})],Ft.prototype,"relation",void 0),a([c({type:String,json:{write:!0}})],Ft.prototype,"relationParameter",void 0),Ft=a([b("esri.rest.support.RelationParameters")],Ft),Ft.from=ti(Ft);new wi({0:"default-curve-extension",1:"relocate-ends",2:"keep-end-attributes",4:"no-end-attributes",8:"no-extend-at-from",16:"no-extend-at-to"});let ni=class extends Ke{constructor(i){super(i),this.extendHow="default-curve-extension",this.polylines=null,this.trimExtendTo=null}};a([c({type:String,json:{write:!0}})],ni.prototype,"extendHow",void 0),a([c({type:[Uo],json:{read:{reader:i=>i?i.map(e=>kt(e)):null},write:{writer:(i,e)=>{e.polylines=i.map(t=>t.toJSON())}}}})],ni.prototype,"polylines",void 0),a([c({json:{read:{reader:i=>i?kt(i):null},write:{writer:(i,e)=>{e.trimExtendTo=i.toJSON()}}}})],ni.prototype,"trimExtendTo",void 0),ni=a([b("esri.rest.support.TrimExtendParameters")],ni),ni.from=ti(ni);const Kc=N.getLogger("esri.widgets.support.geolocationUtils"),u_={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function h_(){const i=Se("esri-geolocation");return i||Kc.warn("geolocation-unsupported","Geolocation unsupported."),i}function p_(){const i=window.isSecureContext;return i||Kc.warn("insecure-context","Geolocation requires a secure origin."),i}function m_(){return h_()&&p_()}function g_(i){return i||(i=u_),new Promise((t,s)=>{setTimeout(()=>s(new k("geolocation:timeout","getting the current geolocation position timed out")),15e3),navigator.geolocation.getCurrentPosition(t,s,i)})}function f_(i,e){const{position:t,view:s}=i;return v_(y_(__(t)),s,e)}function __(i){const e=i&&i.coords||{},t={accuracy:e.accuracy,altitude:e.altitude,altitudeAccuracy:e.altitudeAccuracy,heading:e.heading,latitude:e.latitude,longitude:e.longitude,speed:e.speed};return i&&{coords:t,timestamp:i.timestamp}}function y_(i){const e=i&&i.coords;return e?new X({longitude:e.longitude,latitude:e.latitude,z:e.altitude||null,spatialReference:{wkid:4326}}):null}function v_(i,e,t){if(!e)return Promise.resolve(i);const s=e.spatialReference;return s.isWGS84?Promise.resolve(i):s.isWebMercator?Promise.resolve(No(i)):w_(t).then(n=>{if(!n)throw new k("geometry-service:missing-url","Geometry service URL is missing");const o=new Zc({geometries:[i],outSpatialReference:s});return d_(n,o,t).then(r=>r[0])})}function w_(i){if(tn.geometryServiceUrl)return Promise.resolve(tn.geometryServiceUrl);const e=Ku.getDefault();return e.load(i).catch(()=>{}).then(()=>e.get("helperServices.geometry.url"))}const b_=2500;let nt=class extends xn(qi.EventedMixin(V)){constructor(){super(...arguments),this._geolocationUsable=!0,this._iconPath=bl("esri/images/support/sdk_gps_location.png"),this.geolocationOptions=null,this.goToLocationEnabled=!0,this.graphic=new lt({symbol:new cu({url:this._iconPath,width:21,height:21})}),this.scale=null,this.useHeadingEnabled=!0,this.view=null}initialize(){m_()||(this._geolocationUsable=!1)}destroy(){this._clear(),this.view=null}_clear(){this.view&&this.view.graphics.remove(this.graphic)}_getScaleWithinConstraints(i,e){if(!e)return i;if(e.type==="2d"){const{effectiveMaxScale:t,effectiveMinScale:s}=e.constraints;return Math.min(s,Math.max(t,i))}return i}_getScale(i){const{scale:e}=this,t=typeof e=="number"?e:b_;return this._getScaleWithinConstraints(t,i)}_getHeading(i,e){const t=e&&e.spatialReference,s=t&&(t.isWebMercator||t.isGeographic),n=i.coords&&i.coords.heading;if(!(!s||typeof n!="number"||isNaN(n)||n<0||n>360))return n}_addHeading(i){const{heading:e,target:t,view:s}=i;s&&typeof e=="number"&&!isNaN(e)&&(s.type!=="3d"?s.type==="2d"&&(t.rotation=360-e):t.heading=e)}_animatePoint(i,e,t,s){const{view:n}=this;if(!this.goToLocationEnabled||!n)return Promise.resolve(e);const o=this.useHeadingEnabled?this._getHeading(e,n):void 0,r={target:i,scale:t};return this._addHeading({heading:o,target:r,view:n}),this.callGoTo({target:r,options:s}).then(()=>e)}async _setPosition(i,e){try{const t=await f_({position:i,view:this.view},e),{graphic:s}=this,{timestamp:n}=i,{coords:o}=i,{accuracy:r,altitude:l,altitudeAccuracy:d,heading:u,latitude:h,longitude:p,speed:g}=o,f={timestamp:n,accuracy:r,altitude:l,altitudeAccuracy:d,heading:u,latitude:h,longitude:p,speed:g};s&&(s.geometry=t,s.attributes=f);const _=this._getScale(this.view);return this._animatePoint(t,i,_,e)}catch(t){throw new k("positioning:invalid-point","Cannot position invalid point",{error:t})}}};a([c()],nt.prototype,"_geolocationUsable",void 0),a([c()],nt.prototype,"geolocationOptions",void 0),a([c()],nt.prototype,"goToLocationEnabled",void 0),a([c({type:lt,nonNullable:!0})],nt.prototype,"graphic",void 0),a([c()],nt.prototype,"scale",void 0),a([c()],nt.prototype,"useHeadingEnabled",void 0),a([c()],nt.prototype,"view",void 0),nt=a([b("esri.widgets.support.GeolocationPositioning")],nt);const M_=nt;async function I_(){const i=await Yu("esri/widgets/Locate/t9n/Locate");return new vl({title:i.currentLocation,fieldInfos:[{fieldName:"timestamp",label:i.timestamp,format:{dateFormat:"short-date-short-time"}},{fieldName:"latitude",label:i.latitude,format:{places:4,digitSeparator:!0}},{fieldName:"longitude",label:i.longitude,format:{places:4,digitSeparator:!0}},{fieldName:"accuracy",label:i.accuracy,format:{places:0,digitSeparator:!0}},{fieldName:"altitude",label:i.altitude,format:{places:0,digitSeparator:!0}},{fieldName:"altitudeAccuracy",label:i.altitudeAccuracy,format:{places:0,digitSeparator:!0}},{fieldName:"heading",label:i.heading,format:{places:0,digitSeparator:!0}},{fieldName:"speed",label:i.speed,format:{places:0,digitSeparator:!0}}],actions:[To.clone()],content:[{type:"fields"}]})}let jt=class extends M_{constructor(i){super(i),this._locateController=null,this._handles=new at,this.popupEnabled=!0,this.locate=this.locate.bind(this)}initialize(){this._handles.add([wu(()=>{var s;const{graphic:i,view:e}=this;((s=e==null?void 0:e.graphics)==null?void 0:s.includes(i))&&this._updatePopupTemplate(i)})])}destroy(){this.cancelLocate(),this._handles.destroy(),this._handles=null}get state(){return this._geolocationUsable?this.get("view.ready")?this._locateController?"locating":"ready":"disabled":"feature-unsupported"}async locate(){if(this.cancelLocate(),this.state==="disabled")throw new k("locate:disabled-state","Cannot locate when disabled.");if(this.state==="feature-unsupported")throw new k("locate:feature-unsupported-state","Cannot locate in unsecure domain.");const i=new AbortController;this._locateController=i;try{let e=await g_(this.geolocationOptions);return e=await this._setPosition(e,{signal:i.signal}),this._locateController!==i?null:(this.graphic&&(this.graphic=this.graphic.clone(),await this._updatePopupTemplate(this.graphic),this.view.graphics.push(this.graphic)),this.emit("locate",{position:e}),this._locateController=null,e)}catch(e){throw this._locateController=null,this.emit("locate-error",{error:e}),e}}cancelLocate(){this._clear(),this._locateController&&this._locateController.abort(),this._locateController=null}async _updatePopupTemplate(i){if(!this.popupEnabled)return;const e=await I_(),t=i!==this.graphic;this.destroyed||t||(i.popupTemplate=e)}};a([c()],jt.prototype,"_locateController",void 0),a([c()],jt.prototype,"popupEnabled",void 0),a([c({readOnly:!0})],jt.prototype,"state",null),a([c()],jt.prototype,"locate",null),a([c()],jt.prototype,"cancelLocate",null),jt=a([b("esri.widgets.Locate.LocateViewModel")],jt);const Yc=jt,ft={base:"esri-locate esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-icon",locate:"esri-icon-locate",loading:"esri-icon-loading-indicator",rotating:"esri-rotating",widgetIcon:"esri-icon-north-navigation",disabled:"esri-disabled",hidden:"esri-hidden"};let _e=class extends pe{constructor(i,e){super(i,e),this.iconClass=ft.widgetIcon,this.messages=null,this.messagesCommon=null,this.viewModel=new Yc}get geolocationOptions(){return this.viewModel.geolocationOptions}set geolocationOptions(i){this.viewModel.geolocationOptions=i}get goToLocationEnabled(){return this.viewModel.goToLocationEnabled}set goToLocationEnabled(i){this.viewModel.goToLocationEnabled=i}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(i){this.viewModel.goToOverride=i}get graphic(){return this.viewModel.graphic}set graphic(i){this.viewModel.graphic=i}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(i){this.viewModel.popupEnabled=i}get scale(){return this.viewModel.scale}set scale(i){this.viewModel.scale=i}get useHeadingEnabled(){return this.viewModel.useHeadingEnabled}set useHeadingEnabled(i){this.viewModel.useHeadingEnabled=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}cancelLocate(){this.viewModel.cancelLocate()}locate(){return this.viewModel.locate()}render(){const i=this.get("viewModel.state"),e=i==="locating",t={[ft.disabled]:i==="disabled",[ft.hidden]:i==="feature-unsupported"},s={[ft.loading]:e,[ft.rotating]:e,[ft.locate]:!e},n=i==="locating"?this.messagesCommon.cancel:this.messages.title;return m("div",{bind:this,class:this.classes(ft.base,t),hidden:i==="feature-unsupported",onclick:this._locate,onkeydown:this._locate,role:"button",tabIndex:0,"aria-label":n,title:n},m("span",{"aria-hidden":"true",class:this.classes(ft.icon,s)}),m("span",{class:ft.text},this.messages.title))}_locate(){const{viewModel:i}=this;i.state==="locating"?i.cancelLocate():i.locate()}};a([c()],_e.prototype,"geolocationOptions",null),a([c()],_e.prototype,"goToLocationEnabled",null),a([c()],_e.prototype,"goToOverride",null),a([c()],_e.prototype,"graphic",null),a([c()],_e.prototype,"iconClass",void 0),a([c()],_e.prototype,"label",null),a([c(),re("esri/widgets/Locate/t9n/Locate")],_e.prototype,"messages",void 0),a([c(),re("esri/t9n/common")],_e.prototype,"messagesCommon",void 0),a([c()],_e.prototype,"popupEnabled",null),a([c()],_e.prototype,"scale",null),a([c()],_e.prototype,"useHeadingEnabled",null),a([c()],_e.prototype,"view",null),a([c({type:Yc}),Xo(["locate","locate-error"])],_e.prototype,"viewModel",void 0),a([$e()],_e.prototype,"_locate",null),_e=a([b("esri.widgets.Locate")],_e);const C_=_e;function Ya(i){let e;return{c(){e=j("div"),Q(e,"class","centerText")},m(t,s){ue(t,e,s),e.innerHTML=i[0]},p(t,s){s&1&&(e.innerHTML=t[0])},d(t){t&&le(e)}}}function T_(i){let e,t,s,n,o,r,l,d,u,h,p,g,f,_,T,w,E,P,$,O,R,x,H,G=i[0]&&Ya(i);return{c(){e=j("div"),t=j("div"),t.innerHTML=`<h1>PARK-Or</h1> 
        <p>Where <em>every</em> park is a winner!</p>`,s=xe(),n=j("div"),n.innerHTML='<div class="esri-widget hidden filters svelte-1qfzjjp" id="filterOptions"></div>',o=xe(),r=j("div"),l=j("div"),d=j("button"),u=j("img"),p=xe(),g=j("div"),f=j("button"),_=j("img"),w=xe(),E=j("div"),P=j("div"),$=xe(),G&&G.c(),O=xe(),R=j("p"),R.textContent="",Q(n,"class","centered svelte-1qfzjjp"),Rr(u.src,h=lh)||Q(u,"src",h),Q(u,"alt","play icon"),Q(d,"id","playButton"),Q(d,"type","button"),d.disabled=!0,Rr(_.src,T=ch)||Q(_,"src",T),Q(_,"alt","filter icon"),Q(f,"id","filterButton"),Q(f,"type","button"),Q(r,"class","column svelte-1qfzjjp"),Q(e,"class","app-header svelte-1qfzjjp"),Q(P,"class","map-view svelte-1qfzjjp"),Q(E,"class","container"),Q(R,"id","arrow"),Q(R,"class","animate svelte-1qfzjjp")},m(z,Z){ue(z,e,Z),B(e,t),B(e,s),B(e,n),B(e,o),B(e,r),B(r,l),B(l,d),B(d,u),B(r,p),B(r,g),B(g,f),B(f,_),ue(z,w,Z),ue(z,E,Z),B(E,P),ue(z,$,Z),G&&G.m(z,Z),ue(z,O,Z),ue(z,R,Z),x||(H=eh(i[1].call(null,P)),x=!0)},p(z,[Z]){z[0]?G?G.p(z,Z):(G=Ya(z),G.c(),G.m(O.parentNode,O)):G&&(G.d(1),G=null)},i:ce,o:ce,d(z){z&&le(e),z&&le(w),z&&le(E),z&&le($),G&&G.d(z),z&&le(O),z&&le(R),x=!1,H()}}}function E_(i,e,t){let s,n;Lr(i,fo,_=>t(3,s=_)),Lr(i,go,_=>t(4,n=_));let{centerText:o=""}=e,{parkFields:r=[]}=e;const l=new ou({creator(_){console.log(_);let T="";for(const[w,E]of Object.entries(_.attributes))E==="YES"&&(T+=`<span>${w}</span>`);debugger;return T}}),d=new vl({outFields:["*"],title:"{name}",content:[l]}),u=new Ml({url:"https://services2.arcgis.com/tQaXW7Zb1Vphzvgd/arcgis/rest/services/Parks/FeatureServer/0",outFields:r,definitionExpression:"STATUS = 'ACTIVE'",popupTemplate:d,renderer:{type:"simple",symbol:{type:"simple-fill",color:"rgba(30, 125, 40, 0.15)",outline:{color:"rgba(30, 125, 20, 1)",width:1}}},title:"Parks",id:"parksLayer",visible:!0,opacity:.8,listMode:"hide",popupEnabled:!0}),h=new Su({id:"parkGraphicsLayer",title:"Park Graphics",listMode:"hide",visible:!0,opacity:.8}),p=async(_,T)=>{const w=u.createQuery();w.where="STATUS = 'ACTIVE'",w.outFields=["OBJECTID","NAME","REGION","RESTROOM","BASEBALL","BASKETBALL","DOGPARK","PICNICAREA","PLAYGROUND","SOCCER","MULTIPURPOSEFIELD","BOATING","FISHING","SKATE","TENNIS","ULTIMATEGOLF","CYCLING"];const P=await(await u.queryFeatures(w)).features.map(x=>({OBJECTID:x.attributes.OBJECTID,NAME:x.attributes.NAME,REGION:x.attributes.REGION,RESTROOM:x.attributes.RESTROOM,BASEBALL:x.attributes.BASEBALL,BASKETBALL:x.attributes.BASKETBALL,BOATING:x.attributes.BOATING,FISHING:x.attributes.FISHING,SOCCER:x.attributes.SOCCER,TENNIS:x.attributes.TENNIS,ULTIMATEGOLF:x.attributes.ULTIMATEGOLF,CYCLING:x.attributes.CYCLING,DOGPARK:x.attributes.DOGPARK,PICNICAREA:x.attributes.PICNICAREA,PLAYGROUND:x.attributes.PLAYGROUND,MULTIPURPOSEFIELD:x.attributes.MULTIPURPOSEFIELD,SKATE:x.attributes.SKATE}));Fr(go,n=P,n),t(0,o=`<strong>${P.length}</strong> Total <strong>Parks</strong>`);const $=u.createQuery();$.where="STATUS = 'ACTIVE'",$.returnGeometry=!1,$.outStatistics=[{onStatisticField:"OBJECTID",outStatisticFieldName:"count",statisticType:"count"}],$.groupByFieldsForStatistics=["REGION"];const R=await(await u.queryFeatures($)).features.map(x=>({region:x.attributes.REGION,count:x.attributes.count})).sort((x,H)=>H.count-x.count);Fr(fo,s=R,s)},g=(_,T)=>{const w=document.getElementById("playButton");w.setAttribute("disabled","disabled"),T.queryFeatures().then(E=>{console.log(E.features.length);let P=E.features.length;if(P>0){let $=P>30?Math.floor(E.features.length/3):P,O=setInterval(()=>{$--;const G=E.features.length,z=Math.floor(Math.random()*(G-1)),Z=E.features[z],ne=Z.attributes,Re=Z.geometry,oe=Re.centroid,Me=new X({x:oe.x,y:oe.y,spatialReference:_.spatialReference}),ve=new du({color:[0,0,0,.85],outline:null}),ct=new lt({geometry:Me,symbol:ve,attributes:ne});if(h.removeAll(),h.add(ct),x(),$<=0&&(clearInterval(O),w.removeAttribute("disabled"),H(),$===0&&_.goTo(Re),$<0))throw new Error("Time to run is less than 0. Something went wrong. :( Please refresh the browser & Park-or again!")},1e3);const R=document.createElement("div");R.id="timerDiv",R.classList.add("esri-widget"),R.innerHTML=`<div id="timerDiv" class="esri-widget" style="width: 4vw; padding:.25rem 0;"><span>: ${$}</span></div>`,_.ui.add(R,"bottom-right");const x=()=>{R.innerHTML=`<div id="timerDiv" class="esri-widget" style="width: 4vw; padding:.25rem 0;"><span>: ${$}</span></div>`},H=()=>{_.ui.remove(R)}}else throw new Error("No parks found. Please refresh the mapview & find a new amenity, to Park-or!")})},f=(_,T)=>{const w=new Dl({basemap:"gray-vector",layers:[u,h]}),E=new Qf({container:_,map:w,zoom:10,center:[-79.95,32.8],constraints:{minZoom:10,maxZoom:15,rotationEnabled:!1}});E.when(async()=>{const R=await E.whenLayerView(u);console.log("park layer view: ",R),R.when(()=>{const x=document.getElementById("filterOptions");let H="<fieldset><legend>Filter by Amenities</legend>";const G="display:inline-flex;align-items:center;",z=r.sort().map(oe=>{if(oe!=="OBJECTID"&&oe!=="FACILITYSITEID"&&oe!=="NAME"&&oe!=="REGION"&&oe!=="URL")return`<div style="${G}">
                                <input type="checkbox" id="${oe}" name="interest" value="${oe}" />
                                <label for="${oe}">${oe}</label>
                            </div>`});H+=z.join(""),H+="</legend></fieldset>",x.innerHTML=H;const Z=(oe,Me)=>()=>{const Ne=`${Array.from(Me).filter(ze=>ze.checked).map(ze=>ze.value).join(" = 'YES' OR ")} = 'YES'`;oe.filter={where:Ne}},ne=document.querySelectorAll("input[name='interest']");for(const oe of ne)oe.addEventListener("click",Z(R,ne));const Re=document.getElementById("playButton");Re.removeAttribute("disabled"),Re.addEventListener("click",()=>{console.log("Play button clicked!"),g(E,R)}),p()})});const P=new Xf({view:E}),$=new l_({view:E}),O=new C_({view:E,goToOverride:(R,x)=>(x.target.scale=1500,R.goTo(x.target))});return E.ui.add(P,"top-left"),E.ui.add(O,"top-left"),E.ui.add($,"bottom-left"),setTimeout(()=>{document.getElementById("arrow").remove()},7500),{view:E,update(){console.log("update parks data!")},destroy(){E.container=null}}};return i.$$set=_=>{"centerText"in _&&t(0,o=_.centerText),"parkFields"in _&&t(2,r=_.parkFields)},[o,f,r]}class x_ extends xs{constructor(e){super(),Es(this,e,E_,T_,ji,{centerText:0,parkFields:2})}}function Qa(i,e,t){const s=i.slice();return s[5]=e[t][0],s[6]=e[t][1],s}function k_(i){let e;return{c(){e=j("h4"),e.textContent="Loading..."},m(t,s){ue(t,e,s)},p:ce,d(t){t&&le(e)}}}function A_(i){let e,t,s,n,o=Object.entries(i[0]),r=[];for(let l=0;l<o.length;l+=1)r[l]=Ja(Qa(i,o,l));return{c(){e=j("div"),t=j("h3"),t.textContent="Park Amenities",s=xe(),n=j("div");for(let l=0;l<r.length;l+=1)r[l].c();Q(n,"class","chart svelte-wwvwzf"),Q(e,"class","chart-section svelte-wwvwzf")},m(l,d){ue(l,e,d),B(e,t),B(e,s),B(e,n);for(let u=0;u<r.length;u+=1)r[u].m(n,null)},p(l,d){if(d&1){o=Object.entries(l[0]);let u;for(u=0;u<o.length;u+=1){const h=Qa(l,o,u);r[u]?r[u].p(h,d):(r[u]=Ja(h),r[u].c(),r[u].m(n,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=o.length}},d(l){l&&le(e),Sl(r,l)}}}function Ja(i){let e,t=i[5]+"",s,n,o,r=i[6]+"",l,d;return{c(){e=j("div"),s=xt(t),n=xe(),o=j("p"),l=xt(r),d=xe(),ms(o,"height",i[6]/2+"vh"),Q(o,"class","svelte-wwvwzf")},m(u,h){ue(u,e,h),B(e,s),B(e,n),B(e,o),B(o,l),B(e,d)},p(u,h){h&1&&t!==(t=u[5]+"")&&ln(s,t),h&1&&r!==(r=u[6]+"")&&ln(l,r),h&1&&ms(o,"height",u[6]/2+"vh")},d(u){u&&le(e)}}}function P_(i){let e;function t(o,r){return o[0]?A_:k_}let s=t(i),n=s(i);return{c(){n.c(),e=Rl()},m(o,r){n.m(o,r),ue(o,e,r)},p(o,[r]){s===(s=t(o))&&n?n.p(o,r):(n.d(1),n=s(o),n&&(n.c(),n.m(e.parentNode,e)))},i:ce,o:ce,d(o){n.d(o),o&&le(e)}}}function $_(i,e,t){let{parkFields:s=[]}=e,n=[],o={};const r=d=>{console.log("parks data",d),s.filter(h=>h!=="OBJECTID"&&h!=="FACILITYSITEID"&&h!=="NAME"&&h!=="REGION"&&h!=="URL").forEach(h=>{t(0,o[h]=0,o),d.forEach(p=>{p[h]==="YES"&&t(0,o[h]+=1,o)})}),console.log(o)},l=go.subscribe(d=>{n=d,n.length>0&&r(n)});return Ll(()=>{l()}),i.$$set=d=>{"parkFields"in d&&t(1,s=d.parkFields)},[o,s]}class S_ extends xs{constructor(e){super(),Es(this,e,$_,P_,ji,{parkFields:1})}}function Xa(i,e,t){const s=i.slice();return s[2]=e[t],s}function R_(i){let e;return{c(){e=j("h4"),e.textContent="Loading..."},m(t,s){ue(t,e,s)},p:ce,d(t){t&&le(e)}}}function L_(i){let e,t,s,n,o=i[0],r=[];for(let l=0;l<o.length;l+=1)r[l]=el(Xa(i,o,l));return{c(){e=j("div"),t=j("h3"),t.textContent="# Parks per Region",s=xe(),n=j("div");for(let l=0;l<r.length;l+=1)r[l].c();Q(n,"class","chart svelte-ulifiv"),Q(e,"class","chart-section svelte-ulifiv")},m(l,d){ue(l,e,d),B(e,t),B(e,s),B(e,n);for(let u=0;u<r.length;u+=1)r[u].m(n,null)},p(l,d){if(d&1){o=l[0];let u;for(u=0;u<o.length;u+=1){const h=Xa(l,o,u);r[u]?r[u].p(h,d):(r[u]=el(h),r[u].c(),r[u].m(n,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=o.length}},d(l){l&&le(e),Sl(r,l)}}}function el(i){let e,t=i[2].region.replace("Island","Is.")+"",s,n,o,r=i[2].count+"",l,d;return{c(){e=j("div"),s=xt(t),n=xe(),o=j("p"),l=xt(r),d=xe(),ms(o,"width",i[2].count+"vw"),ms(o,"height","20px"),Q(o,"class","svelte-ulifiv")},m(u,h){ue(u,e,h),B(e,s),B(e,n),B(e,o),B(o,l),B(e,d)},p(u,h){h&1&&t!==(t=u[2].region.replace("Island","Is.")+"")&&ln(s,t),h&1&&r!==(r=u[2].count+"")&&ln(l,r),h&1&&ms(o,"width",u[2].count+"vw")},d(u){u&&le(e)}}}function F_(i){let e;function t(o,r){return o[0].length>0?L_:R_}let s=t(i),n=s(i);return{c(){n.c(),e=Rl()},m(o,r){n.m(o,r),ue(o,e,r)},p(o,[r]){s===(s=t(o))&&n?n.p(o,r):(n.d(1),n=s(o),n&&(n.c(),n.m(e.parentNode,e)))},i:ce,o:ce,d(o){n.d(o),o&&le(e)}}}function O_(i,e,t){let s=[];const n=fo.subscribe(o=>{t(0,s=o)});return Ll(()=>{n()}),[s]}class D_ extends xs{constructor(e){super(),Es(this,e,O_,F_,ji,{})}}function V_(i){let e,t,s,n,o=i[0].year+"",r;return{c(){e=j("small"),t=xt(`Developed by 
  `),s=j("a"),s.textContent="MapMazeLu",n=xt(`
    `),r=xt(o),Q(s,"href","https://emmapaz.com"),Q(s,"target","_blank"),Q(s,"rel","noreferrer")},m(l,d){ue(l,e,d),B(e,t),B(e,s),B(e,n),B(e,r)},p:ce,i:ce,o:ce,d(l){l&&le(e)}}}function N_(i){return[Qu.now()]}class z_ extends xs{constructor(e){super(),Es(this,e,N_,V_,ji,{})}}function B_(i){let e,t,s,n,o,r,l,d;return e=new x_({props:{parkFields:i[0]}}),s=new S_({props:{parkFields:i[0]}}),o=new D_({}),l=new z_({}),{c(){Ss(e.$$.fragment),t=xe(),Ss(s.$$.fragment),n=xe(),Ss(o.$$.fragment),r=xe(),Ss(l.$$.fragment)},m(u,h){os(e,u,h),ue(u,t,h),os(s,u,h),ue(u,n,h),os(o,u,h),ue(u,r,h),os(l,u,h),d=!0},p:ce,i(u){d||(ns(e.$$.fragment,u),ns(s.$$.fragment,u),ns(o.$$.fragment,u),ns(l.$$.fragment,u),d=!0)},o(u){$s(e.$$.fragment,u),$s(s.$$.fragment,u),$s(o.$$.fragment,u),$s(l.$$.fragment,u),d=!1},d(u){rs(e,u),u&&le(t),rs(s,u),u&&le(n),rs(o,u),u&&le(r),rs(l,u)}}}function U_(i){return[["OBJECTID","FACILITYSITEID","NAME","REGION","RESTROOM","BASEBALL","BASKETBALL","DOGPARK","PICNICAREA","PLAYGROUND","SOCCER","MULTIPURPOSEFIELD","BOATING","FISHING","SKATE","TENNIS","ULTIMATEGOLF","CYCLING","URL"]]}class H_ extends xs{constructor(e){super(),Es(this,e,U_,B_,ji,{})}}new H_({target:document.getElementById("app")});export{ug as $,Mc as G,Yt as P,Fb as R,kn as S,zi as a,Lb as b,wg as c,Zc as d,Pc as e,d_ as f,l0 as m,bc as n,Mg as p,We as u};
