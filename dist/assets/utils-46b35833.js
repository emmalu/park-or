import{_ as g}from"./preload-helper-101896b7.js";import{l as u}from"./Color-b7b9e6bb.js";import{c as h,x as p,p as z}from"./symbols-64db5dd6.js";import{c as x}from"./asyncUtils-18831bb1.js";import"./string-9c5e03f7.js";import{r as a,t as b,e as w}from"./typedArrayUtil-d02f10a8.js";import{l as _}from"./common-701a4199.js";import"./Error-4ed679d7.js";import"./parser-f68dd732.js";import"./mat4-62d5e6a4.js";import"./assets-6ba3cd63.js";import"./request-e4299080.js";import{e as v}from"./ItemCache-b4db8f82.js";new v(1e3);new u([128,128,128]);const L=new u("white");function W(t,o){if(!t)return null;let n=null;return h(t)?n=j(t):p(t)&&(n=t.color?new u(t.color):null),n?f(n,o):null}function j(t){const o=t.symbolLayers;if(!o)return null;let n=null;return o.forEach(r=>{var i;r.type==="object"&&((i=r.resource)==null?void 0:i.href)!=null||(n=r.type==="water"?w(r.color):a(r.material)?w(r.material.color):null)}),n?new u(n):null}function f(t,o){if(o==null||t==null)return t;const n=t.toRgba();return n[3]=n[3]*o,new u(n)}function E(t,o,n){const r=t.symbolLayers;if(!r)return;const i=l=>{const c=a(l)?l:null;return f(o=o??c??(n!=null?L:null),n)};r.forEach(l=>{var c;if(l.type!=="object"||((c=l.resource)==null?void 0:c.href)==null||o)if(l.type==="water")l.color=i(l.color);else{const m=a(l.material)?l.material.color:null,e=i(m);b(l.material)?l.material=new z({color:e}):l.material.color=e,n!=null&&"outline"in l&&a(l.outline)&&a(l.outline.color)&&(l.outline.color=f(l.outline.color,n))}})}function S(t,o,n){(o=o??t.color)&&(t.color=f(o,n)),n!=null&&"outline"in t&&t.outline&&t.outline.color&&(t.outline.color=f(t.outline.color,n))}function X(t,o,n){t&&(o||n!=null)&&(o&&(o=new u(o)),h(t)?E(t,o,n):p(t)&&S(t,o,n))}async function $(t,o){const n=t.symbolLayers;n&&await x(n,async r=>R(r,o))}async function R(t,o){switch(t.type){case"extrude":A(t,o);break;case"icon":case"line":case"text":O(t,o);break;case"path":I(t,o);break;case"object":await D(t,o)}}function O(t,o){const n=d(o);a(n)&&(t.size=n)}function d(t){for(const o of t)if(typeof o=="number")return o;return null}function A(t,o){t.size=typeof o[2]=="number"?o[2]:0}async function D(t,o){const{resourceSize:n,symbolSize:r}=await P(t),i=k(o,n,r);t.width=s(o[0],r[0],n[0],i),t.depth=s(o[1],r[1],n[1],i),t.height=s(o[2],r[2],n[2],i)}function I(t,o){const n=k(o,_,[t.width,void 0,t.height]);t.width=s(o[0],t.width,1,n),t.height=s(o[2],t.height,1,n)}function k(t,o,n){for(let r=0;r<3;r++){const i=t[r];switch(i){case"symbol-value":{const l=n[r];return l!=null?l/o[r]:1}case"proportional":break;default:if(i&&o[r])return i/o[r]}}return 1}async function P(t){const o=await g(()=>import("./symbolLayerUtils-844e7b4c.js"),["assets/symbolLayerUtils-844e7b4c.js","assets/preload-helper-101896b7.js","assets/request-e4299080.js","assets/Error-4ed679d7.js","assets/string-9c5e03f7.js","assets/typedArrayUtil-d02f10a8.js","assets/promiseUtils-930cba29.js","assets/ItemCache-b4db8f82.js","assets/MemCache-1e028041.js","assets/cast-6d78d3c7.js","assets/ensureType-d98e08e1.js","assets/nextTick-3ee5a785.js","assets/aaBoundingBox-33fc923c.js","assets/Extent-d5fff12d.js","assets/mathUtils-daf59e84.js","assets/common-701a4199.js","assets/symbols-64db5dd6.js","assets/CIMSymbol-a95ceb49.js","assets/enumeration-497ef064.js","assets/jsonMap-5afaf2ff.js","assets/fieldUtils-141b2ff2.js","assets/arcadeOnDemand-72c57f7a.js","assets/geometry-70b2a4a5.js","assets/Polyline-42dcc920.js","assets/typeUtils-b6c52390.js","assets/Symbol-1bb07043.js","assets/Color-b7b9e6bb.js","assets/colorUtils-639f4d25.js","assets/screenUtils-7afeb41c.js","assets/opacityUtils-8b7acc4e.js","assets/persistableUrlUtils-d18becd9.js","assets/Collection-42fe629f.js","assets/Evented-b378ccab.js","assets/SimpleObservable-e0897cc6.js","assets/collectionUtils-3d8a9611.js","assets/Portal-fbb2b73d.js","assets/Loadable-b0d5bb7e.js","assets/Promise-6bd0b483.js","assets/locale-30120714.js","assets/PortalGroup-813428fa.js","assets/PortalUser-cf18ae9d.js","assets/Clonable-58355d3c.js"]),n=await o.computeObjectLayerResourceSize(t,10),{width:r,height:i,depth:l}=t,c=[r,l,i];let m=1;for(let e=0;e<3;e++){const y=c[e];if(y!=null){m=y/n[e];break}}for(let e=0;e<3;e++)c[e]==null&&(c[e]=n[e]*m);return{resourceSize:n,symbolSize:c}}function s(t,o,n,r){switch(t){case"proportional":return n*r;case"symbol-value":return o??n;default:return t}}function C(t,o){const n=d(o);if(!b(n))switch(t.type){case"simple-marker":t.size=n;break;case"picture-marker":{const r=t.width/t.height;r>1?(t.width=n,t.height=n*r):(t.width=n*r,t.height=n);break}case"simple-line":t.width=n;break;case"text":t.font.size=n}}async function Y(t,o){if(t&&o)return h(t)?$(t,o):void(p(t)&&C(t,o))}function Z(t,o,n){if(t&&o!=null)if(h(t)){const r=t.symbolLayers;r&&r.forEach(i=>{if(i&&i.type==="object")switch(n){case"tilt":i.tilt=o;break;case"roll":i.roll=o;break;default:i.heading=o}})}else p(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle=o))}export{Y as M,Z as N,W as j,X as x};
